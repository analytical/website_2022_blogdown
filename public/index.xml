<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Analytical</title>
    <link>https://www.analytical.cl/</link>
      <atom:link href="https://www.analytical.cl/index.xml" rel="self" type="application/rss+xml" />
    <description>Analytical</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-cl</language><copyright>@ 2023 Carlos Gómez</copyright><lastBuildDate>Wed, 20 Sep 2023 18:15:00 +0000</lastBuildDate>
    <image>
      <url>https://www.analytical.cl/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_3.png</url>
      <title>Analytical</title>
      <link>https://www.analytical.cl/</link>
    </image>
    
    <item>
      <title>Python basics</title>
      <link>https://www.analytical.cl/courses/example/python/</link>
      <pubDate>Fri, 01 Jan 2021 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/courses/example/python/</guid>
      <description>&lt;p&gt;Build a foundation in Python.&lt;/p&gt;
&lt;p&gt;
  &lt;i class=&#34;fas fa-clock  pr-1 fa-fw&#34;&gt;&lt;/i&gt; 1-2 hours per week, for 8 weeks&lt;/p&gt;
&lt;h2 id=&#34;learn&#34;&gt;Learn&lt;/h2&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/rfscVS0vtbw&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;h2 id=&#34;quiz&#34;&gt;Quiz&lt;/h2&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-2&#34;&gt;
  &lt;summary&gt;What is the difference between lists and tuples?&lt;/summary&gt;
  &lt;p&gt;&lt;p&gt;Lists&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Lists are mutable - they can be changed&lt;/li&gt;
&lt;li&gt;Slower than tuples&lt;/li&gt;
&lt;li&gt;Syntax: &lt;code&gt;a_list = [1, 2.0, &#39;Hello world&#39;]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tuples&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tuples are immutable - they can&amp;rsquo;t be changed&lt;/li&gt;
&lt;li&gt;Tuples are faster than lists&lt;/li&gt;
&lt;li&gt;Syntax: &lt;code&gt;a_tuple = (1, 2.0, &#39;Hello world&#39;)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/p&gt;
&lt;/details&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-3&#34;&gt;
  &lt;summary&gt;Is Python case-sensitive?&lt;/summary&gt;
  &lt;p&gt;Yes&lt;/p&gt;
&lt;/details&gt;</description>
    </item>
    
    <item>
      <title>Visualization</title>
      <link>https://www.analytical.cl/courses/example/visualization/</link>
      <pubDate>Fri, 01 Jan 2021 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/courses/example/visualization/</guid>
      <description>&lt;p&gt;Learn how to visualize data with Plotly.&lt;/p&gt;
&lt;p&gt;
  &lt;i class=&#34;fas fa-clock  pr-1 fa-fw&#34;&gt;&lt;/i&gt; 1-2 hours per week, for 8 weeks&lt;/p&gt;
&lt;h2 id=&#34;learn&#34;&gt;Learn&lt;/h2&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/hSPmj7mK6ng&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;h2 id=&#34;quiz&#34;&gt;Quiz&lt;/h2&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-2&#34;&gt;
  &lt;summary&gt;When is a heatmap useful?&lt;/summary&gt;
  &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&lt;/p&gt;
&lt;/details&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-3&#34;&gt;
  &lt;summary&gt;Write Plotly code to render a bar chart&lt;/summary&gt;
  &lt;p&gt;&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import plotly.express as px
data_canada = px.data.gapminder().query(&amp;quot;country == &#39;Canada&#39;&amp;quot;)
fig = px.bar(data_canada, x=&#39;year&#39;, y=&#39;pop&#39;)
fig.show()
&lt;/code&gt;&lt;/pre&gt;
&lt;/p&gt;
&lt;/details&gt;</description>
    </item>
    
    <item>
      <title>Statistics</title>
      <link>https://www.analytical.cl/courses/example/stats/</link>
      <pubDate>Fri, 01 Jan 2021 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/courses/example/stats/</guid>
      <description>&lt;p&gt;Introduction to statistics for data science.&lt;/p&gt;
&lt;p&gt;
  &lt;i class=&#34;fas fa-clock  pr-1 fa-fw&#34;&gt;&lt;/i&gt; 1-2 hours per week, for 8 weeks&lt;/p&gt;
&lt;h2 id=&#34;learn&#34;&gt;Learn&lt;/h2&gt;
&lt;p&gt;The general form of the &lt;strong&gt;normal&lt;/strong&gt; probability density function is:&lt;/p&gt;
&lt;p&gt;$$
f(x) = \frac{1}{\sigma \sqrt{2\pi} } e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}
$$&lt;/p&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    The parameter $\mu$ is the mean or expectation of the distribution.
$\sigma$ is its standard deviation.
The variance of the distribution is $\sigma^{2}$.
  &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;quiz&#34;&gt;Quiz&lt;/h2&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-2&#34;&gt;
  &lt;summary&gt;What is the parameter $\mu$?&lt;/summary&gt;
  &lt;p&gt;The parameter $\mu$ is the mean or expectation of the distribution.&lt;/p&gt;
&lt;/details&gt;</description>
    </item>
    
    <item>
      <title>Métodos Estadísticos modernos aplicados en Validación Farmacéutica</title>
      <link>https://www.analytical.cl/talk/metodos-estadisticos-modernos-aplicados-en-validacion-farmaceutica/</link>
      <pubDate>Wed, 20 Sep 2023 18:15:00 +0000</pubDate>
      <guid>https://www.analytical.cl/talk/metodos-estadisticos-modernos-aplicados-en-validacion-farmaceutica/</guid>
      <description>&lt;!---
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Click on the &lt;strong&gt;Slides&lt;/strong&gt; button above to view the built-in slides feature.
  &lt;/div&gt;
&lt;/div&gt;


Slides can be added in a few ways:

- **Create** slides using Wowchemy&#39;s [*Slides*](https://wowchemy.com/docs/managing-content/#create-slides) feature and link using `slides` parameter in the front matter of the talk file
- **Upload** an existing slide deck to `static/` and link using `url_slides` parameter in the front matter of the talk file
- **Embed** your slides (e.g. Google Slides) or presentation video on this page using [shortcodes](https://wowchemy.com/docs/writing-markdown-latex/).

Further event details, including [page elements](https://wowchemy.com/docs/writing-markdown-latex/) such as image galleries, can be added to the body of this page.
--&gt;
</description>
    </item>
    
    <item>
      <title>Curso Herramientas de Diseño e Interpretación Estadística de las Mediciones</title>
      <link>https://www.analytical.cl/talk/curso-herramientas-de-diseno-e-interpretacion-estadistica-de-las-mediciones/</link>
      <pubDate>Mon, 21 Aug 2023 18:15:00 +0000</pubDate>
      <guid>https://www.analytical.cl/talk/curso-herramientas-de-diseno-e-interpretacion-estadistica-de-las-mediciones/</guid>
      <description>&lt;!---
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Click on the &lt;strong&gt;Slides&lt;/strong&gt; button above to view the built-in slides feature.
  &lt;/div&gt;
&lt;/div&gt;


Slides can be added in a few ways:

- **Create** slides using Wowchemy&#39;s [*Slides*](https://wowchemy.com/docs/managing-content/#create-slides) feature and link using `slides` parameter in the front matter of the talk file
- **Upload** an existing slide deck to `static/` and link using `url_slides` parameter in the front matter of the talk file
- **Embed** your slides (e.g. Google Slides) or presentation video on this page using [shortcodes](https://wowchemy.com/docs/writing-markdown-latex/).

Further event details, including [page elements](https://wowchemy.com/docs/writing-markdown-latex/) such as image galleries, can be added to the body of this page.
--&gt;
</description>
    </item>
    
    <item>
      <title>¿Cuántos laboratorios de ensayo acreditados por el INN hay en Chile? Versión 2023</title>
      <link>https://www.analytical.cl/post/acreditados-inn-2023/</link>
      <pubDate>Mon, 03 Jul 2023 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/acreditados-inn-2023/</guid>
      <description>


&lt;p&gt;Hace ya casi 1 año publiqué un &lt;a href=&#34;https://www.linkedin.com/posts/cjgomezs_acreditados-activity-6856380114675011584-7hnO?utm_source=share&amp;amp;utm_medium=member_desktop&#34;&gt;post&lt;/a&gt; acerca de cuántos laboratorios de ensayos acreditados existen en Chile el 2021. La publicación generó airadas reacciones, sin embargo, se abrió un interesante debate (esa es la idea).&lt;/p&gt;
&lt;p&gt;Es tiempo de actualizar ese análisis con los datos de 2022. En esta oportunidad llevaremos a cabo el
análisis paso a paso en &lt;code&gt;R&lt;/code&gt; bajo el concepto de &lt;a href=&#34;https://esajournals.onlinelibrary.wiley.com/doi/10.1002/bes2.1801&#34;&gt;&lt;em&gt;Reproducible Research&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nota: Considerar que algunas razones sociales podrían tener varios laboratorios/alcances
acreditados, por lo tanto, este gráfico en realidad cuenta el número de acreditaciones.
(¿Clickbait?)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;La versión de este post es &lt;em&gt;semi-automática&lt;/em&gt;, es decir, algunas operaciones serán
hechas &lt;em&gt;a mano&lt;/em&gt;. Podríamos aplicar &lt;em&gt;web scraping&lt;/em&gt; y bajar los datos directamente desde la página web del INN, pero eso qudará para otro post (lo intuye bien querid@ lector@… cuando yo aprenda a hacerlo.)&lt;/p&gt;
&lt;div id=&#34;dónde-están-los-datos-de-laboratorios-acreditados-por-el-inn&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;¿Dónde están los datos de laboratorios acreditados por el INN?&lt;/h2&gt;
&lt;p&gt;Bueno, lo primero es dirigirnos al siguiente link para bajar los datos desde la
página del INN (son datos públicos por si acaso):&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://acreditacion.innonline.cl/&#34;&gt;Directorio de Acreditados&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;acreditados.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En el campo &lt;em&gt;Tipo de ESquema de Acreditación&lt;/em&gt; seleccionamos &lt;em&gt;Laboratorios de ensayo&lt;/em&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;acreditados2.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Presionamos &lt;em&gt;Buscar&lt;/em&gt; y obtenderemos el listado completo (incluyendo los laboratorios suspendidos):&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;acreditados3.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Lamentablemente, el sitio no tiene ninguna opción para bajar los datos en Excel u
otro formato, así que tendremos que hacerlo a la antigua:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Botón derecho y se abrirá el siguiente menú:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;acreditados4.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Elija &lt;em&gt;Guardar Como&lt;/em&gt; y en tipo seleccione &lt;em&gt;Página web (completa)&lt;/em&gt; y guárdelo
con el nombre &lt;em&gt;acreditados.html&lt;/em&gt; (el nombre da igual)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;acreditados5.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Listo, hemos bajado los datos y ahora debemos &lt;em&gt;limpiarlos&lt;/em&gt; ya que incluso se
descargaron los íconos de los certificado en pdf. Tenemos que dejar la tabla
limpia para el análisis en &lt;code&gt;R&lt;/code&gt; (o para cualquier otro software)&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;limpieza-de-la-base-de-datos-en-excel&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Limpieza de la base de datos en Excel&lt;/h2&gt;
&lt;p&gt;Haremos la limpieza de datos en Excel.&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Abra Excel&lt;/li&gt;
&lt;li&gt;Ahora abra el archivo archivados.html que guardó (sí, Excel puede abrir este tipo de archivos) y obtendrá algo similar a esto:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;acreditados6.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El objetivo es llegar a una hoja de Excel plana:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;acreditados7.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Seleccionemos todos los datos inlcuyendo los encabezados de las columnas
(N, N Certi, etc), copiar y pegar en una &lt;strong&gt;nueva hoja&lt;/strong&gt; sólo como datos, es decir,
nos ubicamos en la celda A1 de la hoja nueva, presionamos botón derecho y seleccionamos
&lt;code&gt;Valores (V)&lt;/code&gt;:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;index.es_insertimage_2.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Y obtendremos lo siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;index.es_insertimage_3.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Eliminamos la columna B:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;index.es_insertimage_4.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Hemos obtenido la tabla que buscábamos:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;index.es_insertimage_5.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;6&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Lo único que nos falta es modificar un poco los encabezados para eliminar
acentos, espacios en blanco, etc. Para que Ud. pueda reproducir este análisis
cambie los encabezados por los siguientes:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;index.es_insertimage_6.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;7&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;¡Listo! hemos &lt;em&gt;limpiado&lt;/em&gt; la base de datos, la cual debe lucir más o menos así
en el Excel:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;index.es_insertimage_7.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;8&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Cambiemos el nombre la hoja a &lt;code&gt;datos&lt;/code&gt;:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;index.es_insertimage_8.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;9&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Por último guardar el libro Excel con el nombre &lt;code&gt;acreditados.xlsx&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div id=&#34;análisis-estadístico-en-r&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Análisis estadístico en &lt;code&gt;R&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Abrimos el software RStudio y generamos un nuevo script:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;index.es_insertimage_9.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Guardamos el script con el nombre &lt;code&gt;acreditados.R&lt;/code&gt; en el &lt;strong&gt;mismo directorio&lt;/strong&gt;
que guardamos la base de datos limpia &lt;code&gt;acreditados.xlsx&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Los siguientes comandos importan la base de datos del INN desde el Excel hasta &lt;code&gt;R&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(readxl)
acreditados &amp;lt;- read_excel(&amp;#39;acreditados.xlsx&amp;#39;, sheet = &amp;#39;datos&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La importación ha sido exitosa si observa la siguiente tabla con el comando &lt;code&gt;head()&lt;/code&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(acreditados)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;# A tibble: 6 × 7
      N N_certificado Organización      Tipo_de_OEC Area  Observaciones Telefono
  &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;         &amp;lt;chr&amp;gt;             &amp;lt;chr&amp;gt;       &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;         &amp;lt;chr&amp;gt;   
1     1 LE 633        Universidad Aust… Laboratori… Bioe… &amp;lt;NA&amp;gt;          (56 65)…
2     2 LE 800        Universidad de C… Laboratori… Bioe… &amp;lt;NA&amp;gt;          (56) 22…
3     3 LE 893        Universidad de C… Laboratori… Bioe… &amp;lt;NA&amp;gt;          (56 65)…
4     4 LE 1287       Secretaria Regio… Laboratori… Bioe… &amp;lt;NA&amp;gt;          (56 61)…
5     5 LE 1450       TAAG Genetics S.… Laboratori… Biol… &amp;lt;NA&amp;gt;          (56) 22…
6     6 LE 1279       Universidad de L… Laboratori… Bioq… &amp;lt;NA&amp;gt;          (56 64)…&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora haremos el gráfico de barras el cual indica el número de laboratorios de
ensayo acreditados por el INN al 03 de julio de 2023 clasificados por &lt;code&gt;Area&lt;/code&gt;.
Por una cuestión de espacios sólo se muestran aquellas áreas con más de 10 laboratorios acreditados:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)
library(readxl)
library(ggplot2)
library(magrittr)

acreditados &amp;lt;- read_excel(&amp;#39;acreditados.xlsx&amp;#39;, sheet = &amp;#39;datos&amp;#39;)

tabla &amp;lt;- acreditados %&amp;gt;% 
  group_by(Area) %&amp;gt;% 
  summarise(n = n())

# Número de acreditaciones suspendidas
n.suspendidos &amp;lt;- acreditados %&amp;gt;% 
  filter(!is.na(Observaciones)) %&amp;gt;% 
  count()

# Número de acreditaciones totales (incluyendo las suspendidas)
n.total &amp;lt;- acreditados %&amp;gt;% 
  count()


ggplot(tabla %&amp;gt;% filter(n &amp;gt;= 10), aes(x = reorder(Area, n), y = n, label = n)) +
  geom_bar(stat = &amp;quot;identity&amp;quot;, fill = &amp;#39;blue&amp;#39;, alpha = 0.7) +
  ylab(&amp;#39;N° de laboratorios de ensayo&amp;#39;) +
  xlab(&amp;#39;Área&amp;#39;) +
  labs(title = paste(&amp;#39;Acreditaciones en Chile por INN bajo ISO 17025 por área N =&amp;#39;, 
                     n.total),
       subtitle = paste(&amp;quot;Incluye &amp;quot;, n.suspendidos, &amp;quot;suspendidos. Sólo se muestran n &amp;gt; 10&amp;quot;),
       caption = &amp;quot;Fuente: https://acreditacion.innonline.cl/&amp;quot;) +
  theme_bw() +
  geom_text(size=5,hjust=1.5, col = &amp;#39;white&amp;#39;) +
  coord_flip()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/acreditados-inn-2023/index.es_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;1152&#34; /&gt;&lt;/p&gt;
&lt;p&gt;¡Listo!
En un siguiente paso podríamos desagregar por &lt;em&gt;Organización&lt;/em&gt;, de tal manera de
atribuir las acreditaciones clasificando por razón social ¿Le parece estimad@ lector@?&lt;/p&gt;
&lt;p&gt;Saludos&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Diplomado en Metrología</title>
      <link>https://www.analytical.cl/talk/diplomado-en-metrologia/</link>
      <pubDate>Thu, 01 Jun 2023 18:15:00 +0000</pubDate>
      <guid>https://www.analytical.cl/talk/diplomado-en-metrologia/</guid>
      <description>&lt;!---
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Click on the &lt;strong&gt;Slides&lt;/strong&gt; button above to view the built-in slides feature.
  &lt;/div&gt;
&lt;/div&gt;


Slides can be added in a few ways:

- **Create** slides using Wowchemy&#39;s [*Slides*](https://wowchemy.com/docs/managing-content/#create-slides) feature and link using `slides` parameter in the front matter of the talk file
- **Upload** an existing slide deck to `static/` and link using `url_slides` parameter in the front matter of the talk file
- **Embed** your slides (e.g. Google Slides) or presentation video on this page using [shortcodes](https://wowchemy.com/docs/writing-markdown-latex/).

Further event details, including [page elements](https://wowchemy.com/docs/writing-markdown-latex/) such as image galleries, can be added to the body of this page.
--&gt;
</description>
    </item>
    
    <item>
      <title>Diplomado en Metrología</title>
      <link>https://www.analytical.cl/talk/diplomado-en-metrologia/</link>
      <pubDate>Mon, 01 May 2023 09:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/talk/diplomado-en-metrologia/</guid>
      <description>&lt;!---
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Click on the &lt;strong&gt;Slides&lt;/strong&gt; button above to view the built-in slides feature.
  &lt;/div&gt;
&lt;/div&gt;


Slides can be added in a few ways:

- **Create** slides using Wowchemy&#39;s [*Slides*](https://wowchemy.com/docs/managing-content/#create-slides) feature and link using `slides` parameter in the front matter of the talk file
- **Upload** an existing slide deck to `static/` and link using `url_slides` parameter in the front matter of the talk file
- **Embed** your slides (e.g. Google Slides) or presentation video on this page using [shortcodes](https://wowchemy.com/docs/writing-markdown-latex/).

Further event details, including [page elements](https://wowchemy.com/docs/writing-markdown-latex/) such as image galleries, can be added to the body of this page.
--&gt;
</description>
    </item>
    
    <item>
      <title>Estimación de incertidumbre para laboratorios físico-químicos y microbiológicos.</title>
      <link>https://www.analytical.cl/talk/estimacion-de-incertidumbre-para-laboratorios-fisico-quimicos-y-microbiologicos./</link>
      <pubDate>Thu, 23 Mar 2023 09:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/talk/estimacion-de-incertidumbre-para-laboratorios-fisico-quimicos-y-microbiologicos./</guid>
      <description>&lt;!---
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Click on the &lt;strong&gt;Slides&lt;/strong&gt; button above to view the built-in slides feature.
  &lt;/div&gt;
&lt;/div&gt;


Slides can be added in a few ways:

- **Create** slides using Wowchemy&#39;s [*Slides*](https://wowchemy.com/docs/managing-content/#create-slides) feature and link using `slides` parameter in the front matter of the talk file
- **Upload** an existing slide deck to `static/` and link using `url_slides` parameter in the front matter of the talk file
- **Embed** your slides (e.g. Google Slides) or presentation video on this page using [shortcodes](https://wowchemy.com/docs/writing-markdown-latex/).

Further event details, including [page elements](https://wowchemy.com/docs/writing-markdown-latex/) such as image galleries, can be added to the body of this page.
--&gt;
</description>
    </item>
    
    <item>
      <title>Incertidumbre de una calibración no lineal con aplicación en química analítica</title>
      <link>https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/</link>
      <pubDate>Sat, 06 Jun 2020 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/</guid>
      <description>
&lt;script src=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;En un &lt;a href=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/&#34;&gt;post anterior&lt;/a&gt;
revisamos cómo estimar la incertidumbre de la concentración
de una muestra problema, cuando ésta ha sido obtenida interpolando la señal
instrumental en una curva de calibración lineal.&lt;/p&gt;
&lt;p&gt;La expresión es relativamente simple y vimos también cómo podemos implementarla
en el lenguaje de programación &lt;code&gt;R&lt;/code&gt; a través del package &lt;code&gt;chemCal&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Sin embargo, la vida no es tan sencilla. Recoradará estimad@ lector@ que está
bastante documentada la presencia de desviaciones de la linealidad
a altas concentraciones, fenómeno muy conocido en los métodos
espectrofotométricos (Ley de Lambert-Beer). La severidad de estas desviaciones
varía en función del detector, el analito y otros factores físico-químicos
del sistema de medición.&lt;/p&gt;
&lt;p&gt;Cuando existen estas desviaciones y deseamos llevar a cabo un
&lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;test de linealidad&lt;/a&gt;,
es muy probable que el test rechace el modelo lineal, por lo tanto, no podemos
estimar la incertidumbre de calibración asumiendo este modelo. Si bien es cierto
podemos reducir el rango lineal y diluir la muestra problema que está fuera
del rango, la operación de dilución introduce nuevos errores (incluso errores
humanos de transcripción bastante frecuentes).&lt;/p&gt;
&lt;p&gt;Una alternativa válida sería utilizar un modelo de calibración que capture esta
no linealidad evitando así la dilución de la muestra,
por lo tanto el problema se reduce a:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Cómo estimar la incertidumbre de una muestra problema que ha sido
obtenida a través de una curva de calibración no lineal?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Sin embargo, de esta pregunta se desprende al mismo tiempo otra interrogante:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Cuál modelo de calibración no lineal utilizaré?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Existen varios modelos de calibración no lineal:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Polinomios&lt;/li&gt;
&lt;li&gt;New Rational (en realidad se llaman &lt;em&gt;aproximaciones de Padé&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;Splines&lt;/li&gt;
&lt;li&gt;Loess&lt;/li&gt;
&lt;li&gt;etc.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Por lo tanto, no existe una respuesta completamente correcta desde
la prespectiva estadística, pues un modelo cuadrático sería tan válido como
un polinomio cúbico. Desde el punto de vista químico podríamos preguntarnos
¿qué sentido químico tiene una curva de calibración polinómica de grado 5?
¿Son interpretables los parámetros del modelo? En un modelo lineal como el
de Lambert-Beer: &lt;span class=&#34;math inline&#34;&gt;\(y = \beta_{0} + \beta_{1}x\)&lt;/span&gt; la pendiente de la curva de
calibración tiene una interpretación química: es el producto entre coeficiente
de extinción molar y la longitud de la celda:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:lambert&#34;&gt;\[
\underbrace{A}_\text{y} = \underbrace{\epsilon \cdot b}_\text{$\beta_{1}$} \cdot
\underbrace{C}_\text{x}
\tag{1}
\]&lt;/span&gt;
Pero recuerde este sabio consejo de un monstruo de la estadística aplicada:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;“All models are wrong, but some are useful”&lt;/em&gt;
– &lt;cite&gt;George Box&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Por lo tanto, tenemos que tomar una decisión. Y obviamente, como soy el autor de
este humilde post, ya la tomé por Ud. En este artículo estimaremos la
incertidumbre de calibración de un modelo polinómico de grado 2, también
conocido como modelo cuadrático.&lt;/p&gt;
&lt;p&gt;Nota: Desde el punto de vista &lt;strong&gt;estrictamente estadístico&lt;/strong&gt; los modelos
polinómicos, como la calibración cuadrática, son también modelos lineales ya que
los coeficientes del modelo son lineales&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[y = \beta_{0} + \beta_{1}x + \beta_{2}x^2 + \epsilon\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;En cambio, en un modelo del tipo exponencial:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[y = \beta_{0}\cdot e^{\beta_{1}x}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;El coeficiente &lt;span class=&#34;math inline&#34;&gt;\(\beta_{1}\)&lt;/span&gt; no es una función lineal.&lt;/p&gt;
&lt;div id=&#34;métodos-de-estimación-de-incertidumbre-de-calibración&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Métodos de estimación de incertidumbre de calibración&lt;/h1&gt;
&lt;p&gt;En este post ejemplificaremos y compararemos tres métodos de estimación
de incertidumbre de calibración:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Norma ISO 8466-2:2001 &lt;em&gt;Water quality – Calibration and evaluation of
analytical methods and estimation of performance characteristics – Part 2:
Calibration strategy for non-linear second-order calibration functions.&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Método GUM&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Método de Monte Carlo (Suplemento 1 ISO-GUM)&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Implementaremos todos los métodos en el lenguaje de programación &lt;code&gt;R&lt;/code&gt;, explicando
paso a paso el código fuente con el fin de que Ud. obtenga los mismos
resultados, es decir, un &lt;strong&gt;análisis reproducible&lt;/strong&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;datos-de-calibración&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Datos de calibración&lt;/h1&gt;
&lt;p&gt;Para ejemplificar los cálculos, utilizaremos los datos de calibración indicados
en el ejemplo de la sección 7 de la norma ISO 8466-2. El siguiente código &lt;code&gt;R&lt;/code&gt;
nos permite ingresar los datos manualmente:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Ingresamos los datos de calibración de la sección 7 de la norma ISO 8466-2
# x: concentración en mg/L
# y: Absorbancia [UA]

x &amp;lt;- c(12, 18, 24, 30, 36, 42, 48, 54, 60, 66)
y &amp;lt;- c(0.083, 0.123, 0.164, 0.203, 0.240, 0.273, 0.303, 0.334, 0.364, 0.393)

d &amp;lt;- data.frame(x, y) # creamos un data frame con las variables x e y (esto es
                      # análogo a una matriz de datos en Excel con dos columnas)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A continuación graficamos la curva de calibración con la librería &lt;code&gt;ggplot2&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2) # cargamos la librería ggplot2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;ggplot2&amp;#39; was built under R version 4.0.5&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;theme_set(theme_minimal()) # esto es sólo por una cuestión estética del gráfico

ggplot(d, aes(x = x, y = y)) +
  geom_point(color = &amp;#39;red&amp;#39;) +
  xlab(&amp;#39;Concentración [mg/L]&amp;#39;) +
  ylab(&amp;#39;Absorbancia [UA]&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/index_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Mmm… no sé Ud. pero yo veo una leve curvatura.
Como lo vimos en un &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;post anterior&lt;/a&gt;
llevaremos a cabo un análisis estadístico básico para evaluar si el modelo de
calibración lineal es adecuado, o si nos inclinamos por la hipótesis de no
linealidad.&lt;/p&gt;
&lt;p&gt;Como no tenemos replicados de cada punto de calibración, haremos un Test de
Linealidad de Mandel. Lo primero, es ajustar un modelo lineal a los datos
&lt;span class=&#34;math inline&#34;&gt;\(y = a + bx\)&lt;/span&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit.lineal &amp;lt;- lm(y ~ x, data = d) # ajustamos un modelo lineal y lo guardamos 
                                  # con el nombre fit.lineal

summary(fit.lineal) # para ver el análisis estadístico del ajuste&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = y ~ x, data = d)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.010636 -0.004720  0.001000  0.005727  0.009151 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept) 0.0250303  0.0058314   4.292  0.00264 ** 
## x           0.0057172  0.0001368  41.803 1.18e-10 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.007453 on 8 degrees of freedom
## Multiple R-squared:  0.9954, Adjusted R-squared:  0.9949 
## F-statistic:  1747 on 1 and 8 DF,  p-value: 1.181e-10&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Esta tabla nos dice que el intercepto del modelo es
&lt;span class=&#34;math inline&#34;&gt;\(a = 0.0250303\)&lt;/span&gt; y la pendiente &lt;span class=&#34;math inline&#34;&gt;\(b = 0.0057172\)&lt;/span&gt;.
Note el alto coeficiente de determinación
&lt;span class=&#34;math inline&#34;&gt;\(r^{2} = 0.9954\)&lt;/span&gt; lo cual indica que es un
buen modelo. El coeficiente de correlación es
&lt;span class=&#34;math inline&#34;&gt;\(r = 0.998\)&lt;/span&gt; que si bien es un dato a
considerar, no es una prueba formal de linealidad.&lt;/p&gt;
&lt;p&gt;La siguiente figura muestra el ajuste lineal sobre los datos de calibración:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggpmisc) # para escribir ecuaciones dentro del gráfico&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;ggpmisc&amp;#39; was built under R version 4.0.4&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;ggpmisc&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:ggplot2&amp;#39;:
## 
##     annotate&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(d, aes(x = x, y = y)) +
  geom_point(color = &amp;#39;red&amp;#39;) +
  geom_smooth(method = &amp;#39;lm&amp;#39;, se = F, 
              size = 0.5) + # dibuja la curva de calibración lineal
  xlab(&amp;#39;Concentración [mg/L]&amp;#39;) +
  ylab(&amp;#39;Absorbancia [UA]&amp;#39;) +
  stat_poly_eq(aes(label =  paste(stat(eq.label), stat(rr.label), 
                                  sep = &amp;quot;*\&amp;quot;, \&amp;quot;*&amp;quot;)), 
               formula = y ~ x, 
               parse = TRUE, 
               rr.digits = 4)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/index_files/figure-html/plot.lineal-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Se observa que el ajuste lineal no es un buen modelo, pues no captura la
curvatura de los datos a pesar del alto coeficiente de correlación.
Esto se oberva más claramente si obervamos el gráfico
de residuos:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(fit.lineal, which = 1, add.smooth = F, pch = 19, col = &amp;#39;red&amp;#39;, 
     main = &amp;#39;Gráfico de residuos modelo lineal&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/index_files/figure-html/fit.lin.res-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La evidencia en contra del modelo lineal es abrumadora, el gráfico muestra
claramente un patrón en los residuos que indica que el modelo lineal
no es adecuado. Sin embargo, a pesar de la evidencia, haremos el Test de Mandel
para “comprobar” esta hipótesis. Para aplicar el Test de Mandel debemos ahora
ajustar el modelo cuadrático y compararlo con el modelo lineal.
Para ser consistentes en la notación de la
norma ISO 8466-2, definiremos el modelo de calibración cuadrático como:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ 
y = a + bx + cx^2
\]&lt;/span&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit.nolineal &amp;lt;- lm(y ~ x + I(x^2), data = d) # ajuste cuadrático y los guardamos 
                                          # con el nombre fit.nolineal
summary(fit.nolineal)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## lm(formula = y ~ x + I(x^2), data = d)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -1.864e-03 -1.114e-03  6.818e-05  9.432e-04  1.939e-03 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept) -5.621e-03  2.475e-03  -2.271   0.0574 .  
## x            7.670e-03  1.420e-04  54.005 1.96e-10 ***
## I(x^2)      -2.504e-05  1.787e-06 -14.010 2.23e-06 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## Residual standard error: 0.001479 on 7 degrees of freedom
## Multiple R-squared:  0.9998, Adjusted R-squared:  0.9998 
## F-statistic: 2.23e+04 on 2 and 7 DF,  p-value: 4.84e-14&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Se obtiene una tabla similar que la del modelo lineal, con la adición del
coeficiente que acompaña al
&lt;span class=&#34;math inline&#34;&gt;\(x^2\)&lt;/span&gt;: &lt;code&gt;I(x^2)&lt;/code&gt; &lt;span class=&#34;math inline&#34;&gt;\(= -2.504\times 10^{-5}\)&lt;/span&gt;. Note
que el coeficiente de determinación del modelo cuadrático es mayor que el
del modelo lineal. Esto siempre se cumplirá, lo que hace el Test de Mandel es
discernir si esta “mejora” en el modelo es “significativa”.&lt;/p&gt;
&lt;p&gt;La siguiente figura muestra el ajuste no lineal, el cual captura mucho mejor
la curvatura de los datos:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(d, aes(x = x, y = y)) +
  geom_point(color = &amp;#39;red&amp;#39;) +
  geom_smooth(method = &amp;#39;lm&amp;#39;,         # dibuja la curva de calibración no lineal
              se = F, 
              formula = y ~ x + I(x^2), size = 0.5) + 
  xlab(&amp;#39;Concentración [mg/L]&amp;#39;) +
  ylab(&amp;#39;Absorbancia [UA]&amp;#39;) +
  stat_poly_eq(aes(label =  paste(stat(eq.label), stat(rr.label), 
                                  sep = &amp;quot;*\&amp;quot;, \&amp;quot;*&amp;quot;)),
               formula = y ~ x + I(x^2), 
               parse = TRUE, 
               rr.digits = 4)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/index_files/figure-html/plot.nolineal-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Ok, aplicamos
el Test de Mandel con el comando &lt;code&gt;anova&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;anova(fit.lineal, fit.nolineal)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Analysis of Variance Table
## 
## Model 1: y ~ x
## Model 2: y ~ x + I(x^2)
##   Res.Df        RSS Df  Sum of Sq      F    Pr(&amp;gt;F)    
## 1      8 0.00044442                                   
## 2      7 0.00001530  1 0.00042912 196.29 2.235e-06 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El p-value del test de Mandel es &lt;span class=&#34;math inline&#34;&gt;\(2.23\times 10^{-6}\)&lt;/span&gt;, el cual de acuerdo a
la interpretación tradicional, indica que el modelo lineal no es adecuado para
los datos de calibración.&lt;/p&gt;
&lt;p&gt;Procedamos, entonces, a estimar la incertidumbre de la concentración &lt;span class=&#34;math inline&#34;&gt;\(\hat{x}\)&lt;/span&gt;
de una muestra problema, cuyo valor fue obtenido interpolando la señal
instrumental en el modelo de calibración no lineal.&lt;/p&gt;
&lt;div id=&#34;estimación-de-incertidumbre-de-acuerdo-a-iso-8466-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Estimación de incertidumbre de acuerdo a ISO 8466-2&lt;/h2&gt;
&lt;p&gt;Desde el punto de vista metrológico, la aproximación que indica esta norma es
similar a lo que dicta la guía ISO GUM clásica, es decir,
estima la incertidumbre a partir de un modelo de medición &lt;span class=&#34;math inline&#34;&gt;\(y = f(x)\)&lt;/span&gt;.
La “gracia” de esta norma es que nos
ahorra tinta, pues la ecuación de incertidumbre ya está “algebraicamente
manipulada”. No entraremos en los detalles de las primeras secciones de la
norma los cuales estudian el comportamiento de la curvatura, es decir, si será
posible encontrar un máximo o un mínimo, lo cual es clave en la utilidad del
modelo cuadrático como función de calibración. Esto es
importante porque recuerde que una función parabólica tiene dos soluciones, si
existiera un máximo o un mínimo en el rango de trabajo, el modelo cuadrático no
puede ser utilizado como función de calibración.&lt;/p&gt;
&lt;p&gt;La siguiente ecuación calcula la &lt;strong&gt;incertidumbre expandida&lt;/strong&gt;
&lt;span class=&#34;math inline&#34;&gt;\(I(\hat{x}) = U_{\hat{x}}\)&lt;/span&gt; de la concentración de la muestra problema &lt;span class=&#34;math inline&#34;&gt;\(\hat{x}\)&lt;/span&gt;,
interpolada en la curva de calibración no lineal &lt;span class=&#34;math inline&#34;&gt;\(y = a + bx + cx^2\)&lt;/span&gt;.
Corresponde a la ecuación (27) de la norma:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
I(\hat{x}) = \frac{s_{y} \cdot t_{n - 3,\, 95\%}}{b + 2c\hat{x}} \cdot
            \sqrt{\frac{1}{N} + \frac{1}{\hat{N}} + 
            \frac{(\hat{x} - \overline{x})^2 \, Q_{x^4} + 
            \left(\hat{x}^2 - \frac{\sum x_{i}^{2}}{N} \right)^2 Q_{xx} -
            2(\hat{x} - \overline{x}) 
            \left(\hat{x}^2 - \frac{\sum x_{i}^{2}}{N} \right) Q_{x^3}}
            {Q_{x^4} Q_{xx} - \left( Q_{x^3} \right)^2}}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
s_{y} = \sqrt{\frac{\sum (y_{i} -\hat{y})^2}{N - 3}}
\]&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(y_{i}\)&lt;/span&gt; es la respuesta experimental observada del estándar &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\hat{y}\)&lt;/span&gt; es la
respuesta instrumental que predice el modelo para el mismo estándar &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;, por lo
tanto &lt;span class=&#34;math inline&#34;&gt;\(e_{i} = y_{i} - \hat{y}\)&lt;/span&gt; es el residuo. &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; es el número de calibrantes.
¿Por qué el denominador es &lt;span class=&#34;math inline&#34;&gt;\(N - 3\)&lt;/span&gt; y no &lt;span class=&#34;math inline&#34;&gt;\(N -2\)&lt;/span&gt; como en la calibración lineal?
Porque el modelo cuadrático posee tres parámetros &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(t_{N - 3,\, 95\%}\)&lt;/span&gt; es el valor del T de Student con &lt;span class=&#34;math inline&#34;&gt;\(N - 3\)&lt;/span&gt; grados de
libertad y un 95% de confianza.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\hat{N}\)&lt;/span&gt; es el número de replicados
independientes de la muestra problema. Como discutimos en
&lt;a href=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/&#34;&gt;otro post&lt;/a&gt;,
esto no corresponde a inyectar &lt;span class=&#34;math inline&#34;&gt;\(\hat{N}\)&lt;/span&gt; veces la misma muestra en el
instrumento.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\hat{x}\)&lt;/span&gt; es la concentración de la muestra problema interpolada en la curva
de calibración no lineal, la cual se obtiene resolviendo la ecuación
cuadrática. Como Ud. recordará de sus años mozos esto siginifica que
la concentración interpolada se obtiene a partir de:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\hat{x} = \frac{-b \pm \sqrt{b^2 - 4(a - y_{0})c}}{2c}\]&lt;/span&gt;
donde &lt;span class=&#34;math inline&#34;&gt;\(y_{0}\)&lt;/span&gt; es la señal instrumental de la muestra problema.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(x_{i}\)&lt;/span&gt; es la concentración del estándar &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\overline{x} = \sum_{i = 1}^{N} x_{i}\)&lt;/span&gt; es el promedio de las concentraciones
de los calibrantes.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Finalmente:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
Q_{xx}  &amp;amp;= \sum x_{i}^2 - \frac{\left(\sum x_{i}\right)^2}{N} \\
Q_{x^3} &amp;amp;= \sum x_{i}^3 - \left(\sum x_{i} \times \frac{\sum x_{i}^2}{N}\right) \\
Q_{x^4} &amp;amp;= \sum x_{i}^4 - \frac{\left(\sum x_{i}^2\right)^2}{N}
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Ok, nada del otro mundo. Es bien fea, pero sólo son operaciones de aritmética
básica. Algunas observaciones:&lt;/p&gt;
&lt;p&gt;Como Ud. recordará en el caso de la calibración lineal, a partir de esta
ecuación podemos inferir que si deseamos minimizar la incertidumbre de
calibración no lineal podemos :&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Aumentar el número de calibrantes &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Aumentar el número de replicados independientes de la muestra problema &lt;span class=&#34;math inline&#34;&gt;\(\hat{N}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Aumentar la sensibilidad del método, que en el caso de la calibración
cuadrática está dada por &lt;span class=&#34;math inline&#34;&gt;\(b + 2c\hat{x}\)&lt;/span&gt;, es decir, depende de la concentración
de la muestra problema &lt;span class=&#34;math inline&#34;&gt;\(\hat{x}\)&lt;/span&gt;. En cambio, en la calibración lineal la
sensibilidad era constante en todo el rango de concentración estudiado y
correspondía a la pediente de la curva.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;En el caso de la calibración lineal, la incertidumbre de calibración se minimiza
en el centroide de la curva, en el caso del modelo cuadrático esto no siempre
es así. Observe en la siguiente figura las bandas de confianza de ambos tipos de
calibración:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;patchwork&amp;#39; was built under R version 4.0.4&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/index_files/figure-html/patch-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Advierta que ambos modelos comparten la propiedad que la mayor incertidumbre se
encuentra en los extremos. Sin embargo, en la calibración cuadrática, para este
conjunto de datos, la menor incertidumbre no está en el centro de la curva.&lt;/p&gt;
&lt;p&gt;Ok, a continuación implementaremos la ecuación de incertidumbre en &lt;code&gt;R&lt;/code&gt; con los
datos del ejemplo de la sección 7 de la norma. La señal instrumental de la
muestra problema es &lt;span class=&#34;math inline&#34;&gt;\(y_{0} = 0.084\)&lt;/span&gt; UA:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;N &amp;lt;- length(x) # Número de calibrantes
N.hat &amp;lt;- 1     # Número de replicados de la muestra problema
Qxx &amp;lt;- sum(x^2) - sum(x)^2/N
Qx3 &amp;lt;- sum(x^3) -(sum(x) * sum(x^2)/N)
Qx4 &amp;lt;- sum(x^4) - sum(x^2)^2/N

a &amp;lt;- fit.nolineal$coefficients[1]
b &amp;lt;- fit.nolineal$coefficients[2]
c &amp;lt;- fit.nolineal$coefficients[3]

s.y &amp;lt;- summary(fit.nolineal)$sigma # Es lo que R denomina Residual standard error
t &amp;lt;- qt(0.975, N - 3) # El T de Student (¡Ya no se usan tablas!)

y0 &amp;lt;- 0.084 # Es la señal instrumental de la muestra problema
x.hat &amp;lt;- (-b + sqrt(b^2 - 4*(a - y0)*c))/(2*c) # Concentración de la muestra

Ix &amp;lt;- (s.y * t)/(b + 2*c*x.hat) * sqrt(
  1/N + 1/N.hat + ((x.hat - mean(x))^2*Qx4 + (x.hat^2 - sum(x^2)/N)^2 * Qxx -  
  2*(x.hat - mean(x))*(x.hat^2 - sum(x^2)/N)*Qx3)/
  (Qx4 * Qxx - Qx3^2)
)

Ix &amp;lt;- unname(Ix) # Simplemente es para dejar sólo el número&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La concentración de la muestra es &lt;span class=&#34;math inline&#34;&gt;\(\hat{x} = 12.17\)&lt;/span&gt; mg/L.
Al aplicar esta metodología obtenemos una incertidumbre expandida de
&lt;span class=&#34;math inline&#34;&gt;\(I(\hat{x}) = 0.63\)&lt;/span&gt; mg/L, es decir, exactamente la misma que la que
indica la norma ISO. Note que si Ud. quisiera combinar esta incertidumbre de
calibración con algún otro factor (p.ej: masa de la muestra, volumen de aforo,
etc.) debe primero tansformarla en incertidumbre estándar, dividiéndola por el
factor de cobertura &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;, que en este caso corresponde al t Student con &lt;span class=&#34;math inline&#34;&gt;\(N - 3\)&lt;/span&gt;
grados de libertad al 95% de confianza (k = 2.36):&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
u_{\hat{x}} = \frac{U_{\hat{x}}}{k} = 0.27\, \, \text{mg/L}
\]&lt;/span&gt;
Por lo tanto, si tuviéramos que informar el resultado de la concentración
de la muestra interpolada en la curva de calibración no lineal informaríamos
&lt;span class=&#34;math inline&#34;&gt;\(12.17 \pm 0.63\)&lt;/span&gt; mg/L [&lt;em&gt;nota mental: mmmm… esto de
las cifras significativas da para otro post, pero dejémoslo así por ahora.
No olvidar borrar este comentario.&lt;/em&gt;]&lt;/p&gt;
&lt;p&gt;¿Cómo varía esta incertidumbre de calibración no lineal con la concentración de
la muestra? La siguiente figura muestra esta variación:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x &amp;lt;- seq(12, 66, by = 6) # Rango de concentración
N &amp;lt;- length(x)
N.hat &amp;lt;- 1
mu.x &amp;lt;- mean(x) # promedio de las concentraciones de los calibrantes
sq.x &amp;lt;- sum(x^2) # suma de las concentraciones de los calibrantes al cuadrado
Qxx &amp;lt;- sum(x^2) - sum(x)^2/N
Qx3 &amp;lt;- sum(x^3) -(sum(x) * sum(x^2)/N)
Qx4 &amp;lt;- sum(x^4) - sum(x^2)^2/N
t &amp;lt;- qt(0.975, N - 3)

# Para graficar la incertidumbre vs concentración, primero debemos crear una
# función que tome un X (una concentración) y calcule el Y (incertidumbre)
Ux &amp;lt;- function(x) {
    U &amp;lt;- s.y*t/(b + 2*c*x) * sqrt(
    1/N + 1/N.hat + ((x - mu.x)^2*Qx4 + (x^2 - sq.x/N)^2 * Qxx -  
    2*(x - mu.x)*(x^2 - sq.x/N)*Qx3)/
    (Qx4 * Qxx - Qx3^2))
    return(unname(U))
}

# Graficamos concentración (X) vs Incertidumbre (Y)

plot(x, Ux(x), type = &amp;#39;n&amp;#39;,
     main = &amp;#39;Concentración vs Incertidumbre de calibración&amp;#39;,
     xlab = &amp;#39;Concentración [mg/L]&amp;#39;,
     ylab = &amp;#39;Incertidumbre expandida [mg/L]&amp;#39;)
lines(spline(x, Ux(x)), col = &amp;#39;red&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/index_files/figure-html/u.vs.con-1.png&#34; width=&#34;672&#34; /&gt;
Se aprecia que la incertidumbre aumenta con la concentración en una forma no
constante para concentraciones mayores a 20 mg/L.
Tal como mencionamos anteriormente, el mínimo no se encuentra en el
centro del rango de concentración como ocurre con la calibración lineal. Para
encontrar el valor exacto de concentración que minimiza la incertidumbre en este
rango, usamos el comando &lt;code&gt;optimize&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Busca el mínimo de la función Ux en el intervalo de 12 a 66 mg/L
optimize(Ux, interval = c(12, 66))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $minimum
## [1] 20.29164
## 
## $objective
## [1] 0.5808116&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La concentración que minimiza la incertidumbre es
20.29 mg/L.&lt;/p&gt;
&lt;p&gt;Muy entretenido, pero la vida es corta y debemos ser eficientes por lo tanto,
para evitarnos el “tedio” de implementar la fórmula a mano, utilizaremos
el package &lt;code&gt;investr&lt;/code&gt; el cual calcula exactamente la incertidumbre de
calibración de un gran número de modelos de calibración, entre ellos, los
modelos cuadráticos:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# y0 es la señal de la muestra problema y0 = 0.084 UA
library(investr) # Cargamos la librería investr&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;investr&amp;#39; was built under R version 4.0.4&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x.hat &amp;lt;- invest(fit.nolineal, data = d, y0 = y0, interval = &amp;#39;Wald&amp;#39;)
x.hat&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   estimate      lower      upper         se 
## 12.1672952 11.5400416 12.7945488  0.2652656&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;donde:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;estimate&lt;/code&gt; es la concentración de la muestra problema&lt;/li&gt;
&lt;li&gt;&lt;code&gt;upper&lt;/code&gt; es el extremo superior de la incertidumbre expandida &lt;span class=&#34;math inline&#34;&gt;\(I(\hat{x})\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lower&lt;/code&gt; es el extremo inferior de la incertidumbre expandida &lt;span class=&#34;math inline&#34;&gt;\(I(\hat{x})\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;se&lt;/code&gt; es la incertidumbre estándar de calibración &lt;span class=&#34;math inline&#34;&gt;\(u_{\hat{x}}\)&lt;/span&gt;, la cual es
exactamente igual a la obtenida por la fórmula anterior
&lt;span class=&#34;math inline&#34;&gt;\(u_{\hat{x}} = \frac{U_{\hat{x}}}{k} = 0.27\, \, \text{mg/L}\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note que si quisiéramos obener &lt;span class=&#34;math inline&#34;&gt;\(I(\hat{x})\)&lt;/span&gt; a partir de esta tabla, tendríamos
que hacer la siguiente operación &lt;span class=&#34;math inline&#34;&gt;\(I(\hat{x}) =\)&lt;/span&gt; &lt;code&gt;upper&lt;/code&gt; - &lt;code&gt;estimate&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x.hat$upper - x.hat$estimate&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.6272536&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;No podemos usar el package &lt;code&gt;chemCal&lt;/code&gt; que utilizamos
en un &lt;a href=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/&#34;&gt;post anterior&lt;/a&gt;
para estimar la incertidumbre de calibración, porque este package sólo soporta
calibraciones lineales.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;estimación-de-incertidumbre-mediante-guía-iso-gum&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Estimación de incertidumbre mediante Guía ISO GUM&lt;/h2&gt;
&lt;p&gt;Ya que la señal instrumental es una función de la concentración, entonces,
podemos utilizar la aproximación ISO GUM clásica para estimar la incertidumbre
de calibración. Por “clásica” me refiero a utilizar la aproximación de Taylor
con las derivadas parciales. Esta guía dice lo siguiente:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Expresar el mensurando como una ecuación de medición a través de una relación
funcional con las magnitudes de entrada. En este caso el mensurando es la
concentración &lt;span class=&#34;math inline&#34;&gt;\(\hat{x}\)&lt;/span&gt; cuya ecuación de medición es la solución de la ecuación
cuadrática &lt;span class=&#34;math inline&#34;&gt;\(y_{0} = a + b\hat{x} + c\hat{x^2}\)&lt;/span&gt; donde &lt;span class=&#34;math inline&#34;&gt;\(y_{0}\)&lt;/span&gt; es la señal de la
muestra problema:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\hat{x} = \frac{-b \pm \sqrt{b^2 - 4(a - y_{0})c}}{2c}
\]&lt;/span&gt;
2. Identificación de las fuentes de incertidumbre. Al observar la ecuación de
medición identificamos las siguientes fuentes de incertidumbre:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Parámetros del modelo cuadrático: &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Señal instrumental de la muestra problema &lt;span class=&#34;math inline&#34;&gt;\(y_{0}\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Evaluación de las fuentes de incertidumbre:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Las incertidumbres estándar de los parámetros del modelo pueden ser obtenidas
directamente del ajuste cuadrático &lt;code&gt;fit.nolineal&lt;/code&gt;:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# parámetros del modelo
a &amp;lt;- fit.nolineal$coeff[1]
b &amp;lt;- fit.nolineal$coeff[2]
c &amp;lt;- fit.nolineal$coeff[3]

# las incertidumbres estándar de a, b y c las obtenemos con la función summary
ua &amp;lt;- summary(fit.nolineal)$coefficients[1, 2]
ub &amp;lt;- summary(fit.nolineal)$coefficients[2, 2]
uc &amp;lt;- summary(fit.nolineal)$coefficients[3, 2]&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;La incertidumbre estándar de la señal instrumental de la muestra problema
también puede obtenerse del ajuste cuadrático y corresponde a la
desviación estándar residual:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;uy0 &amp;lt;- summary(fit.nolineal)$sigma
y0 &amp;lt;- 0.084 # dato del problema, es decir, la absorbancia de la muestra&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Determinación de la incertidumbre estándar combinada &lt;span class=&#34;math inline&#34;&gt;\(u_{\hat{x}}\)&lt;/span&gt; a través
de la expresión:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
u_{\hat{x}}^2 = \left( \frac{\partial{\hat{x}}}{\partial{y_{0}}}\right) ^{2} (u_{y_{0}})^{2} + 
\left( \frac{\partial{\hat{x}}}{\partial{a}}\right) ^{2} (u_{a})^{2} + 
\left( \frac{\partial{\hat{x}}}{\partial{b}}\right) ^{2} (u_{b})^{2} +
\left( \frac{\partial{\hat{x}}}{\partial{c}}\right )^{2} (u_{c})^{2}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;“sólo” nos falta obtener las derivadas parciales (aguante ese código &lt;span class=&#34;math inline&#34;&gt;\(\LaTeX\)&lt;/span&gt;):&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
\frac{\partial{\hat{x}}}{\partial{y_{0}}} &amp;amp;= 
\frac{1}{\sqrt{b^{2} - 4c(a-y_{0})}} \\
\frac{\partial{\hat{x}}}{\partial{a}} &amp;amp;=
  \frac{-1}{\sqrt{b^{2} - 4c(a-y_{0})}} \\
\frac{\partial{\hat{x}}}{\partial{b}} &amp;amp;=
\frac{-1 + \frac{b}{\sqrt{b^{2} - 4c(a-y_{0})}}}{2c} \\
\frac{\partial{\hat{x}}}{\partial{c}} &amp;amp;=
  \frac{-a + y_{0}}{c\sqrt{b^{2} - 4c(a-y_{0})}} - 
  \frac{-b + \sqrt{b^{2} - 4c(a-y_{0})}}{2c^{2}}
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;¡Listo! ahora debemos evaluar las expresiones. Pero como soy flojo,
prefiero usar el excelente package &lt;code&gt;metRology&lt;/code&gt; que hará todo el trabajo por
mí:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(metRology) # cargamos la librería&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;metRology&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following objects are masked from &amp;#39;package:base&amp;#39;:
## 
##     cbind, rbind&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;expr &amp;lt;- expression((-b + sqrt(b^2 - 4*(a - y0)*c))/(2*c)) # ecuación de medición
x &amp;lt;- list(a = a, b = b, c = c, y0 = y0) # valores de cada X input
u &amp;lt;- c(ua, ub, uc, uy0) # incertidumbres estándar de cada X input
u.GUM &amp;lt;- uncert(expr, x, u, method = &amp;#39;GUM&amp;#39;) # Usamos el método GUM
u.GUM&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Uncertainty evaluation
## 
## Call:
##   uncert.expression(obj = expr, x = x, u = u, method = &amp;quot;GUM&amp;quot;)
## 
## Expression: (-b + sqrt(b^2 - 4 * (a - y0) * c))/(2 * c)
## 
## Evaluation method:  GUM 
## 
## Uncertainty budget:
##    x             u            c           u.c        
## a  -5.621212e-03 2.474778e-03   -141.6217 -0.35048212
## b   7.670455e-03 1.420320e-04  -1723.1492 -0.24474238
## c  -2.504209e-05 1.787394e-06 -20966.0252 -0.03747454
## y0  8.400000e-02 1.478563e-03    141.6217  0.20939648
## 
##    y:  12.16727
## u(y):  0.4774807&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;¿What? ¿Por qué obtuvimos una incertidumbre estándar de 0.477
y no la que calculamos con la ecuación de la norma ISO 0.265?
Por la sencilla razón de que los parámetros de un modelo cuadrático no son
independientes, sus covarianzas no son 0. Es más, algunas de las covarianzas
son negativas. Observe la siguiente figura que fue obtenida simulando
curvas de calibración cuadráticas. En la figura se muestra las correlaciones
entre los tres parámetros del modelo no lineal:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Simularemos p = 200 curvas de calibración cuadráticas a partir de los datos 
# empíricos 

p &amp;lt;- 200 # Número de simulaciones
a.sim &amp;lt;- numeric(p) # vector que guardará el parámetro a
b.sim &amp;lt;- numeric(p) # vector que guardará el parámetro b
c.sim &amp;lt;- numeric(p) # vector que guardará el parámetro c

# Hacemos un loop
for(i in 1:p){
  x.sim &amp;lt;- seq(12, 66, by = 6)
  y.sim &amp;lt;- a + b*x.sim + c*x.sim^2 + rnorm(length(x.sim), 0, uy0)
  fit.nolineal.sim &amp;lt;- lm(y.sim ~ x.sim + I(x.sim^2))
  a.sim[i] &amp;lt;- fit.nolineal.sim$coeff[1]
  b.sim[i] &amp;lt;- fit.nolineal.sim$coeff[2]
  c.sim[i] &amp;lt;- fit.nolineal.sim$coeff[3]
}

# guardamos los parámetros simulados en un data frame que llamamos param.sim
param.sim &amp;lt;- data.frame(a.sim, b.sim, c.sim) 
                                                
# graficamos los parámetros simulados
plot(param.sim)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/index_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Se advierte claramente que existe una correlación negativa entre los parámetros
&lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;, además entre &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;. La correlación entre &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; es positiva.
En rigor, habría que incorporar las derivadas parciales cruzadas y las
covarianzas entre los parámetros. De sólo pensarlo, me dan ganas de
procastinar aún más la escritura de este post, así que recurriremos al
package &lt;code&gt;metRology&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;La parte “fácil” es obtener la matriz de covarianzas de los parámetros del
modelo con el comando &lt;code&gt;vcov&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;v &amp;lt;- vcov(fit.nolineal)
colnames(v) &amp;lt;- c(&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;) # solo cosmética para que aparezcan los nombres
rownames(v) &amp;lt;- c(&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;) # de los parámetros (es opcional)
v&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##               a             b             c
## a  6.124524e-06 -3.337187e-07  3.910406e-09
## b -3.337187e-07  2.017310e-08 -2.491926e-10
## c  3.910406e-09 -2.491926e-10  3.194776e-12&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La diagonal de esta matriz es precisamente la incertidumbre estándar al
cuadrado de los parámetros (a.k.a sus varianzas). Si queremos, también podemos
expresarla como matriz de correlaciones con el comando &lt;code&gt;cov2cor&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;param.cor &amp;lt;- cov2cor(v)
param.cor&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##            a          b          c
## a  1.0000000 -0.9494193  0.8840269
## b -0.9494193  1.0000000 -0.9815865
## c  0.8840269 -0.9815865  1.0000000&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En la diagonal de esta matriz obviamente esperamos correlación 1. Se observa
claramente la alta correlación entre los parámetros, como dijimos anteriormente,
algunas de ellas son negativas.&lt;/p&gt;
&lt;p&gt;La parte “difícil” es que debemos incorporar la variable señal
instrumental de la muestra problema &lt;span class=&#34;math inline&#34;&gt;\(y_{0}\)&lt;/span&gt;, la cual obviamente es independiente
de los parámetros del modelo:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Incorporamos la variable y0 que es independiente de los parámetros
v &amp;lt;- rbind(v, y0 = rep(0, 3)) 
v &amp;lt;- cbind(v, y0 = rep(0, 4))
v[4, 4] &amp;lt;- uy0^2 # Asignamos al elemento de la 4a fila y 4a columna  
                 # la varianza de y0
v&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                a             b             c           y0
## a   6.124524e-06 -3.337187e-07  3.910406e-09 0.000000e+00
## b  -3.337187e-07  2.017310e-08 -2.491926e-10 0.000000e+00
## c   3.910406e-09 -2.491926e-10  3.194776e-12 0.000000e+00
## y0  0.000000e+00  0.000000e+00  0.000000e+00 2.186147e-06&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora, incorporamos las covarianzas en el cálculo por método GUM:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;u.GUM.cov &amp;lt;- uncert(expr, x, cov = v, method = &amp;quot;GUM&amp;quot;)
u.GUM.cov&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Uncertainty evaluation
## 
## Call:
##   uncert.expression(obj = expr, x = x, method = &amp;quot;GUM&amp;quot;, cov = v)
## 
## Expression: (-b + sqrt(b^2 - 4 * (a - y0) * c))/(2 * c)
## 
## Evaluation method:  GUM 
## 
## Uncertainty budget:
##    x             u            c           u.c        
## a  -5.621212e-03 2.474778e-03   -141.6217 -0.35048212
## b   7.670455e-03 1.420320e-04  -1723.1492 -0.24474238
## c  -2.504209e-05 1.787394e-06 -20966.0252 -0.03747454
## y0  8.400000e-02 1.478563e-03    141.6217  0.20939648
## 
##    y:  12.16727
## u(y):  0.2651904&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;¡Perfecto!, ahora sí, al incluir las covarianzas obtenemos resultados consistentes
con el método descrito en la norma ISO 8466-2.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;estimación-con-el-método-de-monte-carlo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Estimación con el Método de Monte Carlo&lt;/h2&gt;
&lt;p&gt;No detallaremos aquí cómo funciona el método de Monte Carlo, puede consultarlo
en &lt;a href=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/&#34;&gt;este post&lt;/a&gt; y en
&lt;a href=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/&#34;&gt;este otro&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sería super simple si usamos el package &lt;code&gt;metRology&lt;/code&gt;, el problema es que el
package lanza un error numérico cuando existen covarianzas negativas. Probé
el ejemplo que incluye el manual de &lt;code&gt;metRology&lt;/code&gt; y el error se repite. Es un
problema al evaluar la suma de las correlaciones. Le
consulté al autor Steve Ellison, sin embargo, a la fecha (09 de junio 2020)
aún no tengo respuesta, a pesar de que Steve siempre responde las consultas en
forma muy expedita. Otros usuarios han tenido un problema similar y se ha
abierto un hilo en &lt;a href=&#34;https://stackoverflow.com/questions/60971950/error-in-eigensigma-symmetric-true-0-x-0-matrix-in-metrology-uncertmc-wit/62119518#62119518&#34;&gt;stackoverflow&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Por lo tanto, implementamos el método de Monte Carlo “a mano” utilizando el
package &lt;code&gt;MASS&lt;/code&gt; el cual permite generar muestras aleatorias multivariadas
incluyendo las correlaciones:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# No funciona metRology MC así que lo hicimos a mano
library(MASS) # cargamos la librería&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;MASS&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:patchwork&amp;#39;:
## 
##     area&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Generamos n muestras aleatorias multivariadas, cuyas medias 
# corresponden a los valores de a, b, c e y0
# La matriz de covarianza Sigma = v la calculamos anteriormente

set.seed(123) # Para que Ud. obtenga los mismos resultados
muestra.MC &amp;lt;- mvrnorm(n = 10000, mu = c(a, b, c, y0), Sigma = v, empirical = T)
colnames(muestra.MC) &amp;lt;- c(&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;y0&amp;#39;) # solo cosmética
muestra.MC &amp;lt;- data.frame(muestra.MC) # lo guardamos como data.frame
head(muestra.MC) # muestra las primeras n = 6 simulaciones&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##              a           b             c         y0
## 1 -0.004872147 0.007615757 -2.422806e-05 0.08771566
## 2 -0.004584974 0.007614935 -2.439880e-05 0.08385741
## 3 -0.005903886 0.007685426 -2.569142e-05 0.08643112
## 4 -0.004770996 0.007561121 -2.367442e-05 0.08417975
## 5 -0.003113309 0.007559284 -2.403774e-05 0.08478106
## 6 -0.006100136 0.007724920 -2.626908e-05 0.08644533&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Cada fila es una simulación. Si, por ejemplo, calculamos el promedio de cada
variable simulada, obtenemos un valor similar a los valores empíricos. A mayor
número de simulaciones, más nos acercamos a valores que asumimos como
verdaderos.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;apply(muestra.MC, 2, mean) # promedio de cada columna&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##             a             b             c            y0 
## -5.621212e-03  7.670455e-03 -2.504209e-05  8.400000e-02&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Bien, lo que tenemos que hacer es que en cada simulación debemos
calcular la concentración de la muestra:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# cargaré estas librerías sólo para facilitar la manipulación de los datos
library(magrittr)
library(tidyverse)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## v tibble  3.1.5     v dplyr   1.0.7
## v tidyr   1.1.4     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.1
## v purrr   0.3.4&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;tibble&amp;#39; was built under R version 4.0.5&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;tidyr&amp;#39; was built under R version 4.0.5&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;dplyr&amp;#39; was built under R version 4.0.5&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;forcats&amp;#39; was built under R version 4.0.4&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x ggpmisc::annotate() masks ggplot2::annotate()
## x tidyr::extract()    masks magrittr::extract()
## x dplyr::filter()     masks stats::filter()
## x dplyr::lag()        masks stats::lag()
## x dplyr::select()     masks MASS::select()
## x purrr::set_names()  masks magrittr::set_names()&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Creamos una nueva variable llamada x.hat que corresponde a la concentración de
# la muestra
muestra.MC &amp;lt;- muestra.MC %&amp;gt;% 
  mutate(x.hat = (-b + sqrt(b^2 - 4*(a - y0)*c))/(2*c))
head(muestra.MC) # muestra las primeras n = 6 simulaciones&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##              a           b             c         y0    x.hat
## 1 -0.004872147 0.007615757 -2.422806e-05 0.08771566 12.66792
## 2 -0.004584974 0.007614935 -2.439880e-05 0.08385741 12.08205
## 3 -0.005903886 0.007685426 -2.569142e-05 0.08643112 12.53997
## 4 -0.004770996 0.007561121 -2.367442e-05 0.08417975 12.23276
## 5 -0.003113309 0.007559284 -2.403774e-05 0.08478106 12.09232
## 6 -0.006100136 0.007724920 -2.626908e-05 0.08644533 12.51252&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La última columna corresponde a la concentración calculada para cada
simulación. Por lo tanto, si queremos obtener la incertidumbre estándar de
la concentración, basta calcular la desviación estándar de esa columna:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mu.x.hat.MC &amp;lt;- mean(muestra.MC$x.hat) # valor promedio de concentración
u.x.hat.MC &amp;lt;- sd(muestra.MC$x.hat) # incertidumbre estándar de la concentración
u.x.hat.MC&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.265321&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Se obtiene una incertidumbre estándar de calibración de
0.265 mg/L, la
cual es consistente con los otros métodos estudiados. La siguiente
figura muestra el histograma de las concentraciones simuladas:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hist(muestra.MC$x.hat, 
     breaks = 20,
     main = &amp;#39;Concentraciones simuladas por Monte Carlo&amp;#39;,
     xlab = &amp;#39;Concentración [mg/L]&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/index_files/figure-html/plot.u.MC-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Finalmente, la siguiente tabla resume los resultados de los tres métodos
considerando la incertidumbre estándar de calibración:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tabla &amp;lt;- data.frame(Ix/t, u.GUM$u.y, u.GUM.cov$u.y, u.x.hat.MC)
knitr::kable(tabla, 
             rownames = NA,
             col.names = c(&amp;#39;ISO&amp;#39;, &amp;#39;GUM&amp;#39;, &amp;#39;GUM/Covarianzas&amp;#39;, &amp;#39;Monte Carlo&amp;#39;),
             align = &amp;#39;l&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;ISO&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;GUM&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;GUM/Covarianzas&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Monte Carlo&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;0.2651904&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;0.4774807&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;0.2651904&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;0.265321&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Se aprecia claramente una excelente concordancia entre los tres métodos.
Sin embargo, para que el método GUM entregue resultados correctos, es necesario
incorporar las covarianzas entre las variables input.&lt;/p&gt;
&lt;p&gt;En un próximo post exploraremos el método &lt;em&gt;Bootstrap&lt;/em&gt;, un método estadístico
por excelencia para estimar incertidumbre sin utilizar un modelo de medición…&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¡Dejad que los datos hablen!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografía&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Bibliografía&lt;/h1&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Norma ISO 8466-2:2001 &lt;em&gt;Water quality – Calibration and evaluation of
analytical methods and estimation of performance characteristics – Part 2:
Calibration strategy for non-linear second-order calibration functions.&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Brandon M. Greenwell and Christine M. Schubert Kabban (2014). investr: An R
Package for Inverse Estimation. The R Journal, 6(1), 90-100. URL &lt;a href=&#34;http://journal.r-project.org/archive/2014-1/greenwell-kabban.pdf&#34; class=&#34;uri&#34;&gt;http://journal.r-project.org/archive/2014-1/greenwell-kabban.pdf&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;NIST/SEMATECH e-Handbook of Statistical Methods,
&lt;em&gt;Uncertainty for quadratic calibration using propagation of error&lt;/em&gt;,
&lt;a href=&#34;https://www.itl.nist.gov/div898/handbook/mpc/section3/mpc3671.htm&#34; class=&#34;uri&#34;&gt;https://www.itl.nist.gov/div898/handbook/mpc/section3/mpc3671.htm&lt;/a&gt;,
09 de junio 2020.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Nonlinear multivariate calibration methods in analytical chemistry
Sonja Sekulic, Mary Beth Seasholtz, Ziyi Wang, Bruce R. Kowalski, Samuel E.
Lee, and Bradley R. Holt &lt;em&gt;Analytical Chemistry 1993 65 (19), 835A-845A&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Slides</title>
      <link>https://www.analytical.cl/slides/example/</link>
      <pubDate>Tue, 05 Feb 2019 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/slides/example/</guid>
      <description>&lt;h1 id=&#34;create-slides-in-markdown-with-wowchemy&#34;&gt;Create slides in Markdown with Wowchemy&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://wowchemy.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wowchemy&lt;/a&gt; | &lt;a href=&#34;https://owchemy.com/docs/managing-content/#create-slides&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Documentation&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;features&#34;&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Efficiently write slides in Markdown&lt;/li&gt;
&lt;li&gt;3-in-1: Create, Present, and Publish your slides&lt;/li&gt;
&lt;li&gt;Supports speaker notes&lt;/li&gt;
&lt;li&gt;Mobile friendly slides&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;controls&#34;&gt;Controls&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Next: &lt;code&gt;Right Arrow&lt;/code&gt; or &lt;code&gt;Space&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Previous: &lt;code&gt;Left Arrow&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Start: &lt;code&gt;Home&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Finish: &lt;code&gt;End&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Overview: &lt;code&gt;Esc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Speaker notes: &lt;code&gt;S&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Fullscreen: &lt;code&gt;F&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Zoom: &lt;code&gt;Alt + Click&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/hakimel/reveal.js#pdf-export&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PDF Export&lt;/a&gt;: &lt;code&gt;E&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;code-highlighting&#34;&gt;Code Highlighting&lt;/h2&gt;
&lt;p&gt;Inline code: &lt;code&gt;variable&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Code block:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;porridge = &amp;quot;blueberry&amp;quot;
if porridge == &amp;quot;blueberry&amp;quot;:
    print(&amp;quot;Eating...&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id=&#34;math&#34;&gt;Math&lt;/h2&gt;
&lt;p&gt;In-line math: $x + y = z$&lt;/p&gt;
&lt;p&gt;Block math:&lt;/p&gt;
&lt;p&gt;$$
f\left( x \right) = ;\frac{{2\left( {x + 4} \right)\left( {x - 4} \right)}}{{\left( {x + 4} \right)\left( {x + 1} \right)}}
$$&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;fragments&#34;&gt;Fragments&lt;/h2&gt;
&lt;p&gt;Make content appear incrementally&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{{% fragment %}} One {{% /fragment %}}
{{% fragment %}} **Two** {{% /fragment %}}
{{% fragment %}} Three {{% /fragment %}}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Press &lt;code&gt;Space&lt;/code&gt; to play!&lt;/p&gt;
&lt;span class=&#34;fragment &#34; &gt;
   One 
&lt;/span&gt;
&lt;span class=&#34;fragment &#34; &gt;
   **Two** 
&lt;/span&gt;
&lt;span class=&#34;fragment &#34; &gt;
   Three 
&lt;/span&gt;
&lt;hr&gt;
&lt;p&gt;A fragment can accept two optional parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;class&lt;/code&gt;: use a custom style (requires definition in custom CSS)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;weight&lt;/code&gt;: sets the order in which a fragment appears&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;speaker-notes&#34;&gt;Speaker Notes&lt;/h2&gt;
&lt;p&gt;Add speaker notes to your presentation&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-markdown&#34;&gt;{{% speaker_note %}}
- Only the speaker can read these notes
- Press `S` key to view
{{% /speaker_note %}}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Press the &lt;code&gt;S&lt;/code&gt; key to view the speaker notes!&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;ul&gt;
&lt;li&gt;Only the speaker can read these notes&lt;/li&gt;
&lt;li&gt;Press &lt;code&gt;S&lt;/code&gt; key to view&lt;/li&gt;
&lt;/ul&gt;

&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;themes&#34;&gt;Themes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;black: Black background, white text, blue links (default)&lt;/li&gt;
&lt;li&gt;white: White background, black text, blue links&lt;/li&gt;
&lt;li&gt;league: Gray background, white text, blue links&lt;/li&gt;
&lt;li&gt;beige: Beige background, dark text, brown links&lt;/li&gt;
&lt;li&gt;sky: Blue background, thin dark text, blue links&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;night: Black background, thick white text, orange links&lt;/li&gt;
&lt;li&gt;serif: Cappuccino background, gray text, brown links&lt;/li&gt;
&lt;li&gt;simple: White background, black text, blue links&lt;/li&gt;
&lt;li&gt;solarized: Cream-colored background, dark green text, blue links&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;/media/boards.jpg&#34;
  &gt;

&lt;h2 id=&#34;custom-slide&#34;&gt;Custom Slide&lt;/h2&gt;
&lt;p&gt;Customize the slide style and background&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-markdown&#34;&gt;{{&amp;lt; slide background-image=&amp;quot;/media/boards.jpg&amp;quot; &amp;gt;}}
{{&amp;lt; slide background-color=&amp;quot;#0000FF&amp;quot; &amp;gt;}}
{{&amp;lt; slide class=&amp;quot;my-style&amp;quot; &amp;gt;}}
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id=&#34;custom-css-example&#34;&gt;Custom CSS Example&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s make headers navy colored.&lt;/p&gt;
&lt;p&gt;Create &lt;code&gt;assets/css/reveal_custom.css&lt;/code&gt; with:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-css&#34;&gt;.reveal section h1,
.reveal section h2,
.reveal section h3 {
  color: navy;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h1 id=&#34;questions&#34;&gt;Questions?&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/wowchemy/wowchemy-hugo-modules/discussions&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ask&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://wowchemy.com/docs/managing-content/#create-slides&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Documentation&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>¿Cómo detectar el efecto matriz en un método analítico?</title>
      <link>https://www.analytical.cl/post/como-detectar-efecto-matriz-metodo-analitico/</link>
      <pubDate>Wed, 01 Nov 2017 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/como-detectar-efecto-matriz-metodo-analitico/</guid>
      <description>
&lt;script src=&#34;https://www.analytical.cl/post/como-detectar-efecto-matriz-metodo-analitico/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;He vuelto a postear, después de una gira que me llevó por los cinco…
mentira, fue por pura pega.&lt;/p&gt;
&lt;p&gt;El famoso efecto matriz, algo tan etéreo como el &lt;em&gt;criterio analítico&lt;/em&gt;.
El efecto matriz está íntimamente relacionado con las interferencias de la
matriz que de alguna forma aumentan o disminuyen la señal instrumental que,
en teoría, es producida sólo por el analito de interés.&lt;/p&gt;
&lt;p&gt;Para evaluar y detectar el efecto matriz, debemos desempolvar algunos papers
que nos enseñaron el famoso método de calibración con adición conocida o
adición de estándar. En este método, la matriz es nuestro
medio de calibración. En vez de preparar los calibrantes en solventes puros o
en solución ácida, utilizaremos la misma matriz para preparar (adicionar)
el analito. De esta forma, la señal analítica de estos calibrantes, está
compuesta de la señal propia del analito así como también de los
interferentes, lo que permite corregir/minimizar sus efectos.&lt;/p&gt;
&lt;p&gt;Existen varias formas de implementar el método de adición conocida. Una muy
buena referencia es el excelente y pedagógico paper de M. Bader:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Morris Bader “A systematic approach to standard addition methods in
instrumental analysis” &lt;em&gt;J. Chem. Educ., 1980, 57 (10), p 703&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;El método consiste en añadir cantidades conocidas del analito en solvente
puro o solución ácida a volúmenes iguales de matriz. Finalmente, medir la respuesta
instrumental en una serie de
adiciones crecientes tal como lo muestra la figura &lt;a href=&#34;#fig:mosaplot&#34;&gt;1&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:mosaplot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;mosaplot.png&#34; alt=&#34;Diseño experimental de la adición conocida. Cortesía de Lins4y via Wikimedia Commons&#34; width=&#34;1238&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Diseño experimental de la adición conocida. Cortesía de Lins4y via Wikimedia Commons
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Es necesario que las adiciones de analito generen, en
conjunto con la cantidad de analito presente en la muestra original,
una concentración
tal que aún se encuentre en el rango lineal de calibración. De esta forma
se otiene una curva tal como se observa en la figura &lt;a href=&#34;#fig:adicion&#34;&gt;2&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:adicion&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;c0adicion.png&#34; alt=&#34;Preparación curva método de adición conocida&#34; width=&#34;316&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Preparación curva método de adición conocida
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Las unidades del eje &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; pueden establecerse como &lt;em&gt;analito añadido&lt;/em&gt; o,
tal como lo propone Bader en su paper, como múltiplos de un volumen
o cantidad fija del analito. Por lo tanto, en &lt;span class=&#34;math inline&#34;&gt;\(x = 0\)&lt;/span&gt; se obtiene la
señal de la muestra problema a la cual no se le ha agregado el
analito, es decir, la señal original. En cada una de las adiciones
del estándar mediremos la señal instrumental de tal manera de
obtener, y así lo esperamos, una relación lineal entre analito
agregado &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; y señal &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; de la forma:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:calib&#34;&gt;\[\begin{equation}
  y = \beta_{0} + \beta_{1}x + \epsilon
    \tag{1}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde se asumen los mismos supuestos que discutimos en el caso de la
calibración lineal estándar(en solvente puro) y que puede recordar en este
&lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;La concentración de la muestra problema &lt;span class=&#34;math inline&#34;&gt;\(C_{0}\)&lt;/span&gt; se obtiene a partir de la
ecuación &lt;a href=&#34;#eq:c0&#34;&gt;(2)&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:c0&#34;&gt;\[\begin{equation}
  C_{0} = \frac{\beta_{0}}{\beta_{1}}
  \tag{2}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;La incertidumbre de la concentración de la muestra problema &lt;span class=&#34;math inline&#34;&gt;\(u(C_{0})\)&lt;/span&gt; se
calcula a partir de la ecuación:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:uc0&#34;&gt;\[\begin{equation}
  u(C_{0}) = \frac{\sigma_{y/x}}{\beta_{1}}
  \sqrt{\frac{1}{n} + \frac{\overline{y}^2}
  {\beta_{1}\sum_{i}^{n} (x_{i} - \overline{x})^2}}
    \tag{3}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\sigma_{y/x}\)&lt;/span&gt; es la desviación estándar del error aleatorio &lt;span class=&#34;math inline&#34;&gt;\(\epsilon\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; es el número de adiciones independientes del estándar&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\overline{y}\)&lt;/span&gt; es el promedio de las señales instrumentales de las adiciones&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\overline{x}\)&lt;/span&gt; es el promedio de las concentraciones&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Como puede apreciar, la expresión de la incertidumbre de calibración para el
método de adición conocida es muy
similar a la correspondiente calibración estandar que discutimos en un
&lt;a href=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/&#34;&gt;post anterior&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Si queremos minimizar esta incertidumbre podríamos aumentar el número de
adiciones &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; o aumentar el término &lt;span class=&#34;math inline&#34;&gt;\(\sum_{i}^{n} (x_{i} - \overline{x})^2\)&lt;/span&gt;.
Este último término es interesante, pues nos dice que la incertidumbre de calibración
de este método se minimiza utilizando un rango amplio de concentración de
adición. Ellison demuestra que, dado que la propiedad
de linealidad se mantiene, basta preparar dos puntos de calibración:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;La muestra original sin adición (&lt;span class=&#34;math inline&#34;&gt;\(x = 0\)&lt;/span&gt;)&lt;/li&gt;
&lt;li&gt;El extremo superior del rango lineal&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Por ejemplo, si por alguna razón se tuvieran que preparar &lt;span class=&#34;math inline&#34;&gt;\(n = 6\)&lt;/span&gt; adiciones, lo
que indica la ecuación &lt;a href=&#34;#eq:uc0&#34;&gt;(3)&lt;/a&gt;, es que sería mejor preparar tres puntos
sin adición (&lt;span class=&#34;math inline&#34;&gt;\(x = 0\)&lt;/span&gt;) y tres en el extremos superior del rango lineal, tal
como lo demuestra la figura &lt;a href=&#34;#fig:doe&#34;&gt;3&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:doe&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;doeadicion.png&#34; alt=&#34;Diseño de una curva de calibración con adición conocida para minimizar la incertidumbre&#34; width=&#34;299&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Diseño de una curva de calibración con adición conocida para minimizar la incertidumbre
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Para evaluar estadísticamente si existe un efecto matriz debemos
comparar la curva de calibración estándar (es decir, en solvente orgánico o en
solución ácida) con la curva de adición conocida. Si las pendientes de ambas
curvas son “iguales” podemos afirmar que no hay evidencia de efecto matriz tal
como se muestra en la figura &lt;a href=&#34;#fig:sinefecto&#34;&gt;4&lt;/a&gt;. De modo contrario, si las
pendientes de ambas curvas difieren, entonces, existe un efecto matriz
significativo, tal como lo indica la figura &lt;a href=&#34;#fig:conefecto&#34;&gt;5&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:sinefecto&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;sinefecto.png&#34; alt=&#34;Sin efecto matriz: calibración estándar v/s adición conocida&#34; width=&#34;490&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Sin efecto matriz: calibración estándar v/s adición conocida
&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:conefecto&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;conefecto.png&#34; alt=&#34;Con efecto matriz: calibración estándar v/s adición conocida&#34; width=&#34;489&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Con efecto matriz: calibración estándar v/s adición conocida
&lt;/p&gt;
&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Ahora, Ud. se preguntará ¿Cuál es la herramienta estadística para comparar dos
pendientes de curvas de calibración?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;¡Excelente pregunta Tu(x3)!&lt;/p&gt;
&lt;p&gt;Aunque hay varias aproximaciones para hacer esta comparación, en este post
utilizaremos el Análisis de Covarianza (ANCOVA) y lo implementaremos, como no, en lenguaje &lt;code&gt;R&lt;/code&gt;. La siguiente tabla muestra los datos de calibración de clorpirifos
en vino por GC-NPD, tanto en solvente puro como mediante el método de adición
conocida en la muestra de vino:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:tablamosa&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;tabla_mosa.png&#34; alt=&#34;Tabla datos de calibración clorpirifos&#34; width=&#34;229&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 6: Tabla datos de calibración clorpirifos
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Note que en la caso de la calibración estándar, las unidades de
concentración están expresadas como &lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt;g de clorpirifos por mL de solvente.
En cambio, en los datos de adición conocida están expresadas como &lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt;g de
clorpirifos añadidos en los mL de muestra original. Por lo tanto,
&lt;span class=&#34;math inline&#34;&gt;\(X = 0\, \mu\text{g}/\text{mL}_{\text{vino}}\)&lt;/span&gt; representa la muestra sin adición.
La figura &lt;a href=&#34;#fig:mosa&#34;&gt;7&lt;/a&gt; muestra las curvas de calibración correspondientes.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:mosa&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;mosa.png&#34; alt=&#34;Curvas de calibración&#34; width=&#34;517&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 7: Curvas de calibración
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Apliquemos, ahora, el análisis de covarianza para evaluar si existen
diferencias significativas entre las pendientes.&lt;/p&gt;
&lt;p&gt;Primero, ajustemos un modelo lineal para cada calibración:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Curva de calibración estándar
x &amp;lt;- c(0, 0.1, 0.2, 0.3, 0.5, 1.0)
y &amp;lt;- c(0, 80, 159, 245, 410, 795)
fit.std &amp;lt;- lm(y ~ x)

# Curva de adición conocida
x.add &amp;lt;- c(0, 0.1, 0.2, 0.3, 0.4, 0.5)
y.add &amp;lt;- c(75, 159, 240, 328, 410, 498)
fit.add &amp;lt;- lm(y.add ~ x.add)

# En R la expresión y ~ x significa &amp;#39;y es modelado por x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A continuación se muestran los análisis estadísticos para cada
curva:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(fit.std)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Call:
lm(formula = y ~ x)

Residuals:
     1      2      3      4      5      6 
-2.489 -2.206 -2.924  3.359  8.924 -4.664 

Coefficients:
            Estimate Std. Error t value Pr(&amp;gt;|t|)    
(Intercept)    2.489      3.420   0.728    0.507    
x            797.176      7.105 112.193 3.78e-08 ***
---
Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1

Residual standard error: 5.751 on 4 degrees of freedom
Multiple R-squared:  0.9997,    Adjusted R-squared:  0.9996 
F-statistic: 1.259e+04 on 1 and 4 DF,  p-value: 3.785e-08&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(fit.add)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Call:
lm(formula = y.add ~ x.add)

Residuals:
      1       2       3       4       5       6 
 1.1429  0.6857 -2.7714  0.7714 -1.6857  1.8571 

Coefficients:
            Estimate Std. Error t value Pr(&amp;gt;|t|)    
(Intercept)   73.857      1.463   50.49 9.21e-07 ***
x.add        844.571      4.832  174.79 6.43e-09 ***
---
Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1

Residual standard error: 2.021 on 4 degrees of freedom
Multiple R-squared:  0.9999,    Adjusted R-squared:  0.9998 
F-statistic: 3.055e+04 on 1 and 4 DF,  p-value: 6.426e-09&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La pendiente de la curva de calibración estándar es 797
y la pendiente del método de adición es 845.
¿Es esta diferencia significativa? Esta es la pregunta que responde el ANCOVA. Para implementar este test en &lt;code&gt;R&lt;/code&gt;debemos hacer una pequeña
modificación a nuestra base de datos:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Consolidaremos los datos de calibración en una sola tabla llamada &amp;#39;datos&amp;#39;
datos &amp;lt;- data.frame(X = c(x, x.add), 
                    Y = c(y, y.add), 
                    Calibracion = c(rep(&amp;#39;Estandar&amp;#39;, 6), rep(&amp;#39;Adicion&amp;#39;, 6)))&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
X
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Y
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Calibracion
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.0
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Estandar
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.1
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
80
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Estandar
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.2
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
159
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Estandar
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.3
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
245
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Estandar
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.5
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
410
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Estandar
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1.0
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
795
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Estandar
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.0
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
75
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Adicion
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.1
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
159
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Adicion
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.2
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
240
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Adicion
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.3
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
328
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Adicion
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.4
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
410
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Adicion
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.5
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
498
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Adicion
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Una vez consolidados los datos en una única tabla podemos aplicar el
análisis de covarianza en &lt;code&gt;R&lt;/code&gt; con los siguientes comandos de la librería
&lt;code&gt;car&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(car)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Loading required package: carData&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Ajustamos un modelo con interceptos distintos y una pendiente para cada
# calibración

fit &amp;lt;- lm(Y ~ X + Calibracion + X:Calibracion, data = datos)
Anova(fit, type = &amp;#39;II&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Anova Table (Type II tests)

Response: Y
              Sum Sq Df   F value    Pr(&amp;gt;F)    
X             540763  1 29108.930 1.558e-15 ***
Calibracion    20535  1  1105.398 7.309e-10 ***
X:Calibracion    310  1    16.699  0.003503 ** 
Residuals        149  8                        
---
Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;broom&amp;#39; was built under R version 4.0.4&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;De la tabla se observa que el &lt;em&gt;p-value&lt;/em&gt; de la comparación de las pendientes
es &lt;span class=&#34;math inline&#34;&gt;\(Pr(&amp;gt;F) = 0.0035\)&lt;/span&gt; el cual es menor
a 0.05 (&lt;code&gt;X:Calibracion&lt;/code&gt;), por lo tanto, la diferencia observada entre las pendientes es, desde el punto de vista estadístico, significativa.
Esto implica que existe un efecto matriz que no está corregido por la
calibración en solvente. En definitiva, para este tipo de muestra,
sería apropiado
utilizar el método de adición conocida para la determinación de clorpirifos
en vino.&lt;/p&gt;
&lt;p&gt;Ahora, esta conclusión debe ser complementada con el criterio químico y
metrológico. Recuerde que la desventaja del método de adición conocida
es que es necesario hacer la adición muestra a muestra. Lo que se concluye
del ANCOVA está basado en un criterio puramente estadístico.&lt;/p&gt;
&lt;p&gt;Bueno estimado lector, espero haya disfrutado este post.&lt;/p&gt;
&lt;p&gt;Espero sus comentarios. Nos vemos.&lt;/p&gt;
&lt;div id=&#34;bibliografía&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Bibliografía&lt;/h2&gt;
&lt;p&gt;Ellison SL, Thompson M. &lt;strong&gt;Standard additions: myth and reality&lt;/strong&gt;
(2008) &lt;em&gt;Analyst 133(8):992-7.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Prueba de linealidad de una curva de calibración en Excel... Sí ¡En Excel!</title>
      <link>https://www.analytical.cl/post/prueba-de-linealidad-de-una-curva-de-calibracion-en-excel/</link>
      <pubDate>Thu, 28 Sep 2017 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/prueba-de-linealidad-de-una-curva-de-calibracion-en-excel/</guid>
      <description>
&lt;script src=&#34;https://www.analytical.cl/post/prueba-de-linealidad-de-una-curva-de-calibracion-en-excel/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;En un &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;post anterior&lt;/a&gt; vimos cómo evaluar la hipótesis de linealidad
de una curva de calibración. Propusimos dos tests estadísticos formales:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;El test de Mandel (ISO 8466-1)&lt;/li&gt;
&lt;li&gt;El test de carencia de ajuste (&lt;em&gt;lack-of-fit&lt;/em&gt;) (ISO 11095)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;los cuáles nos permiten concluir (o no) que el modelo
lineal es &lt;em&gt;adecuado o razonable&lt;/em&gt; para nuestros datos de calibración.
Nada más, ni nada menos. No cometa el error de afirmar que su calibración es
lineal, porque no existe método en el mundo que permita llegar a esa
conclusión.&lt;/p&gt;
&lt;p&gt;Implementamos estos tests en lenguaje de programación &lt;code&gt;R&lt;/code&gt; que es, actualmente,
la &lt;em&gt;lingua franca&lt;/em&gt; de la estadística, big data, data science y toda esa
pirotecnia. Sin embargo, también es posible implementar fácilmente
estos tests en el viejo y querido, pero a veces vapuleado por la comunidad
Estadística, Excel. Obviamente,
no existe el comando &lt;code&gt;test.de.linealidad&lt;/code&gt;, por lo tanto, tendremos que
“hacerlo a mano”.&lt;/p&gt;
&lt;p&gt;En este post implementaremos el Test de Mandel, cuyos detalles puede
consultar &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;aquí&lt;/a&gt;. El test de carencia de ajuste lo veremos en otro post.&lt;/p&gt;
&lt;div id=&#34;test-de-mandel-en-excel&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Test de Mandel en Excel&lt;/h1&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;En primer lugar necesitaremos, obviamente, los datos de calibración.
Estos se muestran en Excel en la siguiente figura:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;datos.png&#34; /&gt;
La gráfica de esta calibración se presenta a continuación. Note la
evidente no linealidad a alta concentración.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;plot_cal.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Bien, como Ud.recordará del post sobre &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;linealidad&lt;/a&gt;, para aplicar el test de Mandel debemos
ajustar dos modelos: un modelo lineal y otro no lineal. Mencionamos que para
darle sentido
químico-analítico ajustamos un modelo “no lineal” cuadrático. Yo sé que la
tentación
es grande para aplicar el botón derecho y &lt;code&gt;Ajustar línea de tendencia&lt;/code&gt;, pero
mantengamos la calma. Lo haremos de otra forma.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Para ajustar un modelo cuadrático en Excel hay varias formas, pero en este
post utilizaremos las herramientas del menú &lt;code&gt;Análisis de datos&lt;/code&gt;:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;tools.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Como ajustaremos un modelo cuadrático, necesitamos incorporar la
variable &lt;span class=&#34;math inline&#34;&gt;\(X^2\)&lt;/span&gt;. Esto es muy sencillo, debemos ubicarnos
en la columna B (donde está la &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;), presionar botón derecho y seleccionar
&lt;code&gt;Insertar&lt;/code&gt;, lo cual generará una columna vacía entre &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; tal
como se muestra en la siguiente figura:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;insertar.png&#34; /&gt;
A esta nueva columna la llamaremos &lt;code&gt;X^2&lt;/code&gt;, y generaremos los valores
correspondientes en la celda &lt;code&gt;B2&lt;/code&gt;con la fórmula &lt;code&gt;=A2^2&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;formula.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Copiamos la fórmula hasta la celda &lt;code&gt;B12&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;copiada.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;5&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Ahora ajustaremos el modelo cuadrático. Seleccionemos el menú &lt;code&gt;Datos&lt;/code&gt; de
la cinta de herramientas, el cual mostrará a la derecha el menú
&lt;code&gt;Análisis de datos&lt;/code&gt;, hacemos clic y se abrirá el siguiente cuadro:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;cuadro.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Seleccionamos la opción &lt;code&gt;Regresión&lt;/code&gt;, con lo que se abrirá el siguiente
diálogo:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;regresion.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;Rango Y de entrada&lt;/code&gt; presionamos la flecha negra que apunta hacia arriba
y seleccionamos con el &lt;em&gt;mouse&lt;/em&gt; los datos de &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;, incluyendo la letra &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;,
luego presionamos la flecha que apunta hacia abajo:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;rangoy.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;Rango X de entrada&lt;/code&gt; presionamos la flecha negra que apunta hacia arriba
y seleccionamos con el &lt;em&gt;mouse&lt;/em&gt; &lt;strong&gt;las dos columnas: &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(X^2\)&lt;/span&gt;&lt;/strong&gt;,
incluyendo las etiquetas, luego presionamos la flecha que apunta hacia abajo:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;rangox.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Chequeamos los cuadritos &lt;code&gt;Rótulos&lt;/code&gt;y &lt;code&gt;Nivel de confianza&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;div&gt;
    Jamás chequee el cuadrito &lt;code&gt;Constante igual a cero&lt;/code&gt;, a menos que haya
demostrado previamente esta hipótesis
  &lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;Opciones de salida&lt;/code&gt; seleccionamos en &lt;code&gt;Rango de salida&lt;/code&gt; la celda
&lt;code&gt;E1&lt;/code&gt; (en realidad da igual, es para que tengamos la misma salida).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;cuadrolisto.png&#34; /&gt;
¡Listo! Por ahora no usaremos las otras opciones.&lt;/p&gt;
&lt;ol start=&#34;6&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Presiones &lt;code&gt;Aceptar&lt;/code&gt;y aparecerá el análisis estadístico a partir de la
celda &lt;code&gt;E1&lt;/code&gt;:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;analisis.png&#34; /&gt;&lt;/p&gt;
&lt;ol start=&#34;7&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;No nos detendremos a explicar toda la información estadística de
las tablas, iremos
directamente al grano: al test de linealidad de Mandel. Ubique en la tabla
inferior la fila de la variable &lt;code&gt;X^2&lt;/code&gt; y la columna respectiva denominada
&lt;code&gt;Probabilidad&lt;/code&gt;. En este ejemplo marqué con rojo la celda del test de Mandel:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;mandel.png&#34; /&gt;
8. Esta celda representa el &lt;em&gt;p-value&lt;/em&gt; del test de Mandel. En este ejemplo
el &lt;em&gt;p-value&lt;/em&gt; = &lt;span class=&#34;math inline&#34;&gt;\(3,6\times 10^{-11}\)&lt;/span&gt;, es decir,
bajo la interpretación tradicional
de las pruebas de hipótesis, ya que &lt;em&gt;p-value&lt;/em&gt; &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt; 0,05\)&lt;/span&gt;
concluiríamos que el modelo lineal no es adecuado o razonable para modelar
los datos de calibración.&lt;/p&gt;
&lt;p&gt;Bueno, queridos lectores espero les haya gustado. Como siempre,
pueden dejar sus comentarios/críticas y sugerencias aquí abajo.
Hasta la próxima.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Validación de los cálculos de incertidumbre en química analítica con el método Monte Carlo. Parte II</title>
      <link>https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/</link>
      <pubDate>Sat, 23 Sep 2017 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/</guid>
      <description>
&lt;script src=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/index_files/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/index_files/lightable/lightable.css&#34; rel=&#34;stylesheet&#34; /&gt;


&lt;p&gt;En el
&lt;a href=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/&#34;&gt;post anterior&lt;/a&gt;
describimos brevemente en qué consiste el método de
Monte Carlo y cómo utilizarlo para estimar la incertidumbre de medición.
Finalizamos comparando la estimación de acuerdo a la guía GUM con el método de
Monte Carlo siguiendo estrictamente las directrices del test de diferencias
numéricas propuesto por el Suplmento 1 de la GUM.&lt;/p&gt;
&lt;p&gt;Llevamos a cabo el test de validación “a mano”, es decir, ingresamos
todas las instrucciones en código &lt;code&gt;R&lt;/code&gt;. Si bien no fue difícil, existen librerías
especializadas en &lt;code&gt;R&lt;/code&gt; que permiten realizar todos los cálculos de
incertidumbre y validarlos utilizando funciones ya incorporadas.&lt;/p&gt;
&lt;p&gt;En &lt;code&gt;R&lt;/code&gt;existen dos librerías especializadas en cálculo de incertidumbre de
métodos de medición físico-químicos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;metRology&lt;/code&gt; desarrollada en conjunto entre los Institutos Nacionales de
Metrología del Reino Unido (LGC) y de Estados Unidos (NIST). Es mantenida
por Steve Ellison, el autor de la guía GUM. Puede encontrar más información
&lt;a href=&#34;https://www.nist.gov/programs-projects/metrology-software-project&#34;&gt;aquí&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;propagate&lt;/code&gt; desarrollada por Andrej-Nikolai Spiess&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Me inclinaré por &lt;code&gt;metRology&lt;/code&gt; principalmente porque tiene el soporte de los
dos centros de metrología más imporantes a nivel mundial y, ya que fue
desarrollada en sus inicios por Steve Ellison, tiene un pequeño sesgo hacia la
metrología química.&lt;/p&gt;
&lt;div id=&#34;ejemplo-de-validación-de-cálculos-con-librería-metrology&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Ejemplo de validación de cálculos con librería &lt;code&gt;metRology&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Desarrollaremos un ejemplo más extenso sobre cálculo de incertidumbre en
química analítica utilizando esta librería. Iremos paso a paso, cualquier
duda en la implementación nada más escríbala en los comentarios más
abajo. Sin embargo, no detallaremos cómo obtener las incertidumbres de
cada uno de los factores involucrados en la ecuación de medición, sino
que simplemente será un dato conocido para este ejemplo. En
un futuro post, desarollaremos un ejemplo completo de principio a fin, por ahora
nos centraremos en utilizar &lt;code&gt;metRology&lt;/code&gt;como herramienta práctica.&lt;/p&gt;
&lt;p&gt;En este ejemplo, calcularemos la incertidumbre de un método de determinación
de cobre en mineral de cobre, con digestión ácida y cuantificación mediante
espetroscopía de abosrción atómica AAS. Los detalles del método analítico
están fuera del alcance de este post, pero pueden ser consultados en la
norma chilena NCh 3392:2016.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Seguiremos estrictamente las directrices de la GUM, por lo tanto, queda
fuera de esta evaluación cualquier corrección de sesgo y/o recuperación. La
discusión sobre si se debiera, o no, incorporar el sesgo en la incertidumbre
es un tema que abordaremos en otro post.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;El primer paso para estimar la incertidumbre de este método es escribir la
ecuación de medición:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:medicion&#34;&gt;\[\begin{equation}
  \text{Cu}[\text{%}]=\frac{\text{C}_{\text{calib}}\cdot V \cdot D}{m\cdot 10000}
  \tag{1}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(\text{C}_{\text{calib}}\)&lt;/span&gt; es la concentración de la muestra digerida
interpolada en la curva de calibración &lt;span class=&#34;math inline&#34;&gt;\([\mu\text{g}\,\text{mL}^{-1}]\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; es
la masa de la muestra [g], &lt;span class=&#34;math inline&#34;&gt;\(V\,[\text{mL}]\)&lt;/span&gt; es el volumen del aforo final y &lt;span class=&#34;math inline&#34;&gt;\(D\)&lt;/span&gt;
es un factor de dilución volumétrico, utilizado cuando es necesario. Para
simplificar el problema, asumiremos que no hay dilución antes de la lectura
por AAS, por lo tanto, &lt;span class=&#34;math inline&#34;&gt;\(D = 1\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(u_{D} = 0\)&lt;/span&gt;.&lt;/p&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Identificación de las fuentes de incertidumbre&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A continuación se enumeran las fuentes de incertidumbre asociadas a cada uno de
los factores de la ecuación &lt;a href=&#34;#eq:medicion&#34;&gt;(1)&lt;/a&gt; y se describe brevemente los
métodos estadísticos y de juicio experto utilizados para obtener las
incertidumbres
estándar correpospondientes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\text{C}_{\text{calib}}\)&lt;/span&gt;: La incertidumbre estándar de la concentración de
una muestra problema &lt;span class=&#34;math inline&#34;&gt;\(u_{\text{C}_\text{calib}}\)&lt;/span&gt; obtenida de una curva de
calibración
lineal &lt;span class=&#34;math inline&#34;&gt;\(y = a + bx\)&lt;/span&gt; es calculada a partir de la siguiente expresión:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{equation}
u_{\text{C}_{\text{calib}}}=\frac{s_{y/x}}{b}\sqrt{\frac{1}{m}+\frac{1}{n}+
\frac{(C_{\text{calib}}-\overline{C})^2}{\sum(C_{i}-\overline{C})^2}}
\label{eq:ucurva}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(s_{y/x}\)&lt;/span&gt; es la desviación estándar de la regresión, &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; es el número de
replicados independientes de la muestra problema efectivamente analizados, &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;
es el número de calibrantes, &lt;span class=&#34;math inline&#34;&gt;\(C_{\text{calib}}\)&lt;/span&gt; es la concentración de la
muestra problema obtenida por interpolación en la curva de calibración,
&lt;span class=&#34;math inline&#34;&gt;\(\overline{C}\)&lt;/span&gt;
es el promedio de la concentraciones de los calibrantes. Estos parámetros pueden
ser obtenidos directamente del análisis estadístico de la curva de calibración
lineal. Cabe destacar que cuando se utiliza el método de mínimos cuadrados
ordinarios para estimar la pendiente e intercepto de la curva, esta metodología
no incorpora la incertirtumbre de la concentración de los calibrantes.&lt;/p&gt;
&lt;p&gt;&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;div&gt;
    Puede profundizar sobre la incertidumbre de calibración en el siguiente
&lt;a href=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/&#34;&gt;post&lt;/a&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt;: La incertidumbre del volumen de aforo &lt;span class=&#34;math inline&#34;&gt;\(u_{\text{V}}\)&lt;/span&gt; es estimada a partir
de la combinación de tres fuentes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(u_{\text{tol}}\)&lt;/span&gt; La incertidumbre informada por el fabricante en el
certificado original del lote de producción o aquella impresa en el material
de vidrio. Esta incertidumbre es de Tipo B.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(u_{\text{rep}}\)&lt;/span&gt; Incertidumbre debido a la repetibilidad de llenado del
aforo del material de vidrio. Esta incertidumbre (Tipo A) es evaluada
mediante métodos estadísticos a través de la replicación (&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;) del llenado
del material con agua destilada y el registro gravimétrico de la cantidad
de agua. La incertidumbre estándar se expresa como la desviación estándar
de los &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;
replicados.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(u_{\text{temp}}\)&lt;/span&gt; La incertidumbre debido a la diferencia de temperatura
registrada durante la calibración del material de vidrio y aquella que se
registra durante los análisis de rutina. Esta incertidumbre expandida es
expresada en la
ecuación &lt;a href=&#34;#eq:uvol&#34;&gt;(2)&lt;/a&gt;:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:uvol&#34;&gt;\[\begin{equation}
  U_{\text{temp}}= V\cdot \gamma_{\text{H}_{2}\text{O}} \cdot \Delta T
  \tag{2}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt; es el volumen certificado del material de vidrio,
&lt;span class=&#34;math inline&#34;&gt;\(\gamma_{\text{H}_{2}\text{O}} = 2.1\cdot 10^{-4}\,\text{°C}^{-1}\)&lt;/span&gt; es el
coeficiente de expansión del agua y &lt;span class=&#34;math inline&#34;&gt;\(\Delta T\)&lt;/span&gt; es la variabilidad de la
temperatura de trabajo del laboratorio en relación a la tempreratura de
calibración del material. Finalmente, se obtiene asume una distribución
rectangular de la variable  obteniéndose una incertidumbre
estándar &lt;span class=&#34;math inline&#34;&gt;\(u_{\text{temp}}=U_{\text{temp}}/\sqrt{3}\)&lt;/span&gt; mL.&lt;/p&gt;
&lt;p&gt;Esta expresión debe utilizarse cuando exista un certificado de calibración que
informe la temperatura de referencia registrada durante el proceso de
certificación el cual puede provenir del mismo fabricante o de alguna institución
metrológica nacional que certifique este tipo material. Generalmente la
temperatura de calibración se espcifica a 20°C.&lt;/p&gt;
&lt;p&gt;La incertidumbre combinada estándar del volumen del aforo se obtiene a través
de la siguiente expresión:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{equation}
u_{\text{V}} = \sqrt{u_{\text{tol}}^2+u_{\text{rep}}^2+u_{\text{temp}}^2} 
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; : La incertidudmbre de la masa de la muestra es obtenida directamente del
certificado de la balanza emitido por el nodo de metrología física nacional u
otro proveedor de calibración.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Cuantificación de los componentes de incertidumbre&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Como mencionamos anteriormente, no llevaremos a cabo la estimación de
incertidumbre de cada uno de lo componentes, sino que asumiremos que estos
datos ya están disponibles. Dedicaremos otro post a desarrollar un ejemplo
completo de principio a fin.&lt;/p&gt;
&lt;ol start=&#34;4&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Cálculo de la incertidumbre combinada total&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Aplicando las directrices de la GUM y en base a la ecuación de medición
&lt;a href=&#34;#eq:medicion&#34;&gt;(1)&lt;/a&gt;, la incertidumbre estándar de la concentración de Cu por
este método analítico es obtenida a partir de:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:ufinal&#34;&gt;\[\begin{equation}
u_{\text{Cu}} = \text{Cu}\sqrt{\left(\frac{u_{\text{C}_\text{calib}}}{\text{C}_{\text{calib}}}\right)^2+
\left(\frac{u_{\text{m}}}{m}\right)^2+
\left(\frac{u_{\text{V}}}{V}\right)^2}
\tag{3}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:udata&#34;&gt;1&lt;/a&gt; muestra las incertidumbres estándares de cada
uno de los componentes de la ecuación &lt;a href=&#34;#eq:ufinal&#34;&gt;(3)&lt;/a&gt;:&lt;/p&gt;
&lt;table class=&#34;table table-striped&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:udata&#34;&gt;Table 1: &lt;/span&gt;Valores e incertidumbres estándar de cada componente
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Componente
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Valor
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
u
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Unidades
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Concentracion calibracion
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
13.82
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.24
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ug/mL
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Volumen aforo
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
250.00
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.14
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
mL
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Masa muestra
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.99160
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.00005
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
g
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Ok, vamos entonces a utilizar la librería &lt;code&gt;metRology&lt;/code&gt; para evaluar la
incertidumbre del % de Cu.&lt;/p&gt;
&lt;p&gt;&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;div&gt;
    Debe, en primer lugar, instalar la librería mediante el
comando &lt;code&gt;install.packages(&amp;lsquo;metRology&amp;rsquo;)&lt;/code&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;Una vez instalada debe ingresar el siguiente código &lt;code&gt;R&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(metRology)  # Carga la librería metRology

# Ingresar los valores de cada variable input (Tabla 1)

Cu.calib &amp;lt;- 13.82 # Concentración interpolada en la curva de calibración [ug/mL]
V &amp;lt;- 250          # Volumen de aforo [mL]
m &amp;lt;- 0.9916       # Masa de la muestra [g]
D &amp;lt;- 1            # Factor de dilución (D = 1 implica no hay dilución)

# Ingresar las incertidumbres estándar de cada variable input (Tabla 1)
# Se mantienen, obviamente, las mismas unidades

u.Cu.calib &amp;lt;- 0.24
u.V &amp;lt;- 0.14
u.m &amp;lt;- 0.00005
u.D &amp;lt;- 0

# Ingresamos la ecuación de medición y la guardamos con el nombre C.Cu
# mediante el comando &amp;#39;expression&amp;#39;

C.Cu &amp;lt;- expression(Cu.calib*V*D/(m*10000))

# Guardemos en una lista los valores de cada variable input, la llamaremos
# x.Cu

x.Cu &amp;lt;- list(Cu.calib = Cu.calib, V = V , D = D, m = m)

# Guardemos en un vector las incertidumbres estándares de cada variable input
# ¡¡en el mismo orden que fueron ingresadas en x.Cu!!
# Llamaremos a este vector u.x.Cu

u.x.Cu &amp;lt;- c(u.Cu.calib, u.V, u.D, u.m)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;¡Estamos listos! Ahora &lt;code&gt;metRology&lt;/code&gt;hará todo el trabajo con el comando &lt;code&gt;uncert&lt;/code&gt;, Ud. debe elegir cuál método de estimación desea utilizar, las opciones son:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GUM&lt;/li&gt;
&lt;li&gt;Monte Carlo&lt;/li&gt;
&lt;li&gt;Kragten: Método numérico basado en una aproximación de las derivadas
parciales propuestas por GUM. Es una excelente alternativa y muy sencilla de
implementar en Excel también.&lt;/li&gt;
&lt;li&gt;NUM y k2 son otras aproximaciones numéricas de derivadas parciales.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Cálculo de incertidumbre de acuerdo a GUM:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Ingresamos ¡en este orden! los siguientes parámetros del comando uncert
# Ecuación de medición C.Cu
# Lista de valores inputs x.Cu
# Vector de incertidumbres estándar u.x.Cu
# ¿Con cuál método quiere calcular la incertidumbre? En este caso GUM

u.Cu.GUM &amp;lt;- uncert(C.Cu, x.Cu, u.x.Cu, method = &amp;#39;GUM&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La información que entrega &lt;code&gt;uncert&lt;/code&gt;es muy completa, sin embargo, para nuestro
propósito sólo debemos fijarnos en el resultado que aparece al final del
análisis, es decir: &lt;span class=&#34;math inline&#34;&gt;\(y = 0.3484268\)&lt;/span&gt; % Cu y &lt;span class=&#34;math inline&#34;&gt;\(u(y) = 0.006054\)&lt;/span&gt; % Cu.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
Uncertainty evaluation

Call:
  uncert.expression(obj = C.Cu, x = x.Cu, u = u.x.Cu, method = &amp;quot;GUM&amp;quot;)

Expression: Cu.calib * V * D/(m * 10000)

Evaluation method:  GUM 

Uncertainty budget:
         x        u       c            u.c          
Cu.calib  13.8200 0.24000  0.025211779  6.050827e-03
V        250.0000 0.14000  0.001393707  1.951190e-04
D          1.0000 0.00000  0.348426785  0.000000e+00
m          0.9916 0.00005 -0.351378363 -1.756892e-05

   y:  0.3484268
u(y):  0.006053998 &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Además de los cálculos de incertidumbre, la opción &lt;code&gt;method = &#39;GUM&#39;&lt;/code&gt; entrega
4 gráficos muy interesantes, siendo el más importante el de
&lt;em&gt;Contribuciones combinadas&lt;/em&gt;, el cual se muestra en la figura &lt;a href=&#34;#fig:plotGUM&#34;&gt;1&lt;/a&gt;.
En este gráfico queda en evidencia que el factor que más aporta a la
incertidumbre total (evaluada por GUM) es la curva de calibración.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:plotGUM&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/index_files/figure-html/plotGUM-1.png&#34; alt=&#34;Gráfico de contribución a la incertidumbre total&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Gráfico de contribución a la incertidumbre total
&lt;/p&gt;
&lt;/div&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Cálculo de incertidumbre de acuerdo a Monte Carlo:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Esencialmente es el mismo comando que utilizamos para GUM, sólo que
seleccionaremos &lt;code&gt;method = &#39;MC&#39;&lt;/code&gt;. Sin embargo, este método tiene varias
opciones adicionales muy interesantes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Con la opción &lt;code&gt;distrib&lt;/code&gt; Ud. puede asignar a cada variable su respectiva
distribución de probabilidad: Normal, uniforme, triangular o Student. Por
defecto, asume que todas son normales.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Con la opción &lt;code&gt;B&lt;/code&gt; indica el número de simulaciones. Por defecto &lt;code&gt;B = 200&lt;/code&gt;. Le sugiero cambiar a &lt;code&gt;B = 10000&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Guardaremos los cálculos en el objeto u.Cu.MC

set.seed(123) # Sólo para que Ud. obtenga los mismos resultados

u.Cu.MC &amp;lt;- uncert(C.Cu, x.Cu, u.x.Cu, method = &amp;#39;MC&amp;#39;, B = 10000)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El método de Monte Carlo entrega el siguiente análisis:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
Uncertainty evaluation

Call:
  uncert.expression(obj = C.Cu, x = x.Cu, u = u.x.Cu, method = &amp;quot;MC&amp;quot;,     B = 10000)

Expression: Cu.calib * V * D/(m * 10000)

Evaluation method:  MC 

Budget:
         x        u       c            u.c           distrib
Cu.calib  13.8200 0.24000  0.025211842  6.050842e-03 norm   
V        250.0000 0.14000  0.001393355  1.950696e-04 norm   
D          1.0000 0.00000           NA            NA norm   
m          0.9916 0.00005 -0.351680471 -1.758402e-05 norm   
         distrib.pars         
Cu.calib mean=13.82, sd=0.24  
V        mean=250, sd=0.14    
D        mean=1, sd=0         
m        mean=0.9916, sd=5e-05

   y:  0.3484268
u(y):  0.006046603 

Monte Carlo evaluation using 10000 replicates:

   y:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3252  0.3444  0.3484  0.3484  0.3525  0.3720 &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El MMC obtiene
&lt;span class=&#34;math inline&#34;&gt;\(y = 0.3484268\)&lt;/span&gt; % Cu y &lt;span class=&#34;math inline&#34;&gt;\(u(y) = 0.0060466\)&lt;/span&gt; % Cu.&lt;/p&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:comparacion&#34;&gt;2&lt;/a&gt; muestra la comparación de ambas
aproximaciones en la estimación de la incertidumbre estándar:&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:comparacion&#34;&gt;Table 2: &lt;/span&gt;Cuadro comparativo GUM v/s Monte Carlo % Cu
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Método
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Valor calculado
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
u
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
GUM
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.3484268
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.0060540
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Monte Carlo
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.3484268
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
0.0060466
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note la excelente concordancia entre ambas metodologías &lt;strong&gt;para esta
ecuación de medición asumiendo una distribución normal para
todas las variables inputs&lt;/strong&gt;. En este caso, &lt;em&gt;muy particular&lt;/em&gt;, casi sería
innecesario validar el método GUM, pero lo haremos de todas maneras
para ejemplificar la operación.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;validación-de-los-cálculos-gum-con-el-método-de-monte-carlo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Validación de los cálculos GUM con el método de Monte Carlo&lt;/h2&gt;
&lt;p&gt;En el
&lt;a href=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/&#34;&gt;post anterior&lt;/a&gt;
hicimos el test de validación numérica “a mano”, en
esta oportunidad utilizaremos el comando &lt;code&gt;GUM.validate&lt;/code&gt;. Lamentablemente
este comando tiene una forma distinta de ingresar los parámetros, nada
del otro mundo, pero es distinta a &lt;code&gt;uncert&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Si bien GUM.validate tiene muchas opciones, utilizaremos aquellas
# que están por defecto en la librería

# Guarde en un vector el nombre de las variables, cada una entre &amp;#39; &amp;#39;
variables &amp;lt;- c(&amp;#39;Cu.calib&amp;#39;, &amp;#39;V&amp;#39;, &amp;#39;D&amp;#39;, &amp;#39;m&amp;#39;)

# Guarde en un vector x.i los valores de la variables input en el 
# mismo orden que ingresó &amp;#39;variables&amp;#39; arriba
x.i &amp;lt;- c(13.82, 250, 1, 0.9916)

# Guarde en un vector u.i las incertidumbres estándar de las variables
# input, en el mismo orden que ingresó &amp;#39;variables&amp;#39; arriba
u.i &amp;lt;- c(0.24, 0.14, 0, 0.00005)

# Guarde los grados de libertad de cada variable input como nu.i. 
# En este ejemplo  asumiremos que todas tienen infinitos grados de 
# libertad (nu = 9999)

nu.i &amp;lt;- c(9999, 9999, 9999, 9999)

# Seleccione que tipo de método utilizó para evaluar cada una de las
# incertidumbres: Tipo A o tipo B. En este caso sólo la incertidumbre
# de calibración u.Cu.calib es de tipo A.

type &amp;lt;- c(&amp;#39;A&amp;#39;, &amp;#39;B&amp;#39;, &amp;#39;B&amp;#39;, &amp;#39;B&amp;#39;)

# Seleccione que distribuciones de probabilidad asignó a las variables
# input. En este ejemplo, asumiremos que todas son normales

distribution &amp;lt;- rep(&amp;#39;Normal&amp;#39;, 4) # Repetir Normal 4 veces (soy muy flojo)

# Guarde la ecuación de medición entre &amp;#39;&amp;#39;
ec_de_medicion &amp;lt;- &amp;#39;Cu.calib*V*D/(m*10000)&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Listo, ahora validemos los cálculos GUM con el comando
&lt;code&gt;GUM.validate&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(126) # Tu ya sabes
GUM.validate(var.name = variables, 
             x.i = x.i,
             u.i = u.i,
             nu.i = nu.i,
             type = type,
             distribution = distribution,
             measurement.fnc = ec_de_medicion)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;[1] 0.958&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;“Bueno ¿Y?” se preguntará Ud.&lt;/p&gt;
&lt;p&gt;Bien, para validar el método GUM frente a Monte Carlo, fíjese en el valor
que entrega &lt;code&gt;GUM.validate = 0.958&lt;/code&gt; y compárelo con 0.95. Si el valor de
&lt;code&gt;GUM.validate&lt;/code&gt; &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt; 0.95\)&lt;/span&gt; entonces el método GUM queda validado.&lt;/p&gt;
&lt;p&gt;En el fondo, &lt;code&gt;GUM.validate&lt;/code&gt; evalúa si el intervalo de incertidumbre calculado
por GUM alcanza o no la cobertura esperada del 95% (teórica).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;resumiendo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Resumiendo&lt;/h2&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;El método de Monte Carlo funciona en casos donde las suposiciones del
método GUM no se cumplen, especialmente en ecuaciones de medición no
lineales.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Mientras más divergencia de la linealidad tenga el modelo de medición,
más discrepancias habrá entre ambos métodos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Es posible que cuando incorpore distribuciones rectangulares (uniformes),
el histograma de los valores de Monte Carlo esté dominado por este
tipo de distribuciones. Verá un achatamiento del histograma.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ya hablamos que la pureza química (al menos para compuestos muy puros
&lt;span class=&#34;math inline&#34;&gt;\(&amp;gt; 95\%\)&lt;/span&gt;) no es correcto modelarla mediante una distribución Normal
(¿&lt;span class=&#34;math inline&#34;&gt;\(99.7 \pm 0.5\)&lt;/span&gt; %?), sino
con una Beta. Lamentablmente, la librería &lt;code&gt;metRology&lt;/code&gt;no posee esta distribución
en sus opciones y tendrá que hacer la simulación “a mano”.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;En general para distribuciones de Monte Carlos muy asimétricas (como la
pureza química modelada con Beta), la diferencia entre MC y GUM se verá
reflejada en la incertidumbre expandida y no en la estándar.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Quedan muchas cosas por analizar del método de Monte Carlo, sin embargo, el
espíritu de este post es divulgar a la comunidad químico-analítica
esta poderosa herramienta más que entrar en los detalles teóricos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Usamos el lenguaje &lt;code&gt;R&lt;/code&gt;porque es actualmente el &lt;em&gt;idioma oficial&lt;/em&gt; de la
estadística. Sin embargo, Ud. puede implementar estos cálculos en cualquier
lenguaje e incluso en Excel. Además, existen muchos otros softwares que,
aunque no tan flexibles y potentes como &lt;code&gt;R&lt;/code&gt;, harán el trabajo.
Revise la siguiente lista en &lt;a href=&#34;https://en.wikipedia.org/wiki/List_of_uncertainty_propagation_software&#34;&gt;Wikipedia&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Espero que este post haya sido de su agrado, todos los comentarios
son bienvenidos. Hasta la próxima.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografía&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Bibliografía&lt;/h2&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Evaluation of measurement data – Guide to the expression of uncertainty in
measurement JCGM 100:2008&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Evaluation of measurement data – Supplement 1 to the “Guide to the expression
of uncertainty in measurement” – Propagation of distributions using a Monte Carlo
method JCGM 101:2008&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Stephen L R Ellison &lt;em&gt;metRology: Support for Metrological Applications&lt;/em&gt;
R package version 0.9-23-2, 2016.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Validación de los cálculos de incertidumbre en química analítica con el método Monte Carlo. Parte I</title>
      <link>https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/</link>
      <pubDate>Tue, 12 Sep 2017 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/</guid>
      <description>
&lt;script src=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;De acuerdo al numeral 8.1 del Suplemento 1 de la guía GUM,
el método de Monte Carlo es un método general para estimar la incertidumbre de
medición y puede, bajo ciertas directrices, validar los cálculos realizados
con el método GUM. En este post asumiremos que Ud.,
esimado lector, está familiarizado con el método GUM y ya lo tiene implementado
, por ejemplo, en una hoja Excel y le gustaría validar
sus cálculos mediante un
método totalmente independiente y más general. De esta forma podrá cumplir
cabalmente con el siguiente numeral de la norma 17025:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;5.4.7.1 Los cálculos y la transferencia de los datos deben estar sujetos a
verificaciones adecuadas llevadas a cabo de una manera sistemática.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;¿Cómo sabe Ud. que su implementación en Excel está correcta?&lt;/p&gt;
&lt;div id=&#34;qué-es-el-método-de-monte-carlo&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;¿Qué es el método de Monte Carlo?&lt;/h1&gt;
&lt;p&gt;(Aquí podría hacer copy-paste de Wikipedia…no olvidar borrar esta nota interna)&lt;/p&gt;
&lt;p&gt;Muy sucintamente, el método de Monte Carlo es un método numérico que permite
evaluar expresiones matemáticas complejas (muy complejas, créame) mediante la
simulación de números aleatorios.
Este post no pretende profundizar en la teoría de este método (ZzzZzz…) , sino
más bien dar ejemplos concretos aplicados en química analítica, por lo tanto,
es posible que un avezado estadístico computacional le dé un infarto al leer la
soltura con la cual me expreso y lo ineficiente del código &lt;code&gt;R&lt;/code&gt;. El objetivo
es simplemente la divulgación a la comunidad químico-analítica para
abordar algunos puntos normativos de la 17025 y guía GUM.&lt;/p&gt;
&lt;p&gt;Veamos un ejemplo sencillo. Supongamos que necesitamos calcular la
incertidumbre de la
suma de 2 variables aleatorias
normales &lt;strong&gt;independientes&lt;/strong&gt;, y que poseen&lt;br /&gt;
la misma media (&lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt;) y varianza (&lt;span class=&#34;math inline&#34;&gt;\(\sigma^2\)&lt;/span&gt;), es decir,
si &lt;span class=&#34;math inline&#34;&gt;\(Z = X + Y\)&lt;/span&gt; ¿Cuál es la incertiumbre de &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt;? (&lt;span class=&#34;math inline&#34;&gt;\(u_{Z}\)&lt;/span&gt;)&lt;/p&gt;
&lt;p&gt;Si Ud. recuerda de sus cursos de probabilidades, este problema tiene una solución
directa y sencilla:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  V(Z) &amp;amp;=&amp;amp; V(X) + V(Y) \\
  V(Z) &amp;amp;=&amp;amp; \sigma^2 + \sigma^2 \\
  V(Z) &amp;amp;=&amp;amp; 2\sigma^2
\end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(V()\)&lt;/span&gt; denota varianza. Por lo tanto, la incertidumbre de Z es
&lt;span class=&#34;math inline&#34;&gt;\(u_{Z} = \sqrt{V(Z)} = \sqrt{2}\sigma\)&lt;/span&gt;. Si Ud, conoce &lt;span class=&#34;math inline&#34;&gt;\(\sigma\)&lt;/span&gt;, es decir,
la incertidumbre estándar de &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;, el problema está resuelto.
En realidad, este ejemplo es bastente general y las distribuciones ni siquiera
tienen que ser las mismas, bajo ciertas condiciones, esto se cumplirá.&lt;/p&gt;
&lt;p&gt;Pero supongamos que, repentinamente, Ud. olvidó todo lo aprendido en esas
estimulantes clases de probabilidades con 33°C y
sin aire acondicionado. No se
preocupe, obtendremos la incertidumbre de Z sin recurrir a ninguna propiedad
teórica de las varianzas. Usareemos el método de Monte Carlo,
para lo cual debemos
hacer lo siguiente:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Asigne a cada variable, en este caso &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;, una distribución de
probabilidad de acuerdo a la información que disponga hasta ese momento.
En nuestro ejemplo tanto &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; como &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; son normales con
la misma media (&lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt;) y desviación estándar (&lt;span class=&#34;math inline&#34;&gt;\(\sigma\)&lt;/span&gt;). Sin pérdida de
generalidad, diremos que ambas variables &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; son normales con media
&lt;span class=&#34;math inline&#34;&gt;\(\mu = 100\)&lt;/span&gt; y desviación estándar &lt;span class=&#34;math inline&#34;&gt;\(\sigma = 5\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;De cada variable genere un valor aleatorio. Es decir, en nuestro ejemplo
debemos generar un número aleatorio para &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; y otro para &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; a partir de sus
respectivas distribuciones de probabilidad asignadas, que en este caso es la
misma. Haremos esto en lenguaje &lt;code&gt;R&lt;/code&gt;:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Generamos n = 1 número aletorio para X a partir de una
# distribución Normal con media 100 y desviación estándar 5
X &amp;lt;- rnorm(1, 100, 5) 

# Generamos n = 1 número aletorio para Y a partir de una
# distribución Normal con media 100 y desviación estándar 5
Y &amp;lt;- rnorm(1, 100, 5) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En esta primera simulación obtuvimos &lt;span class=&#34;math inline&#34;&gt;\(X = 97.1976218\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y = 98.8491126\)&lt;/span&gt;.&lt;/p&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Calcule la variable de interés con los datos simulados. En el ejemplo,
&lt;span class=&#34;math inline&#34;&gt;\(Z = X + Y = 97.1976218 + 98.8491126= 196.0467343\)&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Repita los pasos 2 y 3 &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; veces y obtenga la distribución empírica de &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A partir de los &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; datos simulados de &lt;span class=&#34;math inline&#34;&gt;\(Z\)&lt;/span&gt;, estime &lt;span class=&#34;math inline&#34;&gt;\(u_{Z} = s_{Z}\)&lt;/span&gt;, es decir,
la desviación estándar muestral de los &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; datos.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Hay varias formas de implementar todos estos pasos
en &lt;code&gt;R&lt;/code&gt;, la más intuitiva (creo yo) es la siguiente:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;n &amp;lt;- 1000 # Obtendremos n = 1000 datos aleatorios para X e Y
mu &amp;lt;- 100 # Media mu = 100
s &amp;lt;- 5    # Desviación estandar s = 5

X &amp;lt;- rnorm(n, mu, s) # 1000 datos aleatorios de una normal con parámetros mu y s
Y &amp;lt;- rnorm(n, mu, s) # 1000 datos aleatorios de una normal con parámetros mu y s

Z &amp;lt;- X + Y # Para cada uno de los 1000 datos de X e Y, calculamos Z

uZ &amp;lt;- sd(Z) # La incertidumbre estándar de Z es la desviación estándar de las
            # n = 1000 simulaciones&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En nuestro ejemplo, la incertidumbre estándar por Monte Carlo es de
&lt;span class=&#34;math inline&#34;&gt;\(u_{Z}^{MC} = 7.4\)&lt;/span&gt;. ¿Qué nos decía la teoría? Que
&lt;span class=&#34;math inline&#34;&gt;\(u_{Z} = \sqrt{2}\sigma = \sqrt{2}\cdot 5 = 7.1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Ojalá todo fuera tan fácil. El ejemplo era muy sencillo y la
solución es conocida en forma teórica.
La vida del químico analítico es extremadamente compleja (en todo $entido),
y no siempre existe una solución tan simple. Para eso está el método de
Monte Carlo, el cual simula un proceso complejo cuyas variables de entrada
pueden tener cualquier distribución de probabilidad tal como lo muestra
la siguiente figura:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;mc2.png&#34; width=&#34;500&#34; /&gt;&lt;/p&gt;
&lt;p&gt;La generalidad del método MC no asume normalidad de la variable de
interés &lt;span class=&#34;math inline&#34;&gt;\(g(y)\)&lt;/span&gt;, sino más bien la estima como una distribución empírica y a
partir de ésta calcula la incertidumbre estándar y expandida.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;incertidumbre-de-un-factor-de-dilución&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Incertidumbre de un factor de dilución&lt;/h1&gt;
&lt;p&gt;Para aterrizar esta definición veamos un
ejemplo muy simple en química analítica
y cómo podemos implementarlo en un lenguaje de programación
especialmente dedicado a esta tareas: &lt;code&gt;R&lt;/code&gt;. A su vez discutiremos las principales
diferencias entre el método GUM y el método de Monte Carlo&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Se prepara la dilución de una muestra antes de su lectura por AAS, mediante
la toma de una alícuota de 20 mL con una pipeta volumétrica cuyo volumen
es &lt;span class=&#34;math inline&#34;&gt;\(20,0 \pm 0,1\)&lt;/span&gt; mL y su dilución en un matraz de 100 mL,
con un volumen de &lt;span class=&#34;math inline&#34;&gt;\(100 \pm 0,6\)&lt;/span&gt; mL. Calcular la incertidumbre
del factor de dilución &lt;span class=&#34;math inline&#34;&gt;\(f = V_{final}/V_{inicial}\)&lt;/span&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div id=&#34;método-gum&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Método GUM&lt;/h2&gt;
&lt;p&gt;Este es un ejercicio bastante simple para el método GUM, pues el factor de
dilución es una operación de división, por lo que aplicando las reglas de
propagación de la incertidumbre de una división, obtenemos lo
siguiente:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:f&#34;&gt;\[\begin{equation}
  u_{f} = f\sqrt{\left(\frac{u_{V_{final}}}{V_{final}}\right)^2 + 
  \left(\frac{u_{V_{inicial}}}{V_{incial}}\right)^2}
  \tag{1}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Asumiremos por simplicidad que las incertidumbres asociadas al material
volumétrico son las indicadas por el fabricante en el mismo material, es
decir, de acuerdo a la figura &lt;a href=&#34;#fig:matraz&#34;&gt;1&lt;/a&gt; y, por ahora, serán
las únicas fuentes de incertidumbre del material volumétrico (olvidaremos
la T° y la repetibilidad).&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:matraz&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;pipeta.jpg&#34; alt=&#34;Incertidumbre del fabricante&#34; width=&#34;84&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Incertidumbre del fabricante
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Ahora bien, las incertidumbres del material volumétrico corresponden a
incertidumbres expandidas &lt;span class=&#34;math inline&#34;&gt;\(U\)&lt;/span&gt;, por lo tanto, debemos convertirlas a incertidumbres
estándares antes de aplicar la ecuación &lt;a href=&#34;#eq:f&#34;&gt;(1)&lt;/a&gt;. También por simplicidad,
modelaremos los volúmenes mediante una distribución rectangular, por lo
tanto, al estandarizar &lt;span class=&#34;math inline&#34;&gt;\(u = U/k\)&lt;/span&gt;, con &lt;span class=&#34;math inline&#34;&gt;\(k = \sqrt{3}\)&lt;/span&gt; obtenemos lo siguiente:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  u_{V_{final}} &amp;amp;=&amp;amp; \frac{0,6}{\sqrt{3}} = 0.35\, \text{mL}\\
  u_{V_{incial}} &amp;amp;=&amp;amp; \frac{0,1}{\sqrt{3}} = 0.06\, \text{mL}\\
  u_{f} &amp;amp;=&amp;amp; \frac{100}{20}\sqrt{\left(\frac{0.35}{100}\right)^2 + 
  \left(\frac{0.06}{20}\right)^2} \\
    u_{f} &amp;amp;=&amp;amp;  0.02255
\end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;En este ejemplo, podemos asumir que los grados de libertad de ambas
incertidumbres tienden a infinito, por lo tanto, si queremos obtener la
incertidumbre expandida del factor de dilución con un 95% de confianza,
se asume un factor de cobertura &lt;span class=&#34;math inline&#34;&gt;\(k = 2\)&lt;/span&gt;, de esta forma
obtenemos &lt;span class=&#34;math inline&#34;&gt;\(U_{f} = ku_{f} = 0.04509\)&lt;/span&gt; mL.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;método-de-monte-carlo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Método de Monte Carlo&lt;/h2&gt;
&lt;p&gt;Implementaremos en &lt;code&gt;R&lt;/code&gt;, los pasos descritos del método de Monte Carlo:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;k &amp;lt;- sqrt(3) # Factor de estandarización para una distribución rectangular
vi &amp;lt;- 20     # Volumen inicial [mL]
Uvi &amp;lt;- 0.1   # Incertidumbre expandida del volumen inicial [mL]
uvi &amp;lt;- Uvi/k # Incertidumbre estándar del volumen inicial [mL]
vf &amp;lt;- 100    # Volumen incial [mL]
Uvf &amp;lt;- 0.6   # Incertidumbre expandida del volumen final [mL]
uvf &amp;lt;- Uvf/k # Incertidumbre estándar del volumen final [mL]

# Aquí haremos la simulación de Monte Carlo
set.seed(123) # Para que Ud. obtenga los mismos resultados en su simulación

# Generaremos valores aleatorios de volumen inicial y volumen final
# desde una distribución rectangular con el comando runif(n, minimo, maximo)
# minimo = volumen - U
# maximos = volumen + U
# Los guardaremos en los vectores vi.sim y vf.sim

n &amp;lt;- 1000
vi.sim &amp;lt;- runif(n, vi - Uvi, vi + Uvi)
vf.sim &amp;lt;- runif(n, vf - Uvf, vf + Uvf)

# Ahora calcularemos el factor de dilución para cada uno de los pares de 
# valores de volumen inicial y final que simulamos y lo guardaremos en el
# el vector f.sim

f.sim &amp;lt;- vf.sim/vi.sim # Es la misma fórmula&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;“Bueno ¿Y?” se preguntará Ud.&lt;/p&gt;
&lt;p&gt;Veamos que hemos generado con la simulación:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; valores aleatorios del volumen inicial a partir de una
distribución rectangular con media &lt;code&gt;vi&lt;/code&gt; = 20 mL e incertidumbre expandida
&lt;code&gt;Uvi&lt;/code&gt; = 0.1 mL. El promedio de los 1000 volumenes iniciales simulados es
19.999 mL y una desviación estándar de
&lt;code&gt;uvi&lt;/code&gt; = &lt;span class=&#34;math inline&#34;&gt;\(U_{vf}/\sqrt{3} = 0.058\)&lt;/span&gt; mL. La figura &lt;a href=&#34;#fig:visim&#34;&gt;2&lt;/a&gt;
muestra el histograma de los valores simulados. Note que la simulación
concuerda perfectamente con los valores de incertidumbre informados por el
fabricante (&lt;span class=&#34;math inline&#34;&gt;\(20 \pm 0.1\)&lt;/span&gt; mL).&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:visim&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/index_files/figure-html/visim-1.png&#34; alt=&#34;Histograma de los valores simulados de volumen inicial [mL]&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Histograma de los valores simulados de volumen inicial [mL]
&lt;/p&gt;
&lt;/div&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; valores aleatorios del volumen final a partir de una
distribución rectangular con media &lt;code&gt;vf&lt;/code&gt; = 100 mL e incertidumbre expandida
&lt;code&gt;Uvf&lt;/code&gt; = 0.6 mL.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Para cada uno de los pares datos simulados de volumen inicial y final,
se calculó el factor de dilución, por lo tanto, se obtuvieron en total
&lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; factores los cuales se “guardaron” en el
vector &lt;code&gt;f.sim&lt;/code&gt;, tal como se muestra en la tabla &lt;a href=&#34;#tab:fsim&#34;&gt;1&lt;/a&gt;:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:fsim&#34;&gt;Table 1: &lt;/span&gt;Variables simuladas. Se muestran los primeros 6 datos&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;vf.sim&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;vi.sim&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;f.sim&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;99.73&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;19.96&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;100.11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;20.06&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.99&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;99.59&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;19.98&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4.98&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;100.42&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;20.08&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;100.42&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;20.09&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;99.97&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;19.91&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5.02&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&#34;4&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;La figura &lt;a href=&#34;#fig:fsimhis&#34;&gt;3&lt;/a&gt; muestra el histograma de los
1000 factores de dilución simulados:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:fsimhis&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/index_files/figure-html/fsimhis-1.png&#34; alt=&#34;Histograma de factores de dilución simulados&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Histograma de factores de dilución simulados
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;“¡Qué interesante!”, dirá Ud., la división de dos variables rectangulares
genera una distribución de datos que, al menos, es simétrica. ¿Es razonable
asumir una distribución normal del factor de dilución simulado? Si recuerda
la discusión en este
&lt;a href=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/&#34;&gt;post&lt;/a&gt;,
podemos evaluar la admisibilidad de esta hipótesis mediante el análisis
gráfico &lt;em&gt;QQ-Plot&lt;/em&gt; de normalidad de los datos simulados y el test de Shapiro,
el cual se muestra en la figura &lt;a href=&#34;#fig:fsimnorm&#34;&gt;4&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:fsimnorm&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/index_files/figure-html/fsimnorm-1.png&#34; alt=&#34;QQ-Plot de normalidad de los n factores de dilución simulados&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: QQ-Plot de normalidad de los n factores de dilución simulados
&lt;/p&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code&gt;
    Shapiro-Wilk normality test

data:  f.sim
W = 0.99005, p-value = 2.719e-06&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Aparentemente, el modelo normal sería razonable para modelar el factor de
dilución sino fuera por los siguientes hechos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;El histograma del factor de dilución tiene “colas livianas”, lo cual se puede
advertir en el &lt;em&gt;QQ-plot&lt;/em&gt; de normalidad en los valores extremos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;La evidencia del test de Shapiro en contra de la hipótesis de
normalidad.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Y lo más importante, la razón de dos variables independientes
rectangulares (uniformes) teóricamente no es Normal (está demostrado).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ok, probablemente esta discusión no sea de mucho interés por ahora, pero
nos dará pistas para dirigir la discusión posterior.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Entonces ¿Cómo obtenemos la incertidumbre del factor de dilución por el
método de Monte Carlo?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Muy sencillo, a partir de la desviación estándar de los factores de dilución
simulados, es decir, &lt;span class=&#34;math inline&#34;&gt;\(u_{f}^{MC} = 0.02302\)&lt;/span&gt;.
Como podrá advertir, es muy similar a la obtenida por el método GUM
&lt;span class=&#34;math inline&#34;&gt;\(u_{f} = 0.02255\)&lt;/span&gt;, la diferencia relativa es de
un 2.1 %. Es más, ajustando a las
cifras significativas correctas se obtiene la misma magnitud
0.02&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Queda validado el método GUM con los cálculos del método de Monte Carlo?
Desde el punto de vista metrológico químico: Sí.
Desde el punto de vista numérico: Depende.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Lo que sucede es que el numeral 8.1 del suplemento 1 dela guía GUM
es explícito en establecer
un criterio de aceptación entre el método GUM y el método de Monte Carlo (MC):&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  |y - U(y) - y_{low}| &amp;amp;&amp;lt;&amp;amp; \xi \\
  |y + U(y) - y_{high}| &amp;amp;&amp;lt;&amp;amp; \xi
\end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(y \pm U(y)\)&lt;/span&gt; es el valor calculado de la variable y su incertidumbre
expandida estimada por el método GUM; &lt;span class=&#34;math inline&#34;&gt;\(y_{low}\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(y_{high}\)&lt;/span&gt; corresponden a
los percentiles 2.5 y 97.5 de los datos simulados, es decir,
el intervalo de incertidumbre al 95% de
confianza calculado por el método de Monte Carlo. &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt; es la tolerancia
numérica entre ambas metodologías de cálculo. Es decir, es un test de
precisión numérica, no metrológica.&lt;/p&gt;
&lt;p&gt;El valor de &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt; está relacionado las cifras significativas que tienen sentido físico-químico y metrológico. Por ejemplo, si
para una gravimetría usamos una balanza granataria cuya incertidumbre es del
orden de &lt;span class=&#34;math inline&#34;&gt;\(\pm 0.1\)&lt;/span&gt; g, no podríamos elegir una tolerancia numérica
de &lt;span class=&#34;math inline&#34;&gt;\(0.00001\)&lt;/span&gt; g. Para establecer &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt; la guía indica lo siguiente:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Exprese &lt;span class=&#34;math inline&#34;&gt;\(u(y)\)&lt;/span&gt; en notación científica manteniendo las cifras
significativas. En nuestro caso obtuvimos &lt;span class=&#34;math inline&#34;&gt;\(u_{f} = 0.0225\)&lt;/span&gt;, la cual
puede ser redondeada a una cifra significativa &lt;span class=&#34;math inline&#34;&gt;\(u_{f} = 0.02\)&lt;/span&gt;.
Esta incertidumbre, entonces, se expresa como &lt;span class=&#34;math inline&#34;&gt;\(2 \cdot 10^{-2}\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Para obtener &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt;, utilice el exponente de la potencia de 10 (t = -2)
del paso anterior, en la siguiente expresión:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  \xi &amp;amp;=&amp;amp; \frac{1}{2}\times 10^{t} \\
  \xi &amp;amp;=&amp;amp; \frac{1}{2}\times 10^{-2}\\
  \xi &amp;amp;=&amp;amp; 0.005
\end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Cómo obtenemos los percentiles 2.5 y 97.5 de la simulación de Monte Carlo?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Muy sencillo, con el comando &lt;code&gt;quantile&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;Esto quiere decir, que de los &lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; datos simulados del factor de
dilución, un 95% se encuentra dentro del intervalo [4.96, 5.04].
La figura &lt;a href=&#34;#fig:quantilofig&#34;&gt;5&lt;/a&gt; muestra este intervalo en el histograma de
los datos simulados:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;hist(f.sim, 
     xlab = &amp;#39;Factor de dilución&amp;#39;,
     main = &amp;#39;&amp;#39;,
     freq = T,
     breaks = 20,
     xlim = c(4.93, 5.07))

abline(v = quantilos[1], col = &amp;#39;red&amp;#39;)
abline(v = quantilos[2], col = &amp;#39;red&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:quantilofig&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/index_files/figure-html/quantilofig-1.png&#34; alt=&#34;Intervalo de confianza al 95% de los datos simulados del factor de dilución&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Intervalo de confianza al 95% de los datos simulados del factor de dilución
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Por lo tanto, sólo nos queda calcular &lt;span class=&#34;math inline&#34;&gt;\(U(y)\)&lt;/span&gt; que es la incertidumbre expandida
del factor de dilución calculada por el método GUM. De acuerdo a la guía
&lt;span class=&#34;math inline&#34;&gt;\(U = k\cdot u\)&lt;/span&gt;, donde &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; es el factor de cobertura para obtener un
intervalo de incertidumbre con cierto grado de confianza. Aquí es donde la guía
GUM asume, bajo ciertas condiciones (ver numeral G.2.3), que la variable de
respuesta, en este caso factor de dilución, puede aproximarse a una distribución
Normal donde &lt;span class=&#34;math inline&#34;&gt;\(k \approx 2\)&lt;/span&gt;. Advierta que para nuestro ejemplo esta suposición
no tiene mucho asidero. Por lo tanto, siguiendo las directrices de la guía
GUM &lt;span class=&#34;math inline&#34;&gt;\(U_{f} = 2\cdot 0.023 = 0.05\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Con todos los datos estimados, llevemos a cabo el test de validación entre
el método GUM y el método de Monte Carlo:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  |5 - 0.045 - 4.957| &amp;amp;&amp;lt;&amp;amp; 0.005 \\
  |5 + 0.045 - 5.043| &amp;amp;&amp;lt;&amp;amp; 0.005
\end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;En ambos casos &lt;span class=&#34;math inline&#34;&gt;\(0.002 &amp;lt; 0.005\)&lt;/span&gt;, por lo tanto, el método GUM queda validado&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;Insisto con lo del mago Tamariz: ¡chiararáaa!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Observaciones:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Si bien en este ejemplo sólo utilizamos &lt;span class=&#34;math inline&#34;&gt;\(n = 1000\)&lt;/span&gt; simulaciones, en la
práctica se requieren muchas más (&lt;span class=&#34;math inline&#34;&gt;\(10^{5} - 10^{6}\)&lt;/span&gt;). El suplemento 1 de la GUM
entrega más directrices en este tema.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Mientras mayor sea el grado de no linealidad de la ecuación de medición,
más divergencias habrá entre GUM y MC. Siendo este último el de mayor
generalidad.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si bien se puede implementar Monte Carlo en Excel, es una tarea bastante
engorrosa pues debe programarlo en Visual Basic. Le sugiero utilizar lenguajes
de programación más modernos como &lt;code&gt;R&lt;/code&gt; o &lt;code&gt;Python&lt;/code&gt;, los cuales tienen librerías
especializadas en métodos de simulación.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A mayor asimetría de la distribución empírica, mayores diferencias habrá
entre ambos métodos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Dé un sentido químico a la simulación ¿&lt;a href=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/&#34;&gt;Recuerda que la pureza química no es Normal&lt;/a&gt;?
Intente con la distribución Beta la cual es más apropiada
para modelar pureza.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;En este post hemos validado el método GUM frente a Monte Carlo “a mano”, es decir,
hemos hecho el test en forma manual. En el
&lt;a href=&#34;https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/&#34;&gt;próximo post&lt;/a&gt; utilizaremos
la librería &lt;code&gt;metRology&lt;/code&gt; la cual incorpora la validación de GUM con MC en un
único comando &lt;code&gt;GUM.validate&lt;/code&gt;… ¡y listo!.&lt;/p&gt;
&lt;p&gt;Hasta la próxima.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografía&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Bibliografía&lt;/h2&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Evaluation of measurement data – Guide to the expression of uncertainty in
measurement JCGM 100:2008&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Evaluation of measurement data – Supplement 1 to the “Guide to the expression
of uncertainty in measurement” – Propagation of distributions using a Monte Carlo
method JCGM 101:2008&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Stephen L R Ellison &lt;em&gt;metRology: Support for Metrological Applications&lt;/em&gt;
R package version 0.9-23-2, 2016.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>¡Mis datos no son normales! ¿Qué hago?...Cálmese, nunca lo fueron... ni lo serán</title>
      <link>https://www.analytical.cl/post/mis-datos-no-son-normales/</link>
      <pubDate>Fri, 08 Sep 2017 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/mis-datos-no-son-normales/</guid>
      <description>
&lt;script src=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;Bueno, aquí va la primera piedra:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;No existen datos experimentales normales&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Sus datos obtenidos en el laboratorio no “siguen” ninguna distribución de
probabilidad. La naturaleza no “sigue” ninguna distribución de probabilidad.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;La Normalidad es sólo una abstracción, es un modelo matemático
de un fenómeno aleatorio.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Y como todo modelo, podría ser razonable para un conjunto de datos y totalmente
equivocado para otro. Somos nosotros, los químicos/científicos, quienes
proponemos modelos del sistema que estamos estudiando y a través de la
experimentación corroboramos o no estos modelos.&lt;/p&gt;
&lt;p&gt;Todos los tests estadísticos formales para evaluar la normalidad tampoco
responden en forma 100% certera si esta hipótesis es válida, pues
están afectos a los errores de tipo falso positivo (I) y falso negativo (II).
Por lo tanto, las pruebas estadísticas en la práctica no confirman que los
datos experimentales sean Normales, sino que nos indican si el modelo Normal
es razonable o no. Si lo es, actuamos como si “fuesen” normales y hacemos
inferencia estadística a partir de las propiedades de la Normal.&lt;/p&gt;
&lt;p&gt;El modelo Normal se describe en la ecuación &lt;a href=&#34;#eq:normal&#34;&gt;(1)&lt;/a&gt; y la figura
&lt;a href=&#34;#fig:plotnormal&#34;&gt;1&lt;/a&gt; muestra la archiconocida forma de campana:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:normal&#34;&gt;\[\begin{equation}
  f(x) = \frac{1}{\sigma \sqrt{2\pi}}\exp{-\frac{1}{2}\left(\frac{x - \mu}{\sigma}\right)^2}
  \tag{1}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(\sigma\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt; son la desviación estándar y media, respectivamente.
Notar que la distribución Normal es aplicable sólo a variables &lt;strong&gt;continuas&lt;/strong&gt;,
tales como concentración, temperatura, masa, etc. No se puede aplicar
la distribución normal a variables &lt;strong&gt;discretas&lt;/strong&gt; como cuentas de células bajo
un campo de microscopio, por ejemplo. Quizás algún microbiólogo está
familiarizado con el uso de logaritmos en sus cálculos de incertidumbre, bueno,
es porque se utilizan otros modelos de probabilidad para datos discretos (ufc),
como el modelo Poisson.&lt;/p&gt;
&lt;p&gt;Advierta también, que los posibles valores que puede tomar la variable &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt;
están en el no despreciable rango entre &lt;span class=&#34;math inline&#34;&gt;\(-\infty\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(+\infty\)&lt;/span&gt;. ¿Ha comprado
algún estándar de calibración cuyo certificado indique una
pureza de &lt;span class=&#34;math inline&#34;&gt;\(99.7 \pm 0.5\)&lt;/span&gt; %? Raro ¿no? Bueno, pues el proveedor ha aplicado
equivocadamente la distribución Normal a una variable que no es Normal: pureza
química. En efecto, desde el punto de vista químico la pureza está confinada
al intervalo &lt;span class=&#34;math inline&#34;&gt;\([0, 100]\)&lt;/span&gt; %, por lo tanto, no tiene sentido químico un certificado
que indique &lt;span class=&#34;math inline&#34;&gt;\(99.7 \pm 0.5\)&lt;/span&gt; %. Para modelar pureza química es necesario utilizar
una distribución de probabilidad que esté restringida al intervalo &lt;span class=&#34;math inline&#34;&gt;\([0, 100]\)&lt;/span&gt; %
(o &lt;span class=&#34;math inline&#34;&gt;\([0, 1]\)&lt;/span&gt;) como, por ejemplo, la distribución Beta.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:plotnormal&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/index_files/figure-html/plotnormal-1.png&#34; alt=&#34;Distribución Normal con media = 0 y sd = 1 &#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Distribución Normal con media = 0 y sd = 1
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Existen varios test para evaluar la palusibilidad de la normalidad de los datos,
pero en este post discutiremos sólo dos de ellos: El test de Shapiro-Wilk y el
Test de Anderson-Darling.&lt;/p&gt;
&lt;p&gt;La matemática detrás de estos tests no es muy digerible, por lo que simplemente
los ejemplificaremos con algunos datos reales y simulados. La ventaja de
usar simulaciones es que “creamos” artificialmente datos de la distribución
que se nos plazca y así verificar el desempeño de estos tests. Si recuerda, ya
habíamos utilizado la simulación cuando revisamos las pruebas de linealidad
en este &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;post&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Antes de hacer cualquier prueba estadística de normalidad grafique los datos,
a través de un histograma y un gráfico de probabilidad Normal&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Estos gráficos le darán una primera aproximación para evaluar el supuesto de
normalidad. Todos los softwares estadísticos incorporan estos gráficos.
A continuación los veremos en acción en datos normales simulados en
lenguaje &lt;code&gt;R&lt;/code&gt;, qué otro. El siguiente es el código para llevar a cabo esta
simulación de &lt;span class=&#34;math inline&#34;&gt;\(n = 100\)&lt;/span&gt; datos normales:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123) # Con este comando nos aseguramos de generar siempre
              # los mismos datos aleatorios. Sino, obviamente, todos
              # generaríamos números distintos pues son aleatorios ¿no?

n &amp;lt;- 100 # Número de datos a simular
mu &amp;lt;- 10 # Media de los n = 100 datos
sigma &amp;lt;- 1 # Desviación estándar de los n = 100 datos

# Genera 100 dato normales con media mu y desviación estándar sigma
# y guárdalos en el vector llamado x
x &amp;lt;- rnorm(n, mu, sigma)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Al calcular la media y desviación estándar (muestral) de estos datos obtenemos
&lt;span class=&#34;math inline&#34;&gt;\(\overline{x} = 10.1\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(s = 0.9\)&lt;/span&gt; “¿Pero cómo?
¿No habíamos simulado una media de 10 y desviación estándar 1?
Esto es una estafa” &lt;em&gt;Keep calm&lt;/em&gt; recuerde que son aleatorios.
La figura &lt;a href=&#34;#fig:normplot&#34;&gt;2&lt;/a&gt; muestra a la izquierda el histograma y a la derecha
el gráfico de normalidad (&lt;em&gt;QQ-Plot&lt;/em&gt;) de los datos simulados:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:normplot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/index_files/figure-html/normplot-1.png&#34; alt=&#34;Izquierda histograma, derecha gráfico de normalidad&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Izquierda histograma, derecha gráfico de normalidad
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;El histograma muestra esa forma de campana característica de la distribución
normal. Quizás no conozca el gráfico de probabilidad normal o &lt;em&gt;QQ-Plot&lt;/em&gt;, pero
es la primera evidencia que un estadístico revisa para evaluar la hipótesis de
normalidad. Note que la “mayoría” de los datos está sobre una línea diagonal roja,
cuando Ud. observe este patrón podría concluir que el modelo normal es
&lt;strong&gt;razonable&lt;/strong&gt; o adecuado para modelar sus datos.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Son concluyentes estos gráficos?
No, en absoluto. Simplemente muestran que la normalidad es una hipótesis
plausible.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Recuerde que estos datos son simulados, por lo tanto, era esperable este
comportamiento. Pero sus datos experimentales son “reales”, &lt;em&gt;a priori&lt;/em&gt; no sabe
qué comportamiento podrían evidenciar, sólo puede plantear una hipótesis.&lt;/p&gt;
&lt;p&gt;Apliquemos ahora los test “formales” de linealidad: test de Shapiro y
test de Anderson. Ambos tests intentan
evaluar la hipótesis nula &lt;span class=&#34;math inline&#34;&gt;\(H_{0}\)&lt;/span&gt; que los datos provienen de una
distribución Normal:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(nortest) # Cargamos esta librería que contiene varios test de
                 # Normalidad, entre ellos Anderson-Darling

# Test de Shapiro-Wilk (no requiere librería nortest)
shapiro.test(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
    Shapiro-Wilk normality test

data:  x
W = 0.99388, p-value = 0.9349&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# test de Anderson-Darling
ad.test(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
    Anderson-Darling normality test

data:  x
A = 0.182, p-value = 0.9104&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La interpretación tradicional de las pruebas de hipótesis sería más o
menos la siguiente:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ya que el &lt;em&gt;p-value&lt;/em&gt; &amp;gt; 0,05, entonces, no hay evidencia para rechazar la
hipótesis de normalidad de los datos. ¿Se conluye, entonces, que los
datos son normales? No. Simplemente, no tenemos la evidencia para rechzar la
hipótesis.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Por lo tanto, no es que los datos sean normales, sino que la hipótesis de
normalidad es razonable, por lo que actuaremos como si fuese cierto.
Obviamente, estos resultados eran esperables pues hemos “creado” datos
normales, pero recuerde que sus datos son “reales”, no simulados. Hay otras
consideraciones de las pruebas de hipótesis que no mencionaremos por espacio,
pero que un post futuro discutiremos en profundidad. Especialmente, esta
perversa dicotomía del &lt;em&gt;p-value&lt;/em&gt; &amp;lt; ó &amp;gt; 0,05 de la cual ya hicimos mención
en este &lt;a href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/&#34;&gt;post&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“The p-value was never intended to be a substitute for scientific reasoning”
Ron Wasserstein, Director Ejecutivo de la Asociación Americana de Estadística
ASA.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Nota&lt;/strong&gt;: Para tamaños de muestra grandes (&lt;span class=&#34;math inline&#34;&gt;\(n &amp;gt; 1000\)&lt;/span&gt;), una pequeña desviación
de la normalidad hará que los tests estadísticos acusen No Normalidad&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Cuando nos referimos a “actuar como si fuese cierto”, estamos diciendo que todos
aquellos procedimientos estadísticos que suponen normalidad de los datos,
funcionarán de acuerdo a la teoría. ¿Cuáles son estos métodos estadísticos que
requieren normalidad de los datos?:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Test de Student en todas sus variantes (es un test de sesgo)&lt;/li&gt;
&lt;li&gt;Test de Fisher para comparar varianzas (precisión analítica de 2 métodos)&lt;/li&gt;
&lt;li&gt;Curva de calibración lineal&lt;/li&gt;
&lt;li&gt;Máxima diferencia tolerable entre duplicados de análisis, discutido &lt;a href=&#34;https://www.analytical.cl/post/cual-maxima-diferencia-tolerable-entre-duplicados-analisis/&#34;&gt;aquí&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Análisis de varianza para evaluar varios métodos analíticos o analistas&lt;/li&gt;
&lt;li&gt;Intervalos de confianza para la media de concentraciones.&lt;/li&gt;
&lt;li&gt;Incertidumbre de métodos analíticos. El &lt;span class=&#34;math inline&#34;&gt;\(k = 2\)&lt;/span&gt; asume normalidad de las
concentraciones.&lt;/li&gt;
&lt;li&gt;… y un largo etc.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Ok, es cierto, a medida que aumenta el &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; la suposición de normalidad es cada
vez menos relevante. De hecho algunos de los tests mencionados arriba son
más o menos “robustos” a la suposición de normalidad.&lt;/p&gt;
&lt;div id=&#34;qué-observaríamos-si-la-hipótesis-de-normalidad-fuese-totalmente-inverosímil-para-modelar-nuestros-datos&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;¿Qué observaríamos si la hipótesis de normalidad fuese totalmente inverosímil para modelar nuestros datos?&lt;/h1&gt;
&lt;p&gt;Simulemos ahora datos no normales y veamos cuáles son los resultados tanto de los
gráficos exploratorios como de las pruebas estadísticas formales:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Simularemos m = 100 datos discretos de una distribución Poisson

set.seed (123) # Para que pueda reproducir los datos
m &amp;lt;- 100 # m = 100 datos
lambda &amp;lt;- 5 # Parámetro de la distribución Poisson

# Generar m = 100 datos de una distribución Poisson con parámtro lambda = 5
y &amp;lt;- rpois(m, lambda)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/index_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;div&gt;
    ¿No les parece familiar el QQ-Plot a aquellos que validan homogeneidad de peso en
validación de procesos farmacéuticos? 1313
  &lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;La evidencia de los gráficos es abrumadora, los datos no son normales. Esto
concuerda con lo que muestran los tests estadísticos de normalidad:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Test de Shapiro-Wilk (no requiere librería nortets)
shapiro.test(y)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
    Shapiro-Wilk normality test

data:  y
W = 0.97077, p-value = 0.02531&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# test de Anderson-Darling
ad.test(y)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
    Anderson-Darling normality test

data:  y
A = 1.2355, p-value = 0.003072&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como era esperable, ambos tests confirman que la hipótesis de normalidad
no es razonable para modelar los datos(&lt;em&gt;p-value&lt;/em&gt; &amp;lt; 0,05)&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;si-mis-datos-no-son-normales-entonces-cómo-los-analizo&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Si mis datos no son normales, entonces ¿Cómo los analizo?&lt;/h1&gt;
&lt;p&gt;Tranquilo(a), el mundo sigue girando. Existen varios métodos estadísticos
que Ud. puede utilizar para analizar datos donde la hipótesis de normalidad
no es razonable o se ha demostrado empíricamente que no es :&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;strong&gt;Bootstrap&lt;/strong&gt;: Utilizado, entre otros propósitos, para obtener intervalos de
confianza para datos no normales.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tests no paramétricos&lt;/strong&gt;: Análogos a las pruebas paramétricas tradicionales
(Test T, ANOVA, etc.)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tests de permutaciones&lt;/strong&gt;: También son una excelente alternativa a las
pruebas paramétricas tradicionales y funcionan, incluso, para conjuntos
pequeños de datos. Son tests “exactos”, pero necesitan que Ud. disponga de un
buen “tarro” (computador) pues son &lt;em&gt;computationally-intensive methods&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Modelos lineales generalizados&lt;/strong&gt;: Idóneos para modelar datos discretos como
cuentas de células (leucocitos, ufc, etc.) o variables dicotómicas
(Conforme/No Conforme), etc.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Transformación de datos&lt;/strong&gt;: Especialmente útiles son la transformación de
Johnson y la de Box-Cox.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Estadística Robusta&lt;/strong&gt;: No tan sólo son útiles para minimizar el
efecto de valores anómalos (&lt;em&gt;outliers&lt;/em&gt;), sino también para obener estimadores de
datos que no son normales.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Para finalizar veamos en acción uno de estos métodos: Bootstrap.
Sin embargo, el detalle estadístico y su implementación los veremos en otro post, por ahora,
simplemente lo ejemplificaremos. La figura &lt;a href=&#34;#fig:As&#34;&gt;3&lt;/a&gt; muestra
el histograma y el &lt;em&gt;QQ-Plot&lt;/em&gt; de normalidad correspondientes a datos de concentración de arsénico [ppm] muestreados en &lt;span class=&#34;math inline&#34;&gt;\(n = 271\)&lt;/span&gt; pozos de agua en
Bangladesh:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:As&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/index_files/figure-html/As-1.png&#34; alt=&#34;Histograma y QQ-Plot datos de Arsénico [ppm] en n = 271 pozos en Bangladesh&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Histograma y QQ-Plot datos de Arsénico [ppm] en n = 271 pozos en Bangladesh
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Claramente, ni si quiera es necesario hacer un test de normalidad, la evidencia
que muestra la figura &lt;a href=&#34;#fig:As&#34;&gt;3&lt;/a&gt; en contra de la hipótesis de normalidad es abrumadora. El promedio de la concentración de As es
&lt;span class=&#34;math inline&#34;&gt;\(\overline{x} = 125\)&lt;/span&gt; ppm y la
desviación estándar &lt;span class=&#34;math inline&#34;&gt;\(s = 298\)&lt;/span&gt; ppm. Utilizando
la fórmula usual para estimar un intervalo de confianza al 95% para la media
&lt;span class=&#34;math inline&#34;&gt;\(\overline{x} \pm t_{\alpha/2, n - 1} s/\sqrt{n}\)&lt;/span&gt; obtenemos
[90, 161] ppm As. Sin embargo, la gran asimetría de los datos
hace inverosímil el intervalo obtenido.&lt;/p&gt;
&lt;p&gt;Al aplicar el método &lt;em&gt;bootstrap&lt;/em&gt; obtenemos un intervalo para la media al 95% (BCa) entre [95, 164] ppm As, el cual es más
“correcto” por si Ud. necesita informar este parámetro. La figura
&lt;a href=&#34;#fig:Asboot&#34;&gt;4&lt;/a&gt; muestra el histograma y QQ-Plot de normalidad de
el método de bootstrap. Advierta el Teorema Central del Límite en su
máxima expresión.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:Asboot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/mis-datos-no-son-normales/index_files/figure-html/Asboot-1.png&#34; alt=&#34;Histograma y QQ-Plot de las estimaciones de la media de los datos de As con N = 1000 remuestreos&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Histograma y QQ-Plot de las estimaciones de la media de los datos de As con N = 1000 remuestreos
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Bueno estimado lector, nos vemos pronto. Saludos.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografía&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Bibliografía&lt;/h1&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Ghasemi A, Zahediasl S. Normality Tests for Statistical Analysis: A Guide for Non-Statisticians. &lt;em&gt;International Journal of Endocrinology and Metabolism&lt;/em&gt;. 2012;10(2):486-489. &lt;a href=&#34;doi:10.5812/ijem.3505&#34; class=&#34;uri&#34;&gt;doi:10.5812/ijem.3505&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Henry C. Thode &lt;em&gt;Testing For Normality&lt;/em&gt; CRC Press 2002&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://bit.ly/2pfPsRg&#34;&gt;Is normality testing ‘essentially useless’?&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>¿Cuál es la máxima diferencia tolerable entre duplicados de análisis?</title>
      <link>https://www.analytical.cl/post/cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis/</link>
      <pubDate>Mon, 28 Aug 2017 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis/</guid>
      <description>
&lt;script src=&#34;https://www.analytical.cl/post/cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.analytical.cl/post/cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis/index_files/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://www.analytical.cl/post/cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis/index_files/lightable/lightable.css&#34; rel=&#34;stylesheet&#34; /&gt;


&lt;p&gt;Un día cualquiera en un laboratorio que aún no establece criterios de aceptación
de precisión:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Duplicado 1 = 25.56 % Cu&lt;/li&gt;
&lt;li&gt;Duplicado 2 = 25.66 % Cu&lt;/li&gt;
&lt;li&gt;Diferencia = 0.10 % Cu&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La diferencia observada ¿es aceptable para el laboratorio?&lt;/p&gt;
&lt;p&gt;Para responder a esta pregunta debemos considerar varias cosas:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;¿Los duplicados fueron realizados en condiciones de repetibilidad o
reproducibilidad?&lt;/li&gt;
&lt;li&gt;¿Existe alguna normativa al respecto que se deba cumplir?&lt;/li&gt;
&lt;li&gt;¿Cuál es la metodología analítica? No es lo mismo determinar Cu en
concentrado de cobre por electrogravimetría (método primario) que por
Fluorescencia de Rayos X.&lt;/li&gt;
&lt;li&gt;¿Cuál es la incertidumbre del método analítico?&lt;/li&gt;
&lt;li&gt;¿Existe algún acuerdo a nivel comercial sobre estas diferencias?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Para abordar este problema tendremos que hace la suposición que
los duplicados fueron obtenidos en condiciones de repetibilidad, es decir: mismo
analista, mismo día, mismo instrumento, etc. Bajo esta premisa hay varias formas
de estimar la máxima diferencia tolerable entre duplicados de análisis.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Nota&lt;/strong&gt;: En realidad, los conceptos que mostraremos a continuación son
completamente análogos para estimar la máxima diferencia tolerable en
condiciones de reproducibilidad. Sin embargo, dedicaremos otro post a ese tema
específico.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;El concepto estadístico clave para establecer la tolerancia entre duplicados
es el límite de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;.&lt;/p&gt;
&lt;div id=&#34;límite-de-repetibilidad-r-iso-5725&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Límite de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ISO 5725&lt;/h1&gt;
&lt;p&gt;La guía ISO 5725 define el límite de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; de la siguiente manera:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
r = 2.8\cdot s_{r}
\]&lt;/span&gt;
y corresponde a la máxima diferencia, en valor absoluto, que puede
tolerarse entre duplicados de análisis, obtenidos bajo condiciones de
repetibilidad con un 95% de confianza. Veamos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt; es la desviación estándar de repetibilidad, la cual da cuenta de
la dispersión de las diferencias entre duplicados. Ya explicaremos cómo
calcular este parámetro.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;El factor &lt;strong&gt;2.8&lt;/strong&gt;: aquí les exijo una prueba de fe mis hermanos, me tienen que
creer porque si quieren la demostración, aumentaría mucho la viscosidad
de este post . A &lt;em&gt;grosso modo&lt;/em&gt;, el factor
2.8 tiene que ver con el 95% de confianza, nos indica que cuando se establece
la máxima diferencia
tolerable, está permitido que el 5% de los duplicados estén fuera del
límite &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;, y aún el
sistema analítico se encontraría bajo &lt;em&gt;Control Estadístico&lt;/em&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;cómo-obtenemos-la-precisión-de-repetibilidad-s_r&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;¿Cómo obtenemos la precisión de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt;?&lt;/h1&gt;
&lt;p&gt;Existen varios métodos estadísticos para abordar la estimación de la
desviación estándar de repetibililidad &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt;, sin embargo, en este post
nos enfocaremos en los dos más utilizados en química analítica:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Estimación basada en el registro histórico de duplicados de análisis.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;La estimación mediante estudios de precisión siguiendo las directrices de la
guía ISO 5725.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;No describiremos todos los detalles de cada uno de los diseños experimentales
expuestos en estas guías, más bien, ejemplificaremos el cálculo de la desviación
estándar de repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;método-de-estimación-en-base-a-datos-históricos-de-duplicados&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Método de estimación en base a datos históricos de duplicados&lt;/h1&gt;
&lt;p&gt;Obviamente necesitamos crear una base de datos con los registros de análisis
de muestras en duplicados en condiciones de repetibilidad. Estas muestras
pueden corresponder a muestras de clientes, materiales de referencia primarios
o secundarios, muestras control, etc. Lo importante es que ambos duplicados
cumplan con las condiciones de repetibilidad. La tabla &lt;a href=&#34;#tab:bdsr&#34;&gt;1&lt;/a&gt; es un
ejemplo de una base de datos a utilizar en este método:&lt;/p&gt;
&lt;table class=&#34;table&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:bdsr&#34;&gt;Table 1: &lt;/span&gt;Base de datos histórica de duplicados (sólo los primeros 6 datos)
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
ID
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Duplicado 1
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Duplicado 2
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-01
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.79
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.54
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-02
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
31.89
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
32.04
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-03
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
31.28
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
31.32
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-04
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
31.30
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.89
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-05
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.70
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.66
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
QAQC-06
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.86
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30.69
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Puede descargar esta base de datos desde este &lt;a href=&#34;https://1drv.ms/x/s!AuF6FPVWruwDyb4zAv7amIDqVpCvYA?e=5oqkgc&#34;&gt;link&lt;/a&gt;.
Y ahora la pregunta del millón:
¿Cuántas muestras en duplicado necesito? Si bien es posible obtener un cálculo
“exacto” del número de muestras &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;, esto está fuera del alcance de este post.
Sin embargo, podemos decir que &lt;span class=&#34;math inline&#34;&gt;\(n &amp;gt; 25\)&lt;/span&gt; es un número inicial adecuado.&lt;/p&gt;
&lt;p&gt;Una vez construida la base de datos, se puede obtener una estimación de &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt;
mediante la ecuación &lt;a href=&#34;#eq:srdup&#34;&gt;(1)&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:srdup&#34;&gt;\[\begin{equation}
  s_{r} = \sqrt{\frac{\sum_{i = 1}^{n} (x_{i1} - x_{i2})^2}{2n}}
  \tag{1}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Esta ecuación puede ser fácilmente implementada en Excel pero en este post,
como no, haremos los cálculos en lenguaje R. Pero antes, observe la figura
&lt;a href=&#34;#fig:dup&#34;&gt;1&lt;/a&gt; la cual muestra un gráfico de dispersión entre Duplicado 1 (&lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt;)
y Duplicado 2 (&lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;). En este caso el orden es irrelevante. Si ajustáramos un
modelo lineal entre ambas variables ¿Qué valores de pendiente e intercepto
deberíamos obtener?&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:dup&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis/index_files/figure-html/dup-1.png&#34; alt=&#34;Gráfico de dispersión entre duplicados&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Gráfico de dispersión entre duplicados
&lt;/p&gt;
&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;¡Correcto! Pendiente &lt;span class=&#34;math inline&#34;&gt;\(\beta_{1} = 1\)&lt;/span&gt; e intercepto &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0} = 0\)&lt;/span&gt;. La línea
roja representa esta recta teórica.
Note también que la dispersión de los datos es constante en todo el rango
de concentración, propiedad denominada &lt;strong&gt;Homocedasticidad&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Esta propiedad es deseable, sin embargo, no todos los sistemas analíticos la
poseen. En sí misma no es una problema, sin embargo, si la varibilidad de los
duplicados aumenta con la concentración (&lt;em&gt;heterocedasticidad&lt;/em&gt;)
tendremos que modelar esta variabilidad
en función de la concentración en forma explícita o segmentar el rango, lo cual
veremos en otro post.&lt;/p&gt;
&lt;p&gt;También advierta la presencia de datos alejados de la diagonal, es decir,
diferencias entre duplicados grandes. ¿Qué hacemos
con ellos?¿Los mantenemos o los eliminamos?&lt;/p&gt;
&lt;p&gt;Si los eliminamos, y realmente
reflejaran la variabilidad del método, entonces subestimaríamos la
máxima diferencia tolerable entre duplicados, aumentando la frecuencia de
alertas de duplicados no conformes (nos ponemos la soga al cuello solitos).
Si los mantenemos, y realmente fueron &lt;em&gt;errores&lt;/em&gt; puntuales de medición,
sobreestimaríamos la tolerancia y la carta control sería de poca utilidad
(mágicamente todos los datos caerían siempre dentro del los límites).
Este tema lo abordaremos en otro post (llevo una lista).&lt;/p&gt;
&lt;p&gt;Como dato “anecdótico” en las operaciones de &lt;em&gt;trading&lt;/em&gt; en el mercado mundial
de concentrado de cobre, la máxima diferencia tolerable entre resultados de
distintos laboratorios (a.k.a exportador v/s importador) es 0,20 % Cu. Si la
diferencia supera este límite, ambos negociadores se van a un arbitraje
(multiplique 0,2 % Cu por la millones de toneladas que se transan en el mercado…a
&lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; US/libra no es un asunto trivial).&lt;/p&gt;
&lt;p&gt;Utilizando los datos históricos estimamos una desviación
estándar de repetibilidad de &lt;span class=&#34;math inline&#34;&gt;\(s_{r} = 0.2\)&lt;/span&gt; % Cu. Por lo tanto,
el límite de repetibilidad es obtenido de la ecuación &lt;a href=&#34;#eq:limr&#34;&gt;(2)&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:limr&#34;&gt;\[\begin{eqnarray}
  r &amp;amp;=&amp;amp; 2.8\cdot s_{r} \\
  r &amp;amp;=&amp;amp; 2.8\cdot 0.2 \\
  r &amp;amp;=&amp;amp; 0.57\, \text{% Cu}
  \tag{2}
\end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Interpretación&lt;/strong&gt;: La máxima diferencia tolerable, en valor absoluto,
entre duplicados de análisis en condiciones de repetibilidad es
&lt;span class=&#34;math inline&#34;&gt;\(r = 0.57\)&lt;/span&gt; % Cu.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Entonces, dados los datos iniciales:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Duplicado 1 = 25.56 % Cu&lt;/li&gt;
&lt;li&gt;Duplicado 2 = 25.66 % Cu&lt;/li&gt;
&lt;li&gt;Diferencia = 0.10 % Cu&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La diferencia encontrada entre duplicados
&lt;span class=&#34;math inline&#34;&gt;\(\Delta = 0.1 &amp;lt; 0.57\)&lt;/span&gt; % Cu, por lo tanto, se acepta
la diferencia entre duplicados, es un dato de QAQC conforme.&lt;/p&gt;
&lt;p&gt;¿Y qué hacemos si no tenemos datos históricos de duplicados? Por favor,
continue leyendo.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;estimación-mediante-estudios-de-precisión-siguiendo-las-directrices-de-la-guía-iso-5725&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Estimación mediante estudios de precisión siguiendo las directrices de la guía ISO 5725&lt;/h1&gt;
&lt;p&gt;Cuando no existen datos históricos, la guía ISO 5725 sugiere llevar a cabo
un diseño experimental en el cual se estudien diversos factores que podrían,
eventualmente, tener un efecto importante en la precisión del método analítico.
Por ejemplo:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Analistas distintos&lt;/li&gt;
&lt;li&gt;Equipos de medición (cromatógrafos, AAS, etc.)&lt;/li&gt;
&lt;li&gt;Días distintos&lt;/li&gt;
&lt;li&gt;Etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El “problema” de esta aproximación es que a medida que crece el número de
factores, el tamaño del diseño experimental (a.k.a número de experientos) crece
en forma rápida incluso, en algunos diseños, en forma exponencial.&lt;/p&gt;
&lt;p&gt;La ventaja de este método es que permite estimar en un único estudio la precisión
de repetibilidad, reproducibilidad y la precisión intermedia, es decir,
entre-analistas, entre-equipos, etc. La otra ventaja es que permite estimar los
denominados componentes de varianza “¿Y?” – se preguntará.
Bueno, los componentes de varianza nos indican cuál es el factor que más aporta
a la variabilidad del sistema analítico ¿será la variabilidad entre-analistas?
¿o los distintos equipos que dispone el laboratorio? De esta forma Ud. podrá
focalizar los esfuerzos y recursos en mejorar la precisión del método sólo
en aquellos factores que más aporten a la variabilidad total.&lt;/p&gt;
&lt;p&gt;Veamos en qué consiste este método de estimación de precisión en base al
estudio del factor &lt;strong&gt;Analista&lt;/strong&gt;. Existen varios diseños experimentales para
evaluar este factor, sin embargo, en este post comenzaremos con algo
&lt;em&gt;light&lt;/em&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Estimaremos la precisión de reptibilidad y reproducibilidad del método
volumétrico para la determinación de Cu en concentrado de cobre,
en un laboratorio donde &lt;span class=&#34;math inline&#34;&gt;\(n = 4\)&lt;/span&gt; analistas son igualmente
competentes para llevar a cabo el análisis, siguiendo el mismo
instructivo.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Para abordar este objetivo, proponemos el siguiente diseño experimental:&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;doe.png&#34; width=&#34;700&#34; alt=&#34;&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Diseño Experimental&lt;/p&gt;
&lt;/div&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Una única muestra será analizada por los &lt;span class=&#34;math inline&#34;&gt;\(n = 4\)&lt;/span&gt; analistas.&lt;/li&gt;
&lt;li&gt;Cada analista realizará el análisis en quintuplicado &lt;span class=&#34;math inline&#34;&gt;\(j = 5\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Los &lt;span class=&#34;math inline&#34;&gt;\(k = n\cdot j = 20\)&lt;/span&gt; análisis deben ser obtenidos en
condiciones de repetibilidad&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Si bien podríamos publicar una enciclopedia de posts sobre diseño experimental
en química, surgen algunas preguntas sobre este diseño en particular:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;¿Por qué una única muestra? Porque si cada analista recibiera una muestra
distinta, entonces la precisión del factor analista estaría “contaminada”
con la variabilidad entre muestras, la cual no nos interesa en este
estudio.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;¿Y si una única muestra no es suficiente para llevar a cabo los 20
análisis? Existen otros diseños experimentales denominados &lt;em&gt;anidados&lt;/em&gt; que
permiten estimar la precisión utilizando muestras distintas.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;¿Por qué los análisis de cada analista deben ser obtenidos en condiciones
de repetibilidad? Porque no queremos que otro factor no controlado (por ejemplo,
equipos distintos) influya en la estimación de la precisión entre-analistas.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;En lo posible, aumente el número de analistas en vez de hacer muchos
replicados. Es mejor 5 analistas en triplicado, que 3 en quintuplicado.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“La” muestra podría corresponder a una muestra del cliente. No es necesario
que sea un material de referencia, sin embargo, esta
muestra debe ser lo suficientemente homogénea… ¡Ah, eso es trampa!
¿Cómo demostramos que la muestra es homogénea? Le doy un dato, anote:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;Si su muestra es material particulado, le tengo malas noticias: No existen
las muestras homogéneas de este tipo de material (gracias a san Pierre Gy
por el dato).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Como mencionamos anteriormente podríamos postear &lt;em&gt;ad infinitum&lt;/em&gt; sobre diseño
de exprimentos en química, sin embargo, la banda ancha es finita así que
vamos al grano. La tabla &lt;a href=&#34;#tab:doe&#34;&gt;2&lt;/a&gt; muestra los datos experimentales
del estudio de precisión propuesto:&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:doe&#34;&gt;Table 2: &lt;/span&gt;Resultados de estudio de precisión [% Cu]
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Replicado
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Analista 1
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Analista 2
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Analista 3
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Analista 4
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.74
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.73
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.06
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.00
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.06
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.16
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.17
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.98
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.34
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.98
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.24
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.79
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
4
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.28
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.11
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.80
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.65
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
5
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.02
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.72
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
25.11
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
24.82
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Antes de llevar a cabo el análisis estadístico formal, observemos la figura
&lt;a href=&#34;#fig:doeplot&#34;&gt;2&lt;/a&gt; la cual muestra el valor promedio de cada analista
&lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 1 desviación estándar. Ella nos indica que, aparentemente, los resultados
entre los analistas son bastante consistentes.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:doeplot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis/index_files/figure-html/doeplot-1.png&#34; alt=&#34;Boxplot estudio de precisión&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Boxplot estudio de precisión
&lt;/p&gt;
&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Ahora bien ¿Cómo, entonces, estimamos la precisión de repetibilidad y
reproducibilidad a partir de la tabla &lt;a href=&#34;#tab:doe&#34;&gt;2&lt;/a&gt;? Fácil, con el
todopoderoso Análisis de Varianza (ANOVA).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;No detallaremos la matemática detrás de esta poderosa técnica, sin embargo,
diremos simplemente que el ANOVA es un método cuyo propósito es particionar
la variabilidad total de un conjunto de datos en componentes que intentan
explicarla. Aplicada a nuestro caso, utilizaremos ANOVA para particionar
la variabilidad total de los 20 resultados de % Cu entre dos componentes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;El factor analista&lt;/li&gt;
&lt;li&gt;La repetiblidad del método analítico.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;para lo cual seguiremos paso a paso las instrucciones de la guía ISO 5725.
En primer lugar obtendremos la tabla ANOVA mediante lenguaje &lt;code&gt;R&lt;/code&gt;:&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:aov&#34;&gt;Table 3: &lt;/span&gt;Tabla ANOVA precisión
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Origen Variación
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
g.l
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
SQ
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
MS
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
F calculado
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
p-value
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
analista
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.07
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1.8
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.19
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Residuals
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
16
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.6
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.04
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Las tablas ANOVA muy similares en casi todos los softwares estadísticos
profesionales… y en Excel también. Entonces:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Repetibilidad &lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt;: Es simplemente la raíz cuadrada del término
&lt;span class=&#34;math inline&#34;&gt;\(MS\)&lt;/span&gt; de los &lt;strong&gt;Residuos&lt;/strong&gt;. En la nomenclatura de ANOVA es lo que se conoce como
variabilidad dentro (&lt;em&gt;within&lt;/em&gt;). Para los datos de la tabla &lt;a href=&#34;#tab:doe&#34;&gt;2&lt;/a&gt; se obtiene
&lt;span class=&#34;math inline&#34;&gt;\(s_{r} = \sqrt{\text{MS}_{Residuals}} = \sqrt{0.04} = 0.19\)&lt;/span&gt;
% Cu.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Precisión intermedia o variabilidad entre-analistas &lt;span class=&#34;math inline&#34;&gt;\(s_{analista}\)&lt;/span&gt;:
¡No tan rápido!
No es la raíz cuadrada de &lt;span class=&#34;math inline&#34;&gt;\(MS\)&lt;/span&gt; del factor analista. Debemos hacer el
siguiente cálculo adicional:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  s_{analista} &amp;amp;=&amp;amp; \sqrt{\frac{MS_{analista} - MS_{Residuals}}{j}} \\
  s_{analista} &amp;amp;=&amp;amp; \sqrt{\frac{0.07 - 0.04}{5}} \\
  s_{analista} &amp;amp;=&amp;amp; 0.08\, \text{% Cu} 
\end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(j = 5\)&lt;/span&gt; es el número de replicados que hizo cada analista&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Reproducibilidad &lt;span class=&#34;math inline&#34;&gt;\(s_{R}\)&lt;/span&gt;: Es simplemente la combinación en cuadratura de
las precisiones arriba calculadas.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{eqnarray}
  s_{R} &amp;amp;=&amp;amp; \sqrt{s_{r}^{2} + s_{analista}^2}\\
  s_{R} &amp;amp;=&amp;amp; 0.21\, \text{% Cu}
\end{eqnarray}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Por lo tanto, con estos datos podemos calcular el límite de repetibilidad
sin necesidad de tener una base de datos histórica de duplicados. En este
caso &lt;span class=&#34;math inline&#34;&gt;\(r = 2.8 s_{r} = 0.58\)&lt;/span&gt; % Cu.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Y si quisiera establecer la máxima diferencia tolerable entre analistas?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Nos vemos en el siguiente post.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bonus-track-breve-historia-del-factor-2.8&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;&lt;em&gt;Bonus track&lt;/em&gt; : Breve historia del factor 2.8&lt;/h1&gt;
&lt;p&gt;Sea &lt;span class=&#34;math inline&#34;&gt;\(x_{1}\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(x_{2}\)&lt;/span&gt; los duplicados de análisis 1 y 2, respectivamente.
Cada uno de ellos “sigue” una distribución Normal con media &lt;span class=&#34;math inline&#34;&gt;\(\mu\)&lt;/span&gt; y
varianza &lt;span class=&#34;math inline&#34;&gt;\(V = \sigma_{r}^2\)&lt;/span&gt; y, además, entre ellos son &lt;em&gt;independientes&lt;/em&gt;,
entonces se cumple lo siguiente:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;la diferencia entre duplicados &lt;span class=&#34;math inline&#34;&gt;\(\Delta = x_{1} - x_{2}\)&lt;/span&gt; sigue una distribución Normal con media 0 y
varianza &lt;span class=&#34;math inline&#34;&gt;\(V_{\Delta} = V(x_{1} - x_{2}) = V(x_{1}) + V(x_{2}) = 2\sigma_{r}^2\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si la varianza de las diferencias es &lt;span class=&#34;math inline&#34;&gt;\(V_{\Delta} = 2\sigma_{r}^2\)&lt;/span&gt;, entonces la
desviación estándar es &lt;span class=&#34;math inline&#34;&gt;\(\sqrt{2} \sigma_{r}\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Por lo tanto, si quisiéramos construir un intervalo de
confianza al 95% para la diferencia entre duplicados obtendríamos
&lt;span class=&#34;math inline&#34;&gt;\(\Delta \pm 2\sqrt{2} \sigma_{r}\)&lt;/span&gt;. El 2 es por que para una distribución Normal se
sabe que entre la media &lt;span class=&#34;math inline&#34;&gt;\(\pm\)&lt;/span&gt; 2 la desviación estándar se encuentran aproximadamente
el 95% de las observaciones.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(s_{r}\)&lt;/span&gt; es la estimación de &lt;span class=&#34;math inline&#34;&gt;\(\sigma_{r}\)&lt;/span&gt;, la cual es fija pero desconocida.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Como &lt;span class=&#34;math inline&#34;&gt;\(\sqrt{2}\approx 1,41\)&lt;/span&gt; entonces, con un 95% de confianza, la
diferencia se encuentra
entre &lt;span class=&#34;math inline&#34;&gt;\(\Delta \pm 2\cdot 1,41 \cdot s_{r} = 2.8\cdot s_{r}\)&lt;/span&gt;. Ahora imágineme como
el mago Tamariz al final de sus actos tocando el violín ¡chiararaaá! (Si eres
&lt;em&gt;old school&lt;/em&gt; sabrás quien es el mago Tamariz. Si eres &lt;em&gt;millenial&lt;/em&gt; mira este &lt;a href=&#34;https://www.youtube.com/watch?v=zcSqG2v-MZQ&#34;&gt;video&lt;/a&gt;).&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografía&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Bibliografía&lt;/h1&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;ISO 5725 – 3:1994 Accuracy (trueness and precision) of measurement methods and results – Part 3: Intermediate measures of the precision of a standard measurement method&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Michael Thompson, Bertil Magnusson Methodology in internal quality control of
chemical analysis &lt;em&gt;Accreditation and Quality Assurance August 2013, Volume 18,
Issue 4, pp 271–278&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>¿Cómo demuestro que mi curva de calibración es lineal?</title>
      <link>https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/</link>
      <pubDate>Wed, 23 Aug 2017 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/</guid>
      <description>
&lt;script src=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/index_files/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/index_files/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/index_files/lightable/lightable.css&#34; rel=&#34;stylesheet&#34; /&gt;


&lt;p&gt;En este post intentaremos derribar el mito del coeficiente de correlación con
“muchos” 9’s como prueba de linealidad. Además, presentaremos dos test
formales para evaluar el modelo de calibración lineal en química
analítica.&lt;/p&gt;
&lt;div id=&#34;coeficiente-de-correlación&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Coeficiente de correlación&lt;/h1&gt;
&lt;p&gt;Este parámetro estadístico indica la fuerza y dirección de la relación de
dos variables cuantitativas, por ejemplo;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Concentración (&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;) y Absorbancia (&lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;)&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(log \text{ Concentración}\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(E\)&lt;/span&gt; Potencial (Ecuación de Nernst)&lt;/li&gt;
&lt;li&gt;La edad de las ganadoras de Miss América con los asesinatos utilizando objetos
calientes y vapor. ¡Cuidado con las correlaciones &lt;a href=&#34;http://tylervigen.com/spurious-correlations&#34;&gt;espurias&lt;/a&gt;!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Todos los químicos estamos familiarizados con la ecuación de Lambert-Beer,
la cual establece la archiconocida relación entre absorbancia y concentración
en métodos espectrofotométricos:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:lambert&#34;&gt;\[\begin{equation}
  \underbrace{A}_\text{y} = \underbrace{\epsilon \cdot b}_\text{$\beta_{1}$} \cdot
  \underbrace{C}_\text{x}
    \tag{1}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;De la ecuación &lt;a href=&#34;#eq:lambert&#34;&gt;(1)&lt;/a&gt; se observa claramente la relación con el modelo
estándar de calibración lineal &lt;span class=&#34;math inline&#34;&gt;\(y = \beta_{0} + \beta_{1}x\)&lt;/span&gt; asumiendo un
intercepto &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0} = 0\)&lt;/span&gt;. Por lo tanto ¿por qué nos sorprende tanto
encontrar un coeficiente de
correlación alto en curvas de calibración espectrofotométricas? Era totalmente
esperable, pues hay un modelo físico-químico que sustenta el modelo lineal.&lt;/p&gt;
&lt;p&gt;OK, de acuerdo. Este modelo físico-químico sólo es válido bajo ciertas
condiciones (como todos los modelos), de hecho son conocidas las desviaciones
de la ley de Lambert-Beer a altas concentraciones.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;derribando-el-mito-del-r-0999&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Derribando el mito del r = 0,999…&lt;/h1&gt;
&lt;p&gt;Para comenzar, por favor, ponga atención a la figura &lt;a href=&#34;#fig:anscombe&#34;&gt;1&lt;/a&gt;
denominada “El Cuarteto de Anscombe”. La “gracia” de estos
datos de calibración es que todos tienen la misma pendiente, intercepto,
error de calibración y… ¡coeficiente de correlación!&lt;/p&gt;
&lt;p&gt;¿No me cree? Le dejo este &lt;a href=&#34;https://1drv.ms/x/s!AuF6FPVWruwDyKxMLQ2ngb99Eo3q7w?e=5jIW6e&#34;&gt;link&lt;/a&gt;
para que descargue los datos en archivo Excel
y se convenza con sus propios ojos.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:anscombe&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/index_files/figure-html/anscombe-1.png&#34; alt=&#34;El Cuarteto de Ascombe&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: El Cuarteto de Ascombe
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;El punto que revela la figura &lt;a href=&#34;#fig:anscombe&#34;&gt;1&lt;/a&gt; es que es posible obtener
coeficientes de
correlación “altos” inclusive con datos que, a simpe vista, no revelan
una relación lineal entre &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt;. Es más, es posible obtener un alto
coeficiente de correlación donde no existe absolutamente ninguna
correlación entre &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(Y\)&lt;/span&gt; mediante un mal de diseño de la curva de
calibración. Por ejemplo, en la figura &lt;a href=&#34;#fig:influyente&#34;&gt;2&lt;/a&gt; se muestra a la izquierda
que la correlación entre &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; e &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; es prácticamente 0. Sin embargo,
cuando incluimos un punto &lt;em&gt;influyente&lt;/em&gt;, muy alejado de la nube de puntos a
baja concentración, mágicamente el r = 1 (derecha).&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Moraleja:&lt;/em&gt; Trate, en lo posible, de diseñar la curva con los puntos
equiespaciados y evite los saltos de varios órdenes de magnitud de la
concentración.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;
## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:influyente&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/index_files/figure-html/influyente-1.png&#34; alt=&#34;Punto inlfuyente en la calibración&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Punto inlfuyente en la calibración
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;La linealidad tampoco es un parámetro cuantitativo, una curva con r = 0,999 no
es más lineal que otra con r = 0,99. Observe la figura &lt;a href=&#34;#fig:simplot&#34;&gt;3&lt;/a&gt;, ambas curvas fueron simuladas en lenguaje &lt;code&gt;R&lt;/code&gt; con el mismo intercepto y
pendiente siguiendo estrictamente el modelo lineal
&lt;span class=&#34;math inline&#34;&gt;\(y = \beta_{0} + \beta_{1}x\)&lt;/span&gt;, sin embargo, tienen coeficientes de
correlación distintos. La curva de la izquierda no es más lineal que la de la
derecha ya que ambas fueron simuladas a partir del mismo modelo, la única
diferencia es que la de la derecha tiene una mayor dispersión de los puntos, pero
no por ello es “menos lineal”, de hecho ambas lo son, pues fueron simuladas.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123) # Es para que Ud. obtenga los mismos 
              # resultados en su simulación en R
              

b0 &amp;lt;- 1  # Intercepto = 1
b1 &amp;lt;- 10 # Pendiente = 10
s &amp;lt;- 1   # Desviación estándar de calibración

# Simulamos el mismo modelo lineal 
x &amp;lt;- 1:10 # Calibrantes
y1 &amp;lt;- b0 + b1*x + rnorm(10, 0, s) # Absorbancias con 
                                  # error = s = 1
y2 &amp;lt;- b0 + b1*x + rnorm(10, 0, 10*s) # Absorbancias con 
                                     # error = 10*s = 10&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;
## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:simplot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/index_files/figure-html/simplot-1.png&#34; alt=&#34;Simulación de curvas perfectamente lineales&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Simulación de curvas perfectamente lineales
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;test-formales-de-linealidad&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Test formales de linealidad&lt;/h1&gt;
&lt;p&gt;Existen varios tests estadísticos formales para evaluar el supuesto de
linealidad de la curva de calibración. Sin embargo, en este post veremos dos
que son los más utilizados en Química Analítica y son sugeridos por
normativas internacionales (para presentárselos a los amables auditores).&lt;/p&gt;
&lt;p&gt;Si bien no es estrictamente riguroso, para simplificar el concepto, diremos que
ambos tests estadísticos intentan dirimir entre dos hipótesis:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(H_{0}\)&lt;/span&gt; (a.k.a Hipótesis Nula) : El modelo lineal es adecuado para describir
los datos de calibración&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(H_{1}\)&lt;/span&gt; (a.k.a Hipótesis alternativa): El modelo lineal &lt;strong&gt;NO&lt;/strong&gt; es adecuado para
describir los datos de calibración&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;También debemos hacer la siguiente acotación: En &lt;strong&gt;estadística&lt;/strong&gt;
un modelo lineal es
aquel en que sus parámetros son lineales. Por ejemplo, la curva de calibración lineal
clásica &lt;span class=&#34;math inline&#34;&gt;\(y = \beta_{0} + \beta_{1}x\)&lt;/span&gt; tanto &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0}\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(\beta_{1}\)&lt;/span&gt; son
lineales. Sin embargo, en un modelo exponencial &lt;span class=&#34;math inline&#34;&gt;\(y = \gamma_{0} e^{\gamma_{1}x}\)&lt;/span&gt;
el coeficiente &lt;span class=&#34;math inline&#34;&gt;\(\gamma_{1}\)&lt;/span&gt; no lo es.&lt;/p&gt;
&lt;p&gt;Dicho esto, el modelo cuadrático de calibración
&lt;span class=&#34;math inline&#34;&gt;\(y = \beta_{0} + \beta_{1}x + \beta_{2}x^2\)&lt;/span&gt; &lt;strong&gt;es lineal&lt;/strong&gt; desde el punto de vista
estrictamente estadístico. Sin embargo, debido al arraigo del concepto de
linealidad en química analítica no modificaremos su interpretación.&lt;/p&gt;
&lt;div id=&#34;test-de-carencia-de-ajuste-lack-of-fit-iso-11095&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Test de carencia de ajuste (&lt;em&gt;Lack of fit&lt;/em&gt;) ISO 11095&lt;/h2&gt;
&lt;p&gt;Este test está basado en comparar dos estimadores del error aleatorio:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Error puro o experimental&lt;/li&gt;
&lt;li&gt;Error de carencia de ajuste o &lt;em&gt;lack of fit&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Es decir, necesitamos un estimador del error aleatorio totalmente independiente
del error del modelo de calibración que queremos ajustar. Para estimar este
error, la prueba de carencia de ajuste exige que hagamos replicados de cada uno
de los calibrantes.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Pero tienen que ser replicados verdaderos. No es válido inyectar varias veces
el mismo estándar en el equipo. Prepárelos independientemente.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Si los dos estimadores del error aleatorio son similares, entonces el modelo
de calibración que acabamos de ajustar es adecuado para modelar los
datos experimentales. ¿Cuán similares tienen que ser? Lo probaremos con un test
F. Los detalles algebraicos son latosos-engorrosos y pueden ser consultados
en la bibliografía. Sólo indicaremos cómo hacer este test de linealidad en
lenguaje &lt;code&gt;R&lt;/code&gt;, como no. (¿Y en Excel cuándo?)&lt;/p&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:lof&#34;&gt;1&lt;/a&gt; muestra los datos de calibración de cloranfenicol en matriz leche
obtenida por GC/MS-NCI
(&lt;em&gt;Gas Chromatography/Mass Spectrometry - Negative Chemical Ionization&lt;/em&gt; …¡Qué
tiempos aquellos!). Note que cada nivel de calibración está preparado en
triplicado totalizando n = 15 calibrantes independientes.
La figura &lt;a href=&#34;#fig:lofplot&#34;&gt;4&lt;/a&gt; muestra la curva de calibración.&lt;/p&gt;
&lt;table class=&#34;table&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:lof&#34;&gt;Table 1: &lt;/span&gt;Calibración CAF [ug/kg]
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Replicado
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0.25
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0.5
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0.75
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
1
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
88
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
7714
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
15292
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
22611
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30280
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
154
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
7726
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
14947
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
22945
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30222
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
512
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
8043
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
15063
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
22772
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
30089
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:lofplot&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/index_files/figure-html/lofplot-1.png&#34; alt=&#34;Curva de calibración CAF. Test de carencia de ajuste&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Curva de calibración CAF. Test de carencia de ajuste
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:lofcal&#34;&gt;2&lt;/a&gt; muestra el análisis estadístico de
esta calibración:&lt;/p&gt;
&lt;!-- Ancho de las tabla --&gt;
&lt;style type=&#34;text/css&#34;&gt;
.table {

    width: 100%;
    
}
&lt;/style&gt;
&lt;table&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:lofcal&#34;&gt;Table 2: &lt;/span&gt;Pendiente e intercepto de calibración
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
term
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
estimate
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
std.error
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
statistic
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
p.value
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
(Intercept)
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
262
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
78
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.005
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
x.caf
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
29936
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
127
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
236
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.000
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Por ahora no nos detendremos en el análisis de la tabla (eso quedará para otro post). Haremos directamente el Test de Carencia de Ajuste (&lt;em&gt;lack of fit&lt;/em&gt;) en
&lt;code&gt;R&lt;/code&gt; el cual se muestra en la tabla &lt;a href=&#34;#tab:loftest&#34;&gt;&lt;strong&gt;??&lt;/strong&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(olsrr) # Cargamos el package &amp;#39;olsrr&amp;#39; para aplicar el test lack-of-fit
ols_pure_error_anova(fit.cal)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Lack of Fit F Test 
## ------------------
## Response :   y.caf 
## Predictor:   x.caf 
## 
##                            Analysis of Variance Table                             
## ---------------------------------------------------------------------------------
##                 DF       Sum Sq           Mean Sq        F Value        Pr(&amp;gt;F)    
## ---------------------------------------------------------------------------------
## x.caf            1    1680303154.42    1680303154.42     54131.47    6.444664e-25 
## Residual        13        392485.57         30191.20                              
##  Lack of fit     3         82074.03         27358.01    0.8813464       0.4832262 
##  Pure Error     10        310411.54         31041.15                              
## ---------------------------------------------------------------------------------&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ok, para interpretar el test de carencia de ajuste nos fijaremos en la
fila que dice “&lt;em&gt;Lack of fit&lt;/em&gt;” y en el &lt;em&gt;p-value&lt;/em&gt; del test, el cual aparece
bajo la columna &lt;em&gt;Pr(&amp;gt;F)&lt;/em&gt; = 0.483. La interpretación
tradicional de una prueba estadística diría algo más o menos así:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Dado que el &lt;em&gt;p-value&lt;/em&gt; &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt; 0.05\)&lt;/span&gt;, entonces, no hay evidencias en contra de la
hipótesis nula. El modelo lineal es adecuado para modelar los datos de
calibración.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Algunas consideraciones:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;¿Dice en alguna parte que el modelo de calibración es lineal? Póngalo de
&lt;em&gt;wallpaper&lt;/em&gt; en su pantalla: &lt;strong&gt;NO&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Lo único que se puede extraer como conclusión es que el modelo lineal
es adecuado, es razonable para modelar los datos de calibración. Nada más.&lt;/li&gt;
&lt;li&gt;Existen infinitos modelos de calibración que podrían ser idóneos, este test
nos dice si el que hemos elegido para modelar los datos es razonable/adecuado,
sin embargo, no nos dice que sea “EL” modelo perfecto.&lt;/li&gt;
&lt;li&gt;¿Qué tiene de especial el famoso 0,05? Absolutamente &lt;em&gt;NADA&lt;/em&gt;. ¿Qué concluiría
Ud. si el &lt;em&gt;p-value&lt;/em&gt; fuese 0,04999 ó 0,05001? Sería un test totalmente
inconcluyente.&lt;/li&gt;
&lt;li&gt;Lamentablemente, esto es una dicotomía perversa que desde hace mucho
tiempo ha sido objeto de varias críticas. Le invito a leer las siguientes
referencias sobre la interpretación y controversia de los &lt;em&gt;p-values&lt;/em&gt; en ciencia:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Ronald L. Wasserstein &amp;amp; Nicole A. Lazar (2016)
The ASA’s Statement on p-Values: Context, Process, and Purpose
&lt;em&gt;The American Statistician Volume 70, 2016 - Issue 2&lt;/em&gt; &lt;a href=&#34;http://amstat.tandfonline.com/doi/abs/10.1080/00031305.2016.1154108&#34;&gt;link&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;M.Baker Statisticians issue warning over misuse of P values
&lt;em&gt;Nature &lt;strong&gt;531&lt;/strong&gt;, 151 (10 March 2016)&lt;/em&gt; &lt;a href=&#34;http://www.nature.com/news/statisticians-issue-warning-over-misuse-of-p-values-1.19503&#34;&gt;link&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Singh Chawla D. Big names in statistics want to shake up much-maligned P value. &lt;em&gt;Nature. 2017 Jul 26;548(7665):16-17&lt;/em&gt; &lt;a href=&#34;https://www.nature.com/news/big-names-in-statistics-want-to-shake-up-much-maligned-p-value-1.22375?beta=false&#34;&gt;link&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;“The p-value was never intended to be a substitute for scientific reasoning”
Ron Wasserstein, Director Ejecutivo de la Asociación Americana de Estadística
ASA.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div id=&#34;test-de-mandel-iso-8466-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Test de Mandel ISO 8466-1&lt;/h2&gt;
&lt;p&gt;Esta prueba estadística es bastante sencilla y está basada en la comparación
entre el modelo de calibración lineal y un modelo alternativo. Por lo tanto,
no es una prueba absoluta, sino relativa a la elección del modelo alternativo. Require al menos n = 6 calibrantes (sin replicado).&lt;/p&gt;
&lt;p&gt;En general, el test de Mandel utiliza el modelo de calibración cuadrático para
compararlo con el modelo lineal:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ y = \beta_{0} + \beta_{1}x + \beta_{2}x^2\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Los detalles estadísticos pueden consultarse en la bibliografía.&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Primero calcule la suma de cuadrados de los residuos &lt;span class=&#34;math inline&#34;&gt;\(SS_{r}\)&lt;/span&gt; para cada uno de
los modelos de acuerdo a la siguiente expresión:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:res&#34;&gt;\[\begin{equation}
  SS_{r} = \sum_{i = 1}^{n} e_{i}^2
    \tag{2}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Donde el residuo &lt;span class=&#34;math inline&#34;&gt;\(e = y - \hat{y}\)&lt;/span&gt;.
&lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; es la respuesta instrumental observada o experimental
(áreas, absorbancias, etc.); &lt;span class=&#34;math inline&#34;&gt;\(\hat{y}\)&lt;/span&gt;, es la respuesta instrumental que predice
el modelo (lineal o o cuadrático) en cada una de las concentraciones de los
calibrantes. Si observa la ecuación &lt;a href=&#34;#eq:res&#34;&gt;(2)&lt;/a&gt; el concepto de residuo es el mismo para
cualquier modelo de calibración, es decir, ¿cuánto difiere lo que se observa
experimentalmente con lo que predice el modelo?&lt;/p&gt;
&lt;p&gt;Un buen modelo tiene residuos pequeños.
Un residuo grande para cierto de nivel de concentración implica que existe una
gran diferencia entre lo observado y lo que predice el modelo, por lo tanto, nos
guiará (en otro post) a detectar posibles valores anómalos o &lt;em&gt;outliers&lt;/em&gt;.&lt;/p&gt;
&lt;ol start=&#34;2&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Calcule la diferencia entre ambas sumas de cuadrado de los residuos, la del
modelo no lineal &lt;span class=&#34;math inline&#34;&gt;\(SS_{r}^{no-lin}\)&lt;/span&gt; y la correspondiente al modelo lineal
&lt;span class=&#34;math inline&#34;&gt;\(SS_{r}^{lin}\)&lt;/span&gt;:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:D&#34;&gt;\[\begin{equation}
  D = SS_{r}^{no-lin} -  SS_{r}^{lin}
  \tag{3}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Estime el estadístico F calculado:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:D&#34;&gt;\[\begin{equation}
  F = \frac{D}{SS_{r}^{no-lin}/(n - 3)}
  \tag{3}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34; style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Obtenga el F de tabla para 1 grado de libertad en el numerador y
&lt;span class=&#34;math inline&#34;&gt;\(n - 3\)&lt;/span&gt; para el denominador&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Compare el &lt;span class=&#34;math inline&#34;&gt;\(F_{calculado}\)&lt;/span&gt; con el &lt;span class=&#34;math inline&#34;&gt;\(F_{tabla}\)&lt;/span&gt; y decida en base a la siguiente
regla:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Si &lt;span class=&#34;math inline&#34;&gt;\(F_{calculado} &amp;lt; F_{tabla}\)&lt;/span&gt; se concluye que no hay evidencias en contra
de la hipótesis nula de linealidad del modelo. ¿Quiere decir que el modelo de
calibración es exactamente lineal? Ya sabemos que &lt;strong&gt;NO&lt;/strong&gt;. Rigen las mismas
consideraciones que que notamos en el test de carencia de ajuste.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si &lt;span class=&#34;math inline&#34;&gt;\(F_{calculado} &amp;gt; F_{tabla}\)&lt;/span&gt; se rechaza la hipótesis nula de linealidad
del modelo. Los datos no son consistentes con la hipótesis. Y aquí se abre
una caja de Pandora, pues esta conclusión también tiene muchas consideraciones
estadísticas que se deben tener en cuenta para interpretarla apropiadamente las
cuales, por ahora, no profundizaremos.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Los pasos recién descritos son para llevar a cabo el Test de Mandel “a mano”,
afortunadamente los softwares estadísticos como &lt;code&gt;R&lt;/code&gt; y Excel (sí ¡Excel!) tienen
incorporada esta prueba estadística de linealidad. Veamos un ejemplo.&lt;/p&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:datamandel&#34;&gt;3&lt;/a&gt; muestra los datos de calibración de Cu por AAS;
la figura &lt;a href=&#34;#fig:plotmandel&#34;&gt;5&lt;/a&gt;, la curva de calibración:&lt;/p&gt;
&lt;table class=&#34;table&#34; style=&#34;width: auto !important; &#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:datamandel&#34;&gt;Table 3: &lt;/span&gt;Curva de Calibración Cu
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
0
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
10
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
20
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
30
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
40
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
50
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
60
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
70
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
80
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
90
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
100
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
-0.007
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.071
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.146
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.212
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.274
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.334
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.385
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.43
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.473
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.511
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.546
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:plotmandel&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/index_files/figure-html/plotmandel-1.png&#34; alt=&#34;Curva de calibración Cu&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Curva de calibración Cu
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;A simple vista se observa la no linealidad de la curva de calibración. Veamos
que nos dice el Test de Mandel en la siguiente tabla ANOVA:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# d: corresponde al data frame de los datos de calibración

fit.lin &amp;lt;- lm(y ~ x, data = d) # Ajuste lineal.
fit.nolin &amp;lt;- lm(y ~ x + I(x^2), data = d) # Ajuste no lineal cuadrático

anova(fit.lin, fit.nolin)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Analysis of Variance Table

Model 1: y ~ x
Model 2: y ~ x + I(x^2)
  Res.Df       RSS Df Sum of Sq      F    Pr(&amp;gt;F)    
1      9 0.0054816                                  
2      8 0.0000186  1  0.005463 2351.1 3.621e-11 ***
---
Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En la tabla el valor
&lt;span class=&#34;math inline&#34;&gt;\(F = 2351\)&lt;/span&gt; corresponde al
&lt;span class=&#34;math inline&#34;&gt;\(F_{calculado}\)&lt;/span&gt; el cual es comparado internamente con el &lt;span class=&#34;math inline&#34;&gt;\(F_{tabla}\)&lt;/span&gt;
entregando, finalmente, el &lt;em&gt;p-value&lt;/em&gt;
&lt;span class=&#34;math inline&#34;&gt;\(Pr(&amp;gt;F) = 3.62e-11\)&lt;/span&gt;.
La evidencia
en contra de la hipótesis nula de linealidad es abrumadora.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;entonces-resumiendo-por-qué-no-puedo-probar-linealidad-de-la-curva-de-calibración&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Entonces, resumiendo ¿Por qué no puedo probar linealidad de la curva de calibración?&lt;/h1&gt;
&lt;p&gt;Porque la decisión está basada en pruebas estadísticas, las cuáles tienen
algunas consideraciones para su correcta interpretación:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Con estas pruebas estadísticas no se puede probar linealidad, lo que
podemos concluir es que el modelo lineal es adecuado o razonable
para modelar nuestros datos de calibración ¡nada más!.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Es imposible que en un sistema físico-químico complejo como una llama o plasma/detector
(ICP-MS) exista una relación “perfectamente” lineal entre absorbancia (cuentas)
y concentración. Lo que hicieron Lambert &amp;amp; Beer (o cualquier científico que
proponga un modelo de la naturaleza) fue proponer una simplificación
del sistema
y representarlo mediante un modelo cuantitativo.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Existen muchos modelos que se podrían ajustar muy bien
a nuestros datos de calibración,
pero en estadística existe el principio de parsimonia:&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;En igualdad de condiciones, la explicación más sencilla suele ser la más
probable&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;¿Por qué complicarnos la existencia con un modelo hiper-super-parabólico-
tangencial si el modelo lineal es razonable y adecuado para nuestros
propósitos de cuantificación? Pero ojo:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“Everything should be made as simple as possible, but no simpler”
– Albert Einstein&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Es aquí donde las pruebas estadísticas nos ayudan a decidir entre varios modelos
plausibles.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;en-defensa-del-coeficiente-de-correlación&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;En defensa del coeficiente de correlación&lt;/h1&gt;
&lt;p&gt;Es cierto, el &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; con “muchos” 9’s no es una prueba formal de linealidad…
¿quiere decir que el &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; no es importante en Química
Analítica? Por supuesto que sí lo es. Anote:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;El coeficiente de correlación está íntimamente ligado con la
incertidumbre de calibración. A mayor &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; menor es la
incertidumbre de calibración.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Puede profundizar en este aspecto consultando en:&lt;/p&gt;
&lt;p&gt;Ellison, S.L.R. In defense of the correlation
coefficient. &lt;em&gt;Accred Qual Assur (2006) 11: 146.&lt;/em&gt;
&lt;a href=&#34;https://doi.org/10.1007/s00769-006-0087-y&#34; class=&#34;uri&#34;&gt;https://doi.org/10.1007/s00769-006-0087-y&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;por-último-y-el-r2&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Por último… ¿y el &lt;span class=&#34;math inline&#34;&gt;\(r^2\)&lt;/span&gt;?&lt;/h1&gt;
&lt;p&gt;Ahhh, pero eso es otra cosa… hasta la próxima.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bibliografía&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Bibliografía&lt;/h1&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Lutz Brüggemann, Wolfgang Quapp, Rainer Wennrich &lt;strong&gt;Test for non-linearity concerning linear calibrated chemical measurements&lt;/strong&gt; (2006) &lt;em&gt;Accreditation and Quality Assurance Volume 11, Issue 12, pp 625–631&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;J. M. Andrade and M. P. Gómez-Carracedo &lt;strong&gt;Notes on the use of Mandel’s test to check for nonlinearity in laboratory calibrations&lt;/strong&gt;
&lt;em&gt;Anal. Methods, 2013,5, 1145-1149&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Cómo calcular la incertidumbre de una curva de calibración</title>
      <link>https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/</link>
      <pubDate>Mon, 14 Aug 2017 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/</guid>
      <description>
&lt;script src=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/index_files/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/index_files/lightable/lightable.css&#34; rel=&#34;stylesheet&#34; /&gt;


&lt;p&gt;Ok, este es el segundo post. Advierto que aún está en rodaje… esto del &lt;em&gt;copywriting&lt;/em&gt; no es nada fácil.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;¿Qué es y cómo estimar la incertidumbre de una curva de calibración?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;La incertidumbre de calibración, en adelante &lt;span class=&#34;math inline&#34;&gt;\(u(x_{0})\)&lt;/span&gt;, es aquella que se
propaga cuando obtenemos la concentración de un mensurando
al &lt;em&gt;interpolar&lt;/em&gt; una señal instrumental (por ejemplo, absorbancia o
área cromatográfica) en una curva de calibración. Básicamente,
esta incertidumbre
sólo da cuenta del error aleatorio del instrumento y no incopora la
incertidumbre de los calibrantes, al menos cuando se utiliza el modelo de
calibración clásico:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:lin&#34;&gt;\[\begin{equation}
  y = \beta_{0} + \beta_{1} x + \epsilon
    \tag{1}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; es la respuesta instrumental, &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0}\)&lt;/span&gt; es el intercepto,
&lt;span class=&#34;math inline&#34;&gt;\(\beta_{1}\)&lt;/span&gt; es la pendiente y &lt;span class=&#34;math inline&#34;&gt;\(\epsilon\)&lt;/span&gt; es un error aleatorio Normal que tiene
media &lt;span class=&#34;math inline&#34;&gt;\(\mu_{\epsilon} = 0\)&lt;/span&gt; y varianza &lt;span class=&#34;math inline&#34;&gt;\(\sigma_{y/x}^2\)&lt;/span&gt;. Note de la
ecuación &lt;a href=&#34;#eq:lin&#34;&gt;(1)&lt;/a&gt; que lo único aleatorio es &lt;span class=&#34;math inline&#34;&gt;\(\epsilon\)&lt;/span&gt;, por lo tanto,
el intercepto &lt;span class=&#34;math inline&#34;&gt;\(\beta_{0}\)&lt;/span&gt; y la pendiente &lt;span class=&#34;math inline&#34;&gt;\(\beta_{1}\)&lt;/span&gt; son &lt;em&gt;fijos&lt;/em&gt;.
Lo que hacemos cuando aplicamos, por ejemplo, el método de los mínimos
cuadrados es estimar estos parámetros y, en estadística, todas las
estimaciones tienen un error asociado.&lt;/p&gt;
&lt;p&gt;A partir de la ecuación &lt;a href=&#34;#eq:lin&#34;&gt;(1)&lt;/a&gt; obtenemos la concentración de una
muestra problema &lt;span class=&#34;math inline&#34;&gt;\(x_{0}\)&lt;/span&gt; cuya señal instrumental es &lt;span class=&#34;math inline&#34;&gt;\(y_{0}\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:x0&#34;&gt;\[\begin{equation}
  x_{0} = \frac{y_{0} - \beta_{0}}{\beta_{1}}
    \tag{2}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Si aplicáramos la guía GUM para obtener la incertidumbre estándar de
calibración &lt;span class=&#34;math inline&#34;&gt;\(u(x_{0})\)&lt;/span&gt; sería bastante latoso-engorroso, pues hay unas
covarianzas no muy amistosas entre pendiente e intercepto. Afortunadamente
&lt;span class=&#34;math inline&#34;&gt;\(u(x_{0})\)&lt;/span&gt; puede aproximarse muy bien a través de la ecuación &lt;a href=&#34;#eq:ux0&#34;&gt;(3)&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34; id=&#34;eq:ux0&#34;&gt;\[\begin{equation}
  u(x_{0}) = \frac{\sigma_{y/x}}{\beta_{1}}
  \sqrt{\frac{1}{n} + \frac{1}{m_{0}} + \frac{(x_{0} - \overline{x})^2}
  {\sum_{i}^{n} (x_{i} - \overline{x})^2}}
    \tag{3}
\end{equation}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Vamos viendo dijo el ciego:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\sigma_{y/x}\)&lt;/span&gt; es la desviación estándar del error aleatorio &lt;span class=&#34;math inline&#34;&gt;\(\epsilon\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; es el número de calibrantes independientes (esto da para otro post)&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(m_{0}\)&lt;/span&gt; es el número de replicado independientes de la muestra problema&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\overline{x}\)&lt;/span&gt; es el promedio de la concentraciones de los calibrantes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Esta incertidumbre se puede observar en la figura &lt;a href=&#34;#fig:banda&#34;&gt;1&lt;/a&gt;, la
cual fue obtenida mediante simulación en lenguaje &lt;code&gt;R&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123)
x &amp;lt;- 1:10
y &amp;lt;- 2 + 5*x + 10*rnorm(length(x), 0, 1)
d &amp;lt;- data.frame(x, y)

library(ggplot2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: package &amp;#39;ggplot2&amp;#39; was built under R version 4.2.2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(d, aes(x = x, y = y)) +
  geom_smooth(method = &amp;#39;lm&amp;#39;) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula = &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:banda&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/index_files/figure-html/banda-1.png&#34; alt=&#34;Incertidumbre de calibración&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Incertidumbre de calibración
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;¿Dónde se obtiene la menor incertidumbre de calibración? … ¡Correcto!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;En el centro de la curva se minimiza la incertidumbre de calibración&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Si obervamos la ecuación &lt;a href=&#34;#eq:ux0&#34;&gt;(3)&lt;/a&gt; podemos minimizar &lt;span class=&#34;math inline&#34;&gt;\(u(x_{0})\)&lt;/span&gt;:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Aumentando &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; el número de calibrantes.&lt;/li&gt;
&lt;li&gt;Aumentando &lt;span class=&#34;math inline&#34;&gt;\(m_{0}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Diseñando la curva de calibración de modo que &lt;span class=&#34;math inline&#34;&gt;\(x_{0} = \bar{x}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Aunque no tan “evidente”, maximizando &lt;span class=&#34;math inline&#34;&gt;\(\sum_{i}^{n} (x_{i} - \overline{x})^2\)&lt;/span&gt;,
es decir, utilizando todo el rango lineal (Nota mental: otro post)&lt;/li&gt;
&lt;/ol&gt;
&lt;div id=&#34;aplicación-a-un-caso-real&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Aplicación a un caso “real”&lt;/h1&gt;
&lt;p&gt;La tabla &lt;a href=&#34;#tab:tabla&#34;&gt;1&lt;/a&gt; muestra los datos de una curva de calibración para la determinación de cobre en mineral por AAS, la figura &lt;a href=&#34;#fig:cal&#34;&gt;2&lt;/a&gt; describe
el gráfico de calibración:&lt;/p&gt;
&lt;p&gt;&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Alguien capo en HTML/CSS que me ayude a poner tabla enfrentada con figura en
2 columnas por favor… y que Dios se lo pague.
  &lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;table class=&#34;table&#34; style=&#34;width: auto !important; &#34;&gt;
&lt;caption&gt;
&lt;span id=&#34;tab:tabla&#34;&gt;Table 1: &lt;/span&gt;Curva de Calibración Cu
&lt;/caption&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
Cu [ppm]
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
UA
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.0344
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.0777
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.1356
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
4
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.1607
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
5
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.2013
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
6
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.2572
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
7
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.2846
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
8
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.3073
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
9
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.3531
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
10
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
0.3955
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula = &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:cal&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/index_files/figure-html/cal-1.png&#34; alt=&#34;Curva de calibración&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Curva de calibración
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Ok, hay varias formas de implementar los cálculos de incertidumbre de
calibración de la ecuación &lt;a href=&#34;#eq:ux0&#34;&gt;(3)&lt;/a&gt;. Podríamos utilizar Excel para
obtener cada uno de los términos, pero eso lo ilustraremos en otro post.
En esta oportunidad utilizaremos el software &lt;code&gt;R&lt;/code&gt;. Este software posee varias
librerías o packages especializados en el cálculo de incertidumbre en
química analítica, por ejemplo: &lt;code&gt;metRology&lt;/code&gt; y &lt;code&gt;chemCal&lt;/code&gt;. En este post
utilizaremos el segundo, pues entrega en forma directa el cálculo de
la incertidumbre de calibración:&lt;/p&gt;
&lt;p&gt;&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;div&gt;
    Si no tienes instalado el package &lt;code&gt;chemCal&lt;/code&gt; utiliza el comando
&lt;code&gt;install.packages(&amp;lsquo;chemCal&amp;rsquo;)&lt;/code&gt;. Una vez instalado procede con el siguiente
código.
  &lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Creación del modelo de calibración lineal, al que llamaremos fit.lin 
# (En otro post se profundizará sobre otros modelos de calibración en R)

fit.lin &amp;lt;- lm(y ~ x, data = d)

# Simular un valor de respuesta de la muestra problema, es decir, y0.
# Sólo por conveniencia simularemos que y0 = 0.200 UA, es decir, más o menos
# en el centro de la curva:

y0 &amp;lt;- 0.200

# Cargar la librería chemCal con el comando &amp;#39;library&amp;#39;:

library(chemCal)

# Calcular la concentración de la muestra problema, x0, a partir de su señal
# instrumental y0, junto con la incertidumbre estándar de calibración u(x0) e
# incertidumbre expandida U(x0) con un 95% de confianza:

inverse.predict(fit.lin, newdata = y0)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;$Prediction
[1] 4.970492

$`Standard Error`
[1] 0.2618792

$Confidence
[1] 0.6038946

$`Confidence Limits`
[1] 4.366598 5.574387&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Bien, interpretemos la salida:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;$Prediction&lt;/code&gt; es la concentración de la muestra problema en [ppm]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$Standard Error&lt;/code&gt; es la incertidumbre estándar de calibración, es
decir, la que se obtiene de la ecuación &lt;a href=&#34;#eq:ux0&#34;&gt;(3)&lt;/a&gt; expresada,
obviamente, en las mismas unidades que los calibrantes [ppm].&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$Confidence&lt;/code&gt; es la incertidumbre expandida de calibración &lt;span class=&#34;math inline&#34;&gt;\(U(x0)\)&lt;/span&gt;, es decir,
&lt;span class=&#34;math inline&#34;&gt;\(U(x0) = k\cdot u(x0)\)&lt;/span&gt; donde &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; es el factor de cobertura con el cual se obtiene
un intervalo de incertidumbre con cierta confianza (habitualmente 95%).
Más de esto en otro post.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$Confidence Limits&lt;/code&gt; es simplemente &lt;span class=&#34;math inline&#34;&gt;\(x0 \pm U(x0)\)&lt;/span&gt;, es decir,
&lt;span class=&#34;math inline&#34;&gt;\(5 \pm 0.6\)&lt;/span&gt; ppm
(ojo con las cifras significativas… ahí va otro post).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Algunas consideraciones importantes:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Esta incertidumbre de calibración &lt;span class=&#34;math inline&#34;&gt;\(u(x0)\)&lt;/span&gt; NO incorpora la
incertidumbre de los calibrantes, sólo es un reflejo del error aleatorio
instrumental. Punto. Es decir, asume que los calibrantes no tienen
incertidumbre… lo cual todos los químicos sabemos que es ¡Farso, farso!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si Ud. requiere incorporar también la incertidumbre de los calibrantes, debe
utilizar otro modelo lineal de calibración denominado: modelo lineal con error
en ambos ejes (otro post).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ya que esta incertidumbre sólo refleja el componente aleatorio de la
calibración, no están incorporados los errores sistemáticos de la preparación
de estándares: error en el aforo, no considerar la pureza del
reactivo, etc. (Nota mental: otro post… ¿cuántos van?).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Si, además, el método analítico incluye pesada de la muestra, digestión o
extracción, aforo final, factor de dilución, etc. Ud.debe, mediante los
mandamientos de la guía GUM, combinar todas estas fuentes de incertidumbre
con la de calibración &lt;span class=&#34;math inline&#34;&gt;\(u(x0)\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;En el fondo, como se asume que los calibrantes no tienen incertidumbre,
&lt;span class=&#34;math inline&#34;&gt;\(u(x0)\)&lt;/span&gt; reflejaría el comportamiento aleatorio del instrumento cuando
se lee la curva “muchas” veces, siempre con los mismos calibrantes. En cada
oportunidad, se obtendría una pendiente e intercepto distintos (debido a al
error aleatorio &lt;span class=&#34;math inline&#34;&gt;\(\epsilon\)&lt;/span&gt;), por lo tanto, también una concentración &lt;span class=&#34;math inline&#34;&gt;\(x0\)&lt;/span&gt;
distinta cada vez.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;div&gt;
    Si está interesad@ en estimar la incertidumbre de una calibración no lineal, lo
discutimos paso a paso en el &lt;a href=&#34;https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/&#34;&gt;siguiente link.&lt;/a&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;Bueno espero que este post, en rodaje áun, haya sido de su agrado. Como siempre,
siéntase libre de criticarlo. Nos vemos.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>External Project</title>
      <link>https://www.analytical.cl/project/external-project/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/project/external-project/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Internal Project</title>
      <link>https://www.analytical.cl/project/internal-project/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/project/internal-project/</guid>
      <description>&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.&lt;/p&gt;
&lt;p&gt;Nullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.&lt;/p&gt;
&lt;p&gt;Cras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.&lt;/p&gt;
&lt;p&gt;Suspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.&lt;/p&gt;
&lt;p&gt;Aliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Natural attributes of Chilean honeys modified by the presence of neonicotinoids residues</title>
      <link>https://www.analytical.cl/publication/journal-article/</link>
      <pubDate>Tue, 01 Sep 2015 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/publication/journal-article/</guid>
      <description></description>
    </item>
    
    <item>
      <title></title>
      <link>https://www.analytical.cl/admin/config.yml</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://www.analytical.cl/admin/config.yml</guid>
      <description></description>
    </item>
    
  </channel>
</rss>
