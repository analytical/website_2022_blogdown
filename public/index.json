[{"authors":null,"categories":null,"content":"Me desempe√±o actualmente como Gestor de Calidad de Billetes y Monedas en el Banco Central de Chile.\n+18 a√±os de experiencia en proyectos de I+D relacionados con metrolog√≠a qu√≠mica y la aplicaci√≥n de m√©todos estad√≠sticos modernos en qu√≠mica anal√≠tica. Soy Profesor en los Diplomados de An√°lisis Org√°nico y Buenas Pr√°cticas de Manufactura Farmac√©utica impartidos por la Facultad de Ciencias Qu√≠micas y Farmac√©uticas de la Universidad de Chile.\nHa actuado como consultor en Validaci√≥n de Procesos Farmac√©uticos (Nota N¬∞ 4 ISP), as√≠ como auditor internacional en la norma ISO 17025.\nFui representante del SIM en el Key Comparison Working Group (KCWG) del CCQM a cargo de evaluar las Capacidades de Medici√≥n y Calibraci√≥n (CMC) de los Institutos Nacionales de Metrolog√≠a del SIM.\n  Descargar mi CV.\n","date":1441065600,"expirydate":-62135596800,"kind":"term","lang":"es","lastmod":1441065600,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"https://www.analytical.cl/author/carlos-gomez/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/carlos-gomez/","section":"authors","summary":"Me desempe√±o actualmente como Gestor de Calidad de Billetes y Monedas en el Banco Central de Chile.\n+18 a√±os de experiencia en proyectos de I+D relacionados con metrolog√≠a qu√≠mica y la aplicaci√≥n de m√©todos estad√≠sticos modernos en qu√≠mica anal√≠tica.","tags":null,"title":"Carlos G√≥mez","type":"authors"},{"authors":null,"categories":null,"content":"Âê≥ÊÅ©ÈÅî is a professor of artificial intelligence at the Stanford AI Lab. His research interests include distributed robotics, mobile computing and programmable matter. He leads the Robotic Neurobiology group, which develops self-reconfiguring robots, systems of self-organizing robots, and mobile sensor networks.\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Sed neque elit, tristique placerat feugiat ac, facilisis vitae arcu. Proin eget egestas augue. Praesent ut sem nec arcu pellentesque aliquet. Duis dapibus diam vel metus tempus vulputate.\n","date":-62135596800,"expirydate":-62135596800,"kind":"term","lang":"es","lastmod":-62135596800,"objectID":"e87efdfe209d90ea3c6332a7cbd9d08b","permalink":"https://www.analytical.cl/author/%E5%90%B3%E6%81%A9%E9%81%94/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/%E5%90%B3%E6%81%A9%E9%81%94/","section":"authors","summary":"Âê≥ÊÅ©ÈÅî is a professor of artificial intelligence at the Stanford AI Lab. His research interests include distributed robotics, mobile computing and programmable matter. He leads the Robotic Neurobiology group, which develops self-reconfiguring robots, systems of self-organizing robots, and mobile sensor networks.","tags":null,"title":"Âê≥ÊÅ©ÈÅî","type":"authors"},{"authors":null,"categories":null,"content":"   √çndice  What you will learn Program overview Courses in this program Meet your instructor FAQs    What you will learn  Fundamental Python programming skills Statistical concepts and how to apply them in practice Gain experience with the Scikit, including data visualization with Plotly and data wrangling with Pandas  Program overview The demand for skilled data science practitioners is rapidly growing. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi.\nCourses in this program  Python basics Build a foundation in Python.   Visualization Learn how to visualize data with Plotly.   Statistics Introduction to statistics for data science.   Meet your instructor Carlos G√≥mez FAQs Are there prerequisites? There are no prerequisites for the first course.\n How often do the courses run? Continuously, at your own pace.\n  Begin the course   ","date":1611446400,"expirydate":-62135596800,"kind":"section","lang":"es","lastmod":1611446400,"objectID":"59c3ce8e202293146a8a934d37a4070b","permalink":"https://www.analytical.cl/courses/example/","publishdate":"2021-01-24T00:00:00Z","relpermalink":"/courses/example/","section":"courses","summary":"An example of using Wowchemy's Book layout for publishing online courses.","tags":null,"title":"üìä Learn Data Science","type":"book"},{"authors":null,"categories":null,"content":"Build a foundation in Python.\n  1-2 hours per week, for 8 weeks\nLearn   Quiz What is the difference between lists and tuples? Lists\n Lists are mutable - they can be changed Slower than tuples Syntax: a_list = [1, 2.0, \u0026#39;Hello world\u0026#39;]  Tuples\n Tuples are immutable - they can‚Äôt be changed Tuples are faster than lists Syntax: a_tuple = (1, 2.0, \u0026#39;Hello world\u0026#39;)   Is Python case-sensitive? Yes\n","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1609459200,"objectID":"17a31b92253d299002593b7491eedeea","permalink":"https://www.analytical.cl/courses/example/python/","publishdate":"2021-01-01T00:00:00Z","relpermalink":"/courses/example/python/","section":"courses","summary":"Build a foundation in Python.\n","tags":null,"title":"Python basics","type":"book"},{"authors":null,"categories":null,"content":"Learn how to visualize data with Plotly.\n  1-2 hours per week, for 8 weeks\nLearn   Quiz When is a heatmap useful? Lorem ipsum dolor sit amet, consectetur adipiscing elit.\n Write Plotly code to render a bar chart import plotly.express as px data_canada = px.data.gapminder().query(\u0026#34;country == \u0026#39;Canada\u0026#39;\u0026#34;) fig = px.bar(data_canada, x=\u0026#39;year\u0026#39;, y=\u0026#39;pop\u0026#39;) fig.show()  ","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1609459200,"objectID":"1b341b3479c8c6b1f807553b77e21b7c","permalink":"https://www.analytical.cl/courses/example/visualization/","publishdate":"2021-01-01T00:00:00Z","relpermalink":"/courses/example/visualization/","section":"courses","summary":"Learn how to visualize data with Plotly.\n","tags":null,"title":"Visualization","type":"book"},{"authors":null,"categories":null,"content":"Introduction to statistics for data science.\n  1-2 hours per week, for 8 weeks\nLearn The general form of the normal probability density function is:\n$$ f(x) = \\frac{1}{\\sigma \\sqrt{2\\pi} } e^{-\\frac{1}{2}\\left(\\frac{x-\\mu}{\\sigma}\\right)^2} $$\n The parameter $\\mu$ is the mean or expectation of the distribution. $\\sigma$ is its standard deviation. The variance of the distribution is $\\sigma^{2}$.   Quiz What is the parameter $\\mu$? The parameter $\\mu$ is the mean or expectation of the distribution.\n","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1609459200,"objectID":"6f4078728d71b1b791d39f218bf2bdb1","permalink":"https://www.analytical.cl/courses/example/stats/","publishdate":"2021-01-01T00:00:00Z","relpermalink":"/courses/example/stats/","section":"courses","summary":"Introduction to statistics for data science.\n","tags":null,"title":"Statistics","type":"book"},{"authors":[],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\r- **Create** slides using Wowchemy\u0026#39;s [*Slides*](https://wowchemy.com/docs/managing-content/#create-slides) feature and link using `slides` parameter in the front matter of the talk file\r- **Upload** an existing slide deck to `static/` and link using `url_slides` parameter in the front matter of the talk file\r- **Embed** your slides (e.g. Google Slides) or presentation video on this page using [shortcodes](https://wowchemy.com/docs/writing-markdown-latex/).\rFurther event details, including [page elements](https://wowchemy.com/docs/writing-markdown-latex/) such as image galleries, can be added to the body of this page.\r--\r","date":1663784100,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1663784100,"objectID":"eaa2693a5e5f7f12eddd0b8f712150d3","permalink":"https://www.analytical.cl/talk/metodos-estadisticos-modernos-aplicados-en-validacion-farmaceutica/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/metodos-estadisticos-modernos-aplicados-en-validacion-farmaceutica/","section":"event","summary":"Aplicaci√≥n de m√©todos estad√≠sticos en validaci√≥n farmac√©utica con un fuerte componenete computacional usando el lenguaje R","tags":[],"title":"M√©todos Estad√≠sticos modernos aplicados en Validaci√≥n Farmac√©utica","type":"event"},{"authors":[],"categories":[],"content":"\rHace ya casi 1 a√±o publiqu√© un post acerca de cu√°ntos laboratorios de ensayo hay acreditados existen en Chile el 2021. La publicaci√≥n gener√≥ airadas reacciones, sin embargo, se abri√≥ un interesante debate (esa es la idea).\nEs tiempo de actualizar ese an√°lisis versi√≥n 2022. En esta oportunidad llevaremos a cabo el\ran√°lisis paso a paso en R bajo el concepto de Reproducible Research\nNota: Considerar que algunas razones sociales podr√≠an tener varios laboratorios/alcances\racreditados, por lo tanto, este gr√°fico en realidad cuenta el n√∫mero de acreditaciones.\r(¬øClickbait?)\nLa versi√≥n de este post es semi-autom√°tica, es decir, algunas operaciones ser√°n\rhechas a mano. Podr√≠amos aplicar web scraping y bajar los datos directamente desde la p√°gina web del INN, pero eso qudar√° para otro post (lo intuye bien querid@ lector@‚Ä¶ cuando yo aprenda a hacerlo.)\n¬øD√≥nde est√°n los datos de laboratorios acreditados por el INN?\rBueno, lo primero es dirigirnos al siguiente link para bajar los datos desde la\rp√°gina del INN (datos p√∫blicos por si acaso):\nDirectorio de Acreditados\nEn el campo Tipo de ESquema de Acreditaci√≥n seleccionamos **Laboratorios de ensayo*:\nPresionamos Buscar y obtenderemos el listado completo (incluyendo los laboratorios suspendidos):\nLamentablemente el sitio no tiene ninguna opci√≥n de bajar los datos en Excel u\rotro formato, as√≠ que tendremos que hacerlo a la antigua:\nBot√≥n derecho y se abrir√° el siguiente men√∫:\r\rElija Guardar Como y en tipo seleccione P√°gina web (completa) y gu√°rdelo\rcon el nombre acreditados.html (el nombre da igual)\r\rListo, hemos bajado los datos y ahora debemos limpiarlos pues incluso se\rdescargaron los √≠conos de los certificado en pdf. Tenemos que dejar la tabla\rlimpia para el an√°lisis en R (o para cualquier otro software)\n\rLimpieza de la base de datos en Excel\rHaremos la limpieza de datos en Excel.\nAbra Excel\rAhora abra el archivo archivados.html que guard√≥ (s√≠, Excel puede abrir este tipo de archivos) y obtendr√° algo similar a esto:\r\rEl objetivo es llegar a una hoja de Excel plana:\nSeleccionemos todos los datos inlcuyendo los encabezados de las columnas\r(N, N Certi, etc), copiar y pegar en una nueva hoja s√≥lo como datos, es decir,\rnos ubicamos en la celda A1 de la hoja nueva, presionamos bot√≥n derecho y seleccionamos\rValores (V):\r\rY obtendremos lo siguiente:\nEliminamos la columna B:\r\rHemos obtenido la tabla que busc√°bamos:\r\rLo √∫nico que nos falta es modificar un poco los encabezados para eliminar\racentos, espacios en blanco, etc. Para que Ud. pueda reproducir este an√°lisis\rcambie los encabezados por los siguientes:\r\r¬°Listo! hemos limpiado la base de datos, la cual debe lucir m√°s o menos as√≠\ren el Excel:\r\rCambiemos el nombre la hoja a datos:\r\rPor √∫ltimo guardar el libro Excel con el nombre acreditados.xlsx\r\r\rAn√°lisis estad√≠stico en R\rAbrimos el software RStudio y generamos un nuevo script:\nGuardamos el script con el nombre acreditados.R en el mismo directorio\rque guardamos la base de datos limpia acreditados.xlsx\nLos siguientes comandos importan la base de datos del INN desde el Excel hasta R:\nlibrary(readxl)\racreditados \u0026lt;- read_excel(\u0026#39;acreditados.xlsx\u0026#39;, sheet = \u0026#39;datos\u0026#39;)\rLa importaci√≥n ha sido exitosa si bserva la siguiente tabla con el comando head()\nhead(acreditados)\r# A tibble: 6 √ó 7\rN N_certificado Organizacion Tipo_de_OEC Area Observaciones Telefono\r\u0026lt;dbl\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; 1 1 LE 633 Universidad Aust‚Ä¶ Laboratori‚Ä¶ Bioe‚Ä¶ \u0026lt;NA\u0026gt; (56 65)‚Ä¶\r2 2 LE 800 Universidad de C‚Ä¶ Laboratori‚Ä¶ Bioe‚Ä¶ \u0026lt;NA\u0026gt; (56) 22‚Ä¶\r3 3 LE 893 Universidad de C‚Ä¶ Laboratori‚Ä¶ Bioe‚Ä¶ \u0026lt;NA\u0026gt; (56 65)‚Ä¶\r4 4 LE 1287 Secretaria Regio‚Ä¶ Laboratori‚Ä¶ Bioe‚Ä¶ \u0026lt;NA\u0026gt; (56 61)‚Ä¶\r5 5 LE 1450 TAAG Genetics S.‚Ä¶ Laboratori‚Ä¶ Biol‚Ä¶ \u0026lt;NA\u0026gt; (56) 22‚Ä¶\r6 6 LE 1279 Universidad de L‚Ä¶ Laboratori‚Ä¶ Bioq‚Ä¶ \u0026lt;NA\u0026gt; (56 64)‚Ä¶\rAhora haremos el gr√°fico de barras el cual indica el n√∫mero de laboratorios de\rensayo acreditados por el INN al 29 de agosto de 2022 clasificados por Area.\rPor una cuesti√≥n de espacios s√≥lo se muestran aquellas areas con m√°s de 10 laboratorios\racreditados:\nlibrary(ggplot2)\rlibrary(tidyverse)\rlibrary(magrittr)\rtabla \u0026lt;- acreditados %\u0026gt;% group_by(Area) %\u0026gt;% summarise(n = n())\rggplot(tabla %\u0026gt;% filter(n \u0026gt;= 10), aes(x = reorder(Area, n), y = n, label = n)) +\rgeom_bar(stat = \u0026#34;identity\u0026#34;, fill = \u0026#39;blue\u0026#39;, alpha = 0.7) +\rylab(\u0026#39;N¬∞ de laboratorios de ensayo\u0026#39;) +\rxlab(\u0026#39;√Årea\u0026#39;) +\rlabs(title = \u0026#34;Laboratorios de Ensayos acreditados en Chile bajo ISO 17025 por √°rea N = 804\u0026#34;,\rsubtitle = \u0026#34;Incluye 37 suspendidos. S√≥lo se muestran n \u0026gt; 10\u0026#34;,\rcaption = \u0026#34;Fuente: https://acreditacion.innonline.cl/\u0026#34;) +\rtheme_bw() +\rgeom_text(size=5,hjust=1.5, col = \u0026#39;white\u0026#39;) +\rcoord_flip()\rPara conocer el n√∫mero total de laboratorios de ensayos acreditados por el INN\ruse los siguientes comandos:\nacreditados %\u0026gt;% summarise(n = n())\r# A tibble: 1 √ó 1\rn\r\u0026lt;int\u0026gt;\r1 804\rEl siguiente paso podr√≠a ser desagregar por Organizaci√≥n de tal manera de\rdiferencias las distintas razones sociales ¬øLe parece estimad@ lector@?\nSaludos\n\r","date":1661731200,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1661786197,"objectID":"2871c8e90687554f8ea03aaae0dbdaee","permalink":"https://www.analytical.cl/post/acreditados-inn-2022/","publishdate":"2022-08-29T00:00:00Z","relpermalink":"/post/acreditados-inn-2022/","section":"post","summary":"Este post muestra el **paso a paso** del an√°lisis estad√≠stico en R, sobre los laboratorios de ensayos acreditados hasta agosto de 2022","tags":[],"title":"¬øCu√°ntos laboratorios de ensayo acreditados por el INN hay en Chile? Versi√≥n 2022","type":"post"},{"authors":[],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\r- **Create** slides using Wowchemy\u0026#39;s [*Slides*](https://wowchemy.com/docs/managing-content/#create-slides) feature and link using `slides` parameter in the front matter of the talk file\r- **Upload** an existing slide deck to `static/` and link using `url_slides` parameter in the front matter of the talk file\r- **Embed** your slides (e.g. Google Slides) or presentation video on this page using [shortcodes](https://wowchemy.com/docs/writing-markdown-latex/).\rFurther event details, including [page elements](https://wowchemy.com/docs/writing-markdown-latex/) such as image galleries, can be added to the body of this page.\r--\r","date":1660587300,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1660587300,"objectID":"622b9d708a08263ebcb47316853191f2","permalink":"https://www.analytical.cl/talk/curso-herramientas-de-diseno-e-interpretacion-estadistica-de-las-mediciones/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/curso-herramientas-de-diseno-e-interpretacion-estadistica-de-las-mediciones/","section":"event","summary":"M√©todos Estad√≠sticos modernos aplicados en Qu√≠mica Anal√≠tica","tags":[],"title":"Curso Herramientas de Dise√±o e Interpretaci√≥n Estad√≠stica de las Mediciones","type":"event"},{"authors":[],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\r- **Create** slides using Wowchemy\u0026#39;s [*Slides*](https://wowchemy.com/docs/managing-content/#create-slides) feature and link using `slides` parameter in the front matter of the talk file\r- **Upload** an existing slide deck to `static/` and link using `url_slides` parameter in the front matter of the talk file\r- **Embed** your slides (e.g. Google Slides) or presentation video on this page using [shortcodes](https://wowchemy.com/docs/writing-markdown-latex/).\rFurther event details, including [page elements](https://wowchemy.com/docs/writing-markdown-latex/) such as image galleries, can be added to the body of this page.\r--\r","date":1651395600,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1651395600,"objectID":"8ae3e9ca7a0387a848023f7260a39a74","permalink":"https://www.analytical.cl/talk/diplomado-en-metrologia/","publishdate":"2022-05-01T09:00:00Z","relpermalink":"/talk/diplomado-en-metrologia/","section":"event","summary":"Actualizaci√≥n de m√©todos estad√≠sticos de estimaci√≥n de incertidumbre de medici√≥n","tags":[],"title":"Diplomado en Metrolog√≠a","type":"event"},{"authors":[],"categories":[],"content":"\r\rEn un post anterior\rrevisamos c√≥mo estimar la incertidumbre de la concentraci√≥n\rde una muestra problema, cuando √©sta ha sido obtenida interpolando la se√±al\rinstrumental en una curva de calibraci√≥n lineal.\nLa expresi√≥n es relativamente simple y vimos tambi√©n c√≥mo podemos implementarla\ren el lenguaje de programaci√≥n R a trav√©s del package chemCal.\nSin embargo, la vida no es tan sencilla. Recoradar√° estimad@ lector@ que est√°\rbastante documentada la presencia de desviaciones de la linealidad\ra altas concentraciones, fen√≥meno muy conocido en los m√©todos\respectrofotom√©tricos (Ley de Lambert-Beer). La severidad de estas desviaciones\rvar√≠a en funci√≥n del detector, el analito y otros factores f√≠sico-qu√≠micos\rdel sistema de medici√≥n.\nCuando existen estas desviaciones y deseamos llevar a cabo un\rtest de linealidad,\res muy probable que el test rechace el modelo lineal, por lo tanto, no podemos\restimar la incertidumbre de calibraci√≥n asumiendo este modelo. Si bien es cierto\rpodemos reducir el rango lineal y diluir la muestra problema que est√° fuera\rdel rango, la operaci√≥n de diluci√≥n introduce nuevos errores (incluso errores\rhumanos de transcripci√≥n bastante frecuentes).\nUna alternativa v√°lida ser√≠a utilizar un modelo de calibraci√≥n que capture esta\rno linealidad evitando as√≠ la diluci√≥n de la muestra,\rpor lo tanto el problema se reduce a:\n\r¬øC√≥mo estimar la incertidumbre de una muestra problema que ha sido\robtenida a trav√©s de una curva de calibraci√≥n no lineal?\n\rSin embargo, de esta pregunta se desprende al mismo tiempo otra interrogante:\n\r¬øCu√°l modelo de calibraci√≥n no lineal utilizar√©?\n\rExisten varios modelos de calibraci√≥n no lineal:\nPolinomios\rNew Rational (en realidad se llaman aproximaciones de Pad√©)\rSplines\rLoess\retc.\r\rPor lo tanto, no existe una respuesta completamente correcta desde\rla prespectiva estad√≠stica, pues un modelo cuadr√°tico ser√≠a tan v√°lido como\run polinomio c√∫bico. Desde el punto de vista qu√≠mico podr√≠amos preguntarnos\r¬øqu√© sentido qu√≠mico tiene una curva de calibraci√≥n polin√≥mica de grado 5?\r¬øSon interpretables los par√°metros del modelo? En un modelo lineal como el\rde Lambert-Beer: \\(y = \\beta_{0} + \\beta_{1}x\\) la pendiente de la curva de\rcalibraci√≥n tiene una interpretaci√≥n qu√≠mica: es el producto entre coeficiente\rde extinci√≥n molar y la longitud de la celda:\n\\[\r\\underbrace{A}_\\text{y} = \\underbrace{\\epsilon \\cdot b}_\\text{$\\beta_{1}$} \\cdot\r\\underbrace{C}_\\text{x}\r\\tag{1}\r\\]\rPero recuerde este sabio consejo de un monstruo de la estad√≠stica aplicada:\n\r‚ÄúAll models are wrong, but some are useful‚Äù\r‚Äì George Box\n\rPor lo tanto, tenemos que tomar una decisi√≥n. Y obviamente, como soy el autor de\reste humilde post, ya la tom√© por Ud. En este art√≠culo estimaremos la\rincertidumbre de calibraci√≥n de un modelo polin√≥mico de grado 2, tambi√©n\rconocido como modelo cuadr√°tico.\nNota: Desde el punto de vista estrictamente estad√≠stico los modelos\rpolin√≥micos, como la calibraci√≥n cuadr√°tica, son tambi√©n modelos lineales ya que\rlos coeficientes del modelo son lineales\n\\[y = \\beta_{0} + \\beta_{1}x + \\beta_{2}x^2 + \\epsilon\\]\nEn cambio, en un modelo del tipo exponencial:\n\\[y = \\beta_{0}\\cdot e^{\\beta_{1}x}\\]\nEl coeficiente \\(\\beta_{1}\\) no es una funci√≥n lineal.\nM√©todos de estimaci√≥n de incertidumbre de calibraci√≥n\rEn este post ejemplificaremos y compararemos tres m√©todos de estimaci√≥n\rde incertidumbre de calibraci√≥n:\nNorma ISO 8466-2:2001 Water quality ‚Äì Calibration and evaluation of\ranalytical methods and estimation of performance characteristics ‚Äì Part 2:\rCalibration strategy for non-linear second-order calibration functions.\n\rM√©todo GUM\n\rM√©todo de Monte Carlo (Suplemento 1 ISO-GUM)\n\r\rImplementaremos todos los m√©todos en el lenguaje de programaci√≥n R, explicando\rpaso a paso el c√≥digo fuente con el fin de que Ud. obtenga los mismos\rresultados, es decir, un an√°lisis reproducible.\n\rDatos de calibraci√≥n\rPara ejemplificar los c√°lculos, utilizaremos los datos de calibraci√≥n indicados\ren el ejemplo de la secci√≥n 7 de la norma ISO 8466-2. El siguiente c√≥digo R\rnos permite ingresar los datos manualmente:\n# Ingresamos los datos de calibraci√≥n de la secci√≥n 7 de la norma ISO 8466-2\r# x: concentraci√≥n en mg/L\r# y: Absorbancia [UA]\rx \u0026lt;- c(12, 18, 24, 30, 36, 42, 48, 54, 60, 66)\ry \u0026lt;- c(0.083, 0.123, 0.164, 0.203, 0.240, 0.273, 0.303, 0.334, 0.364, 0.393)\rd \u0026lt;- data.frame(x, y) # creamos un data frame con las variables x e y (esto es\r# an√°logo a una matriz de datos en Excel con dos columnas)\rA continuaci√≥n graficamos la curva de calibraci√≥n con la librer√≠a ggplot2:\nlibrary(ggplot2) # cargamos la librer√≠a ggplot2\r## Warning: package \u0026#39;ggplot2\u0026#39; was built under R version 4.0.5\rtheme_set(theme_minimal()) # esto es s√≥lo por una cuesti√≥n est√©tica del gr√°fico\rggplot(d, aes(x = x, y = y)) +\rgeom_point(color = \u0026#39;red\u0026#39;) +\rxlab(\u0026#39;Concentraci√≥n [mg/L]\u0026#39;) +\rylab(\u0026#39;Absorbancia [UA]\u0026#39;)\rMmm‚Ä¶ no s√© Ud. pero yo veo una leve curvatura.\rComo lo vimos en un post anterior\rllevaremos a cabo un an√°lisis estad√≠stico b√°sico para evaluar si el modelo de ‚Ä¶","date":1591401600,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1648336325,"objectID":"1ec15bfb5c2263e79706b931cf223aea","permalink":"https://www.analytical.cl/post/incertidumbre-de-una-calibracion-no-lineal/","publishdate":"2020-06-06T00:00:00Z","relpermalink":"/post/incertidumbre-de-una-calibracion-no-lineal/","section":"post","summary":"En un post anterior\rrevisamos c√≥mo estimar la incertidumbre de la concentraci√≥n\rde una muestra problema, cuando √©sta ha sido obtenida interpolando la se√±al\rinstrumental en una curva de calibraci√≥n lineal.","tags":[],"title":"Incertidumbre de una calibraci√≥n no lineal con aplicaci√≥n en qu√≠mica anal√≠tica","type":"post"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Wowchemy Wowchemy | Documentation\n Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026#34;blueberry\u0026#34; if porridge == \u0026#34;blueberry\u0026#34;: print(\u0026#34;Eating...\u0026#34;)   Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  **Two**  Three   A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026#34;/media/boards.jpg\u0026#34; \u0026gt;}} {{\u0026lt; slide background-color=\u0026#34;#0000FF\u0026#34; \u0026gt;}} {{\u0026lt; slide class=\u0026#34;my-style\u0026#34; \u0026gt;}}   Custom CSS Example Let‚Äôs make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }   Questions? Ask\nDocumentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"https://www.analytical.cl/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Wowchemy's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":[],"categories":[],"content":"\r\rHe vuelto a postear, despu√©s de una gira que me llev√≥ por los cinco‚Ä¶\rmentira, fue por pura pega.\nEl famoso efecto matriz, algo tan et√©reo como el criterio anal√≠tico.\rEl efecto matriz est√° √≠ntimamente relacionado con las interferencias de la\rmatriz que de alguna forma aumentan o disminuyen la se√±al instrumental que,\ren teor√≠a, es producida s√≥lo por el analito de inter√©s.\nPara evaluar y detectar el efecto matriz, debemos desempolvar algunos papers\rque nos ense√±aron el famoso m√©todo de calibraci√≥n con adici√≥n conocida o\radici√≥n de est√°ndar. En este m√©todo, la matriz es nuestro\rmedio de calibraci√≥n. En vez de preparar los calibrantes en solventes puros o\ren soluci√≥n √°cida, utilizaremos la misma matriz para preparar (adicionar)\rel analito. De esta forma, la se√±al anal√≠tica de estos calibrantes, est√°\rcompuesta de la se√±al propia del analito as√≠ como tambi√©n de los\rinterferentes, lo que permite corregir/minimizar sus efectos.\nExisten varias formas de implementar el m√©todo de adici√≥n conocida. Una muy\rbuena referencia es el excelente y pedag√≥gico paper de M. Bader:\n\rMorris Bader ‚ÄúA systematic approach to standard addition methods in\rinstrumental analysis‚Äù J. Chem. Educ., 1980, 57 (10), p 703\n\rEl m√©todo consiste en a√±adir cantidades conocidas del analito en solvente\rpuro o soluci√≥n √°cida a vol√∫menes iguales de matriz. Finalmente, medir la respuesta\rinstrumental en una serie de\radiciones crecientes tal como lo muestra la figura 1:\n\rFigure 1: Dise√±o experimental de la adici√≥n conocida. Cortes√≠a de Lins4y via Wikimedia Commons\r\rEs necesario que las adiciones de analito generen, en\rconjunto con la cantidad de analito presente en la muestra original,\runa concentraci√≥n\rtal que a√∫n se encuentre en el rango lineal de calibraci√≥n. De esta forma\rse otiene una curva tal como se observa en la figura 2:\n\rFigure 2: Preparaci√≥n curva m√©todo de adici√≥n conocida\r\rLas unidades del eje \\(X\\) pueden establecerse como analito a√±adido o,\rtal como lo propone Bader en su paper, como m√∫ltiplos de un volumen\ro cantidad fija del analito. Por lo tanto, en \\(x = 0\\) se obtiene la\rse√±al de la muestra problema a la cual no se le ha agregado el\ranalito, es decir, la se√±al original. En cada una de las adiciones\rdel est√°ndar mediremos la se√±al instrumental de tal manera de\robtener, y as√≠ lo esperamos, una relaci√≥n lineal entre analito\ragregado \\(x\\) y se√±al \\(y\\) de la forma:\n\\[\\begin{equation}\ry = \\beta_{0} + \\beta_{1}x + \\epsilon\r\\tag{1}\r\\end{equation}\\]\ndonde se asumen los mismos supuestos que discutimos en el caso de la\rcalibraci√≥n lineal est√°ndar(en solvente puro) y que puede recordar en este\rpost.\nLa concentraci√≥n de la muestra problema \\(C_{0}\\) se obtiene a partir de la\recuaci√≥n (2):\n\\[\\begin{equation}\rC_{0} = \\frac{\\beta_{0}}{\\beta_{1}}\r\\tag{2}\r\\end{equation}\\]\nLa incertidumbre de la concentraci√≥n de la muestra problema \\(u(C_{0})\\) se\rcalcula a partir de la ecuaci√≥n:\n\\[\\begin{equation}\ru(C_{0}) = \\frac{\\sigma_{y/x}}{\\beta_{1}}\r\\sqrt{\\frac{1}{n} + \\frac{\\overline{y}^2}\r{\\beta_{1}\\sum_{i}^{n} (x_{i} - \\overline{x})^2}}\r\\tag{3}\r\\end{equation}\\]\ndonde:\n\r\\(\\sigma_{y/x}\\) es la desviaci√≥n est√°ndar del error aleatorio \\(\\epsilon\\)\r\\(n\\) es el n√∫mero de adiciones independientes del est√°ndar\r\\(\\overline{y}\\) es el promedio de las se√±ales instrumentales de las adiciones\r\\(\\overline{x}\\) es el promedio de las concentraciones\r\rComo puede apreciar, la expresi√≥n de la incertidumbre de calibraci√≥n para el\rm√©todo de adici√≥n conocida es muy\rsimilar a la correspondiente calibraci√≥n estandar que discutimos en un\rpost anterior.\nSi queremos minimizar esta incertidumbre podr√≠amos aumentar el n√∫mero de\radiciones \\(n\\) o aumentar el t√©rmino \\(\\sum_{i}^{n} (x_{i} - \\overline{x})^2\\).\rEste √∫ltimo t√©rmino es interesante, pues nos dice que la incertidumbre de calibraci√≥n\rde este m√©todo se minimiza utilizando un rango amplio de concentraci√≥n de\radici√≥n. Ellison demuestra que, dado que la propiedad\rde linealidad se mantiene, basta preparar dos puntos de calibraci√≥n:\n\rLa muestra original sin adici√≥n (\\(x = 0\\))\rEl extremo superior del rango lineal\r\rPor ejemplo, si por alguna raz√≥n se tuvieran que preparar \\(n = 6\\) adiciones, lo\rque indica la ecuaci√≥n (3), es que ser√≠a mejor preparar tres puntos\rsin adici√≥n (\\(x = 0\\)) y tres en el extremos superior del rango lineal, tal\rcomo lo demuestra la figura 3\n\rFigure 3: Dise√±o de una curva de calibraci√≥n con adici√≥n conocida para minimizar la incertidumbre\r\rPara evaluar estad√≠sticamente si existe un efecto matriz debemos\rcomparar la curva de calibraci√≥n est√°ndar (es decir, en solvente org√°nico o en\rsoluci√≥n √°cida) con la curva de adici√≥n conocida. Si las pendientes de ambas\rcurvas son ‚Äúiguales‚Äù podemos afirmar que no hay evidencia de efecto matriz tal\rcomo se muestra en la figura 4. De modo contrario, si las\rpendientes de ambas curvas difieren, entonces, existe un efecto matriz\rsignificativo, tal como lo indica la figura 5:\n\rFigure 4: Sin efecto matriz: calibraci√≥n est√°ndar v/s adici√≥n conocida\r\r\rFigure 5: Con efecto matriz: ‚Ä¶","date":1509494400,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1648311358,"objectID":"150a670eebd70b5b5f981daeda6c7f82","permalink":"https://www.analytical.cl/post/como-detectar-efecto-matriz-metodo-analitico/","publishdate":"2017-11-01T00:00:00Z","relpermalink":"/post/como-detectar-efecto-matriz-metodo-analitico/","section":"post","summary":"He vuelto a postear, despu√©s de una gira que me llev√≥ por los cinco‚Ä¶\rmentira, fue por pura pega.\nEl famoso efecto matriz, algo tan et√©reo como el criterio anal√≠tico.","tags":[],"title":"¬øC√≥mo detectar el efecto matriz en un m√©todo anal√≠tico?","type":"post"},{"authors":[],"categories":[],"content":"\r\rEn un post anterior vimos c√≥mo evaluar la hip√≥tesis de linealidad\rde una curva de calibraci√≥n. Propusimos dos tests estad√≠sticos formales:\nEl test de Mandel (ISO 8466-1)\rEl test de carencia de ajuste (lack-of-fit) (ISO 11095)\r\rlos cu√°les nos permiten concluir (o no) que el modelo\rlineal es adecuado o razonable para nuestros datos de calibraci√≥n.\rNada m√°s, ni nada menos. No cometa el error de afirmar que su calibraci√≥n es\rlineal, porque no existe m√©todo en el mundo que permita llegar a esa\rconclusi√≥n.\nImplementamos estos tests en lenguaje de programaci√≥n R que es, actualmente,\rla lingua franca de la estad√≠stica, big data, data science y toda esa\rpirotecnia. Sin embargo, tambi√©n es posible implementar f√°cilmente\restos tests en el viejo y querido, pero a veces vapuleado por la comunidad\rEstad√≠stica, Excel. Obviamente,\rno existe el comando test.de.linealidad, por lo tanto, tendremos que\r‚Äúhacerlo a mano‚Äù.\nEn este post implementaremos el Test de Mandel, cuyos detalles puede\rconsultar aqu√≠. El test de carencia de ajuste lo veremos en otro post.\nTest de Mandel en Excel\rEn primer lugar necesitaremos, obviamente, los datos de calibraci√≥n.\rEstos se muestran en Excel en la siguiente figura:\r\rLa gr√°fica de esta calibraci√≥n se presenta a continuaci√≥n. Note la\revidente no linealidad a alta concentraci√≥n.\nBien, como Ud.recordar√° del post sobre linealidad, para aplicar el test de Mandel debemos\rajustar dos modelos: un modelo lineal y otro no lineal. Mencionamos que para\rdarle sentido\rqu√≠mico-anal√≠tico ajustamos un modelo ‚Äúno lineal‚Äù cuadr√°tico. Yo s√© que la\rtentaci√≥n\res grande para aplicar el bot√≥n derecho y Ajustar l√≠nea de tendencia, pero\rmantengamos la calma. Lo haremos de otra forma.\n\rPara ajustar un modelo cuadr√°tico en Excel hay varias formas, pero en este\rpost utilizaremos las herramientas del men√∫ An√°lisis de datos:\n\r\rComo ajustaremos un modelo cuadr√°tico, necesitamos incorporar la\rvariable \\(X^2\\). Esto es muy sencillo, debemos ubicarnos\ren la columna B (donde est√° la \\(Y\\)), presionar bot√≥n derecho y seleccionar\rInsertar, lo cual generar√° una columna vac√≠a entre \\(X\\) e \\(Y\\) tal\rcomo se muestra en la siguiente figura:\r\rA esta nueva columna la llamaremos X^2, y generaremos los valores\rcorrespondientes en la celda B2con la f√≥rmula =A2^2:\nCopiamos la f√≥rmula hasta la celda B12:\nAhora ajustaremos el modelo cuadr√°tico. Seleccionemos el men√∫ Datos de\rla cinta de herramientas, el cual mostrar√° a la derecha el men√∫\rAn√°lisis de datos, hacemos clic y se abrir√° el siguiente cuadro:\r\rSeleccionamos la opci√≥n Regresi√≥n, con lo que se abrir√° el siguiente\rdi√°logo:\nEn Rango Y de entrada presionamos la flecha negra que apunta hacia arriba\ry seleccionamos con el mouse los datos de \\(Y\\), incluyendo la letra \\(Y\\),\rluego presionamos la flecha que apunta hacia abajo:\nEn Rango X de entrada presionamos la flecha negra que apunta hacia arriba\ry seleccionamos con el mouse las dos columnas: \\(X\\) y \\(X^2\\),\rincluyendo las etiquetas, luego presionamos la flecha que apunta hacia abajo:\nChequeamos los cuadritos R√≥tulosy Nivel de confianza.\n Jam√°s chequee el cuadrito Constante igual a cero, a menos que haya demostrado previamente esta hip√≥tesis   En Opciones de salida seleccionamos en Rango de salida la celda\rE1 (en realidad da igual, es para que tengamos la misma salida).\n¬°Listo! Por ahora no usaremos las otras opciones.\nPresiones Aceptary aparecer√° el an√°lisis estad√≠stico a partir de la\rcelda E1:\r\rNo nos detendremos a explicar toda la informaci√≥n estad√≠stica de\rlas tablas, iremos\rdirectamente al grano: al test de linealidad de Mandel. Ubique en la tabla\rinferior la fila de la variable X^2 y la columna respectiva denominada\rProbabilidad. En este ejemplo marqu√© con rojo la celda del test de Mandel:\r\r8. Esta celda representa el p-value del test de Mandel. En este ejemplo\rel p-value = \\(3,6\\times 10^{-11}\\), es decir,\rbajo la interpretaci√≥n tradicional\rde las pruebas de hip√≥tesis, ya que p-value \\(\u0026lt; 0,05\\)\rconcluir√≠amos que el modelo lineal no es adecuado o razonable para modelar\rlos datos de calibraci√≥n.\nBueno, queridos lectores espero les haya gustado. Como siempre,\rpueden dejar sus comentarios/cr√≠ticas y sugerencias aqu√≠ abajo.\rHasta la pr√≥xima.\n\r","date":1506556800,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1648310887,"objectID":"ec8ae837a2cc28e87556f8e444761071","permalink":"https://www.analytical.cl/post/prueba-de-linealidad-de-una-curva-de-calibracion-en-excel/","publishdate":"2017-09-28T00:00:00Z","relpermalink":"/post/prueba-de-linealidad-de-una-curva-de-calibracion-en-excel/","section":"post","summary":"En un post anterior vimos c√≥mo evaluar la hip√≥tesis de linealidad\rde una curva de calibraci√≥n. Propusimos dos tests estad√≠sticos formales:\nEl test de Mandel (ISO 8466-1)\rEl test de carencia de ajuste (lack-of-fit) (ISO 11095)\r\rlos cu√°les nos permiten concluir (o no) que el modelo\rlineal es adecuado o razonable para nuestros datos de calibraci√≥n.","tags":[],"title":"Prueba de linealidad de una curva de calibraci√≥n en Excel... S√≠ ¬°En Excel!","type":"post"},{"authors":[],"categories":[],"content":"\r\r\rEn el\rpost anterior\rdescribimos brevemente en qu√© consiste el m√©todo de\rMonte Carlo y c√≥mo utilizarlo para estimar la incertidumbre de medici√≥n.\rFinalizamos comparando la estimaci√≥n de acuerdo a la gu√≠a GUM con el m√©todo de\rMonte Carlo siguiendo estrictamente las directrices del test de diferencias\rnum√©ricas propuesto por el Suplmento 1 de la GUM.\nLlevamos a cabo el test de validaci√≥n ‚Äúa mano‚Äù, es decir, ingresamos\rtodas las instrucciones en c√≥digo R. Si bien no fue dif√≠cil, existen librer√≠as\respecializadas en R que permiten realizar todos los c√°lculos de\rincertidumbre y validarlos utilizando funciones ya incorporadas.\nEn Rexisten dos librer√≠as especializadas en c√°lculo de incertidumbre de\rm√©todos de medici√≥n f√≠sico-qu√≠micos:\n\rmetRology desarrollada en conjunto entre los Institutos Nacionales de\rMetrolog√≠a del Reino Unido (LGC) y de Estados Unidos (NIST). Es mantenida\rpor Steve Ellison, el autor de la gu√≠a GUM. Puede encontrar m√°s informaci√≥n\raqu√≠.\n\rpropagate desarrollada por Andrej-Nikolai Spiess\n\r\rMe inclinar√© por metRology principalmente porque tiene el soporte de los\rdos centros de metrolog√≠a m√°s imporantes a nivel mundial y, ya que fue\rdesarrollada en sus inicios por Steve Ellison, tiene un peque√±o sesgo hacia la\rmetrolog√≠a qu√≠mica.\nEjemplo de validaci√≥n de c√°lculos con librer√≠a metRology\rDesarrollaremos un ejemplo m√°s extenso sobre c√°lculo de incertidumbre en\rqu√≠mica anal√≠tica utilizando esta librer√≠a. Iremos paso a paso, cualquier\rduda en la implementaci√≥n nada m√°s escr√≠bala en los comentarios m√°s\rabajo. Sin embargo, no detallaremos c√≥mo obtener las incertidumbres de\rcada uno de los factores involucrados en la ecuaci√≥n de medici√≥n, sino\rque simplemente ser√° un dato conocido para este ejemplo. En\run futuro post, desarollaremos un ejemplo completo de principio a fin, por ahora\rnos centraremos en utilizar metRologycomo herramienta pr√°ctica.\nEn este ejemplo, calcularemos la incertidumbre de un m√©todo de determinaci√≥n\rde cobre en mineral de cobre, con digesti√≥n √°cida y cuantificaci√≥n mediante\respetroscop√≠a de abosrci√≥n at√≥mica AAS. Los detalles del m√©todo anal√≠tico\rest√°n fuera del alcance de este post, pero pueden ser consultados en la\rnorma chilena NCh 3392:2016.\n\rSeguiremos estrictamente las directrices de la GUM, por lo tanto, queda\rfuera de esta evaluaci√≥n cualquier correcci√≥n de sesgo y/o recuperaci√≥n. La\rdiscusi√≥n sobre si se debiera, o no, incorporar el sesgo en la incertidumbre\res un tema que abordaremos en otro post.\n\rEl primer paso para estimar la incertidumbre de este m√©todo es escribir la\recuaci√≥n de medici√≥n:\r\r\\[\\begin{equation}\r\\text{Cu}[\\text{%}]=\\frac{\\text{C}_{\\text{calib}}\\cdot V \\cdot D}{m\\cdot 10000}\r\\tag{1}\r\\end{equation}\\]\ndonde \\(\\text{C}_{\\text{calib}}\\) es la concentraci√≥n de la muestra digerida\rinterpolada en la curva de calibraci√≥n \\([\\mu\\text{g}\\,\\text{mL}^{-1}]\\), \\(m\\) es\rla masa de la muestra [g], \\(V\\,[\\text{mL}]\\) es el volumen del aforo final y \\(D\\)\res un factor de diluci√≥n volum√©trico, utilizado cuando es necesario. Para\rsimplificar el problema, asumiremos que no hay diluci√≥n antes de la lectura\rpor AAS, por lo tanto, \\(D = 1\\) y \\(u_{D} = 0\\).\nIdentificaci√≥n de las fuentes de incertidumbre\r\rA continuaci√≥n se enumeran las fuentes de incertidumbre asociadas a cada uno de\rlos factores de la ecuaci√≥n (1) y se describe brevemente los\rm√©todos estad√≠sticos y de juicio experto utilizados para obtener las\rincertidumbres\rest√°ndar correpospondientes:\n\r\\(\\text{C}_{\\text{calib}}\\): La incertidumbre est√°ndar de la concentraci√≥n de\runa muestra problema \\(u_{\\text{C}_\\text{calib}}\\) obtenida de una curva de\rcalibraci√≥n\rlineal \\(y = a + bx\\) es calculada a partir de la siguiente expresi√≥n:\r\r\\[\\begin{equation}\ru_{\\text{C}_{\\text{calib}}}=\\frac{s_{y/x}}{b}\\sqrt{\\frac{1}{m}+\\frac{1}{n}+\r\\frac{(C_{\\text{calib}}-\\overline{C})^2}{\\sum(C_{i}-\\overline{C})^2}}\r\\label{eq:ucurva}\r\\end{equation}\\]\ndonde \\(s_{y/x}\\) es la desviaci√≥n est√°ndar de la regresi√≥n, \\(m\\) es el n√∫mero de\rreplicados independientes de la muestra problema efectivamente analizados, \\(n\\)\res el n√∫mero de calibrantes, \\(C_{\\text{calib}}\\) es la concentraci√≥n de la\rmuestra problema obtenida por interpolaci√≥n en la curva de calibraci√≥n,\r\\(\\overline{C}\\)\res el promedio de la concentraciones de los calibrantes. Estos par√°metros pueden\rser obtenidos directamente del an√°lisis estad√≠stico de la curva de calibraci√≥n\rlineal. Cabe destacar que cuando se utiliza el m√©todo de m√≠nimos cuadrados\rordinarios para estimar la pendiente e intercepto de la curva, esta metodolog√≠a\rno incorpora la incertirtumbre de la concentraci√≥n de los calibrantes.\n Puede profundizar sobre la incertidumbre de calibraci√≥n en el siguiente post   \r\\(V\\): La incertidumbre del volumen de aforo \\(u_{\\text{V}}\\) es estimada a partir\rde la combinaci√≥n de tres fuentes:\n\r\\(u_{\\text{tol}}\\) La incertidumbre informada por el fabricante en el\rcertificado original del lote de producci√≥n o aquella impresa en el material\rde vidrio. Esta incertidumbre es de Tipo B. ‚Ä¶","date":1506124800,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1648310152,"objectID":"5e17606d9550082f426c3123029f9d6d","permalink":"https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/","publishdate":"2017-09-23T00:00:00Z","relpermalink":"/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo-parte2/","section":"post","summary":"En el\rpost anterior\rdescribimos brevemente en qu√© consiste el m√©todo de\rMonte Carlo y c√≥mo utilizarlo para estimar la incertidumbre de medici√≥n.\rFinalizamos comparando la estimaci√≥n de acuerdo a la gu√≠a GUM con el m√©todo de\rMonte Carlo siguiendo estrictamente las directrices del test de diferencias\rnum√©ricas propuesto por el Suplmento 1 de la GUM.","tags":[],"title":"Validaci√≥n de los c√°lculos de incertidumbre en qu√≠mica anal√≠tica con el m√©todo Monte Carlo. Parte II","type":"post"},{"authors":[],"categories":[],"content":"\r\rDe acuerdo al numeral 8.1 del Suplemento 1 de la gu√≠a GUM,\rel m√©todo de Monte Carlo es un m√©todo general para estimar la incertidumbre de\rmedici√≥n y puede, bajo ciertas directrices, validar los c√°lculos realizados\rcon el m√©todo GUM. En este post asumiremos que Ud.,\resimado lector, est√° familiarizado con el m√©todo GUM y ya lo tiene implementado\r, por ejemplo, en una hoja Excel y le gustar√≠a validar\rsus c√°lculos mediante un\rm√©todo totalmente independiente y m√°s general. De esta forma podr√° cumplir\rcabalmente con el siguiente numeral de la norma 17025:\n\r5.4.7.1 Los c√°lculos y la transferencia de los datos deben estar sujetos a\rverificaciones adecuadas llevadas a cabo de una manera sistem√°tica.\n\r¬øC√≥mo sabe Ud. que su implementaci√≥n en Excel est√° correcta?\n¬øQu√© es el m√©todo de Monte Carlo?\r(Aqu√≠ podr√≠a hacer copy-paste de Wikipedia‚Ä¶no olvidar borrar esta nota interna)\nMuy sucintamente, el m√©todo de Monte Carlo es un m√©todo num√©rico que permite\revaluar expresiones matem√°ticas complejas (muy complejas, cr√©ame) mediante la\rsimulaci√≥n de n√∫meros aleatorios.\rEste post no pretende profundizar en la teor√≠a de este m√©todo (ZzzZzz‚Ä¶) , sino\rm√°s bien dar ejemplos concretos aplicados en qu√≠mica anal√≠tica, por lo tanto,\res posible que un avezado estad√≠stico computacional le d√© un infarto al leer la\rsoltura con la cual me expreso y lo ineficiente del c√≥digo R. El objetivo\res simplemente la divulgaci√≥n a la comunidad qu√≠mico-anal√≠tica para\rabordar algunos puntos normativos de la 17025 y gu√≠a GUM.\nVeamos un ejemplo sencillo. Supongamos que necesitamos calcular la\rincertidumbre de la\rsuma de 2 variables aleatorias\rnormales independientes, y que poseen\nla misma media (\\(\\mu\\)) y varianza (\\(\\sigma^2\\)), es decir,\rsi \\(Z = X + Y\\) ¬øCu√°l es la incertiumbre de \\(Z\\)? (\\(u_{Z}\\))\nSi Ud. recuerda de sus cursos de probabilidades, este problema tiene una soluci√≥n\rdirecta y sencilla:\n\\[\\begin{eqnarray}\rV(Z) \u0026amp;=\u0026amp; V(X) + V(Y) \\\\\rV(Z) \u0026amp;=\u0026amp; \\sigma^2 + \\sigma^2 \\\\\rV(Z) \u0026amp;=\u0026amp; 2\\sigma^2\r\\end{eqnarray}\\]\ndonde \\(V()\\) denota varianza. Por lo tanto, la incertidumbre de Z es\r\\(u_{Z} = \\sqrt{V(Z)} = \\sqrt{2}\\sigma\\). Si Ud, conoce \\(\\sigma\\), es decir,\rla incertidumbre est√°ndar de \\(X\\) e \\(Y\\), el problema est√° resuelto.\rEn realidad, este ejemplo es bastente general y las distribuciones ni siquiera\rtienen que ser las mismas, bajo ciertas condiciones, esto se cumplir√°.\nPero supongamos que, repentinamente, Ud. olvid√≥ todo lo aprendido en esas\restimulantes clases de probabilidades con 33¬∞C y\rsin aire acondicionado. No se\rpreocupe, obtendremos la incertidumbre de Z sin recurrir a ninguna propiedad\rte√≥rica de las varianzas. Usareemos el m√©todo de Monte Carlo,\rpara lo cual debemos\rhacer lo siguiente:\nAsigne a cada variable, en este caso \\(X\\) e \\(Y\\), una distribuci√≥n de\rprobabilidad de acuerdo a la informaci√≥n que disponga hasta ese momento.\rEn nuestro ejemplo tanto \\(X\\) como \\(Y\\) son normales con\rla misma media (\\(\\mu\\)) y desviaci√≥n est√°ndar (\\(\\sigma\\)). Sin p√©rdida de\rgeneralidad, diremos que ambas variables \\(X\\) e \\(Y\\) son normales con media\r\\(\\mu = 100\\) y desviaci√≥n est√°ndar \\(\\sigma = 5\\).\n\rDe cada variable genere un valor aleatorio. Es decir, en nuestro ejemplo\rdebemos generar un n√∫mero aleatorio para \\(X\\) y otro para \\(Y\\) a partir de sus\rrespectivas distribuciones de probabilidad asignadas, que en este caso es la\rmisma. Haremos esto en lenguaje R:\n\r\r# Generamos n = 1 n√∫mero aletorio para X a partir de una\r# distribuci√≥n Normal con media 100 y desviaci√≥n est√°ndar 5\rX \u0026lt;- rnorm(1, 100, 5) # Generamos n = 1 n√∫mero aletorio para Y a partir de una\r# distribuci√≥n Normal con media 100 y desviaci√≥n est√°ndar 5\rY \u0026lt;- rnorm(1, 100, 5) \rEn esta primera simulaci√≥n obtuvimos \\(X = 97.1976218\\) e \\(Y = 98.8491126\\).\nCalcule la variable de inter√©s con los datos simulados. En el ejemplo,\r\\(Z = X + Y = 97.1976218 + 98.8491126= 196.0467343\\)\n\rRepita los pasos 2 y 3 \\(n\\) veces y obtenga la distribuci√≥n emp√≠rica de \\(Z\\).\n\rA partir de los \\(n\\) datos simulados de \\(Z\\), estime \\(u_{Z} = s_{Z}\\), es decir,\rla desviaci√≥n est√°ndar muestral de los \\(n\\) datos.\n\r\rHay varias formas de implementar todos estos pasos\ren R, la m√°s intuitiva (creo yo) es la siguiente:\nn \u0026lt;- 1000 # Obtendremos n = 1000 datos aleatorios para X e Y\rmu \u0026lt;- 100 # Media mu = 100\rs \u0026lt;- 5 # Desviaci√≥n estandar s = 5\rX \u0026lt;- rnorm(n, mu, s) # 1000 datos aleatorios de una normal con par√°metros mu y s\rY \u0026lt;- rnorm(n, mu, s) # 1000 datos aleatorios de una normal con par√°metros mu y s\rZ \u0026lt;- X + Y # Para cada uno de los 1000 datos de X e Y, calculamos Z\ruZ \u0026lt;- sd(Z) # La incertidumbre est√°ndar de Z es la desviaci√≥n est√°ndar de las\r# n = 1000 simulaciones\rEn nuestro ejemplo, la incertidumbre est√°ndar por Monte Carlo es de\r\\(u_{Z}^{MC} = 7.4\\). ¬øQu√© nos dec√≠a la teor√≠a? Que\r\\(u_{Z} = \\sqrt{2}\\sigma = \\sqrt{2}\\cdot 5 = 7.1\\)\nOjal√° todo fuera tan f√°cil. El ejemplo era muy sencillo y la\rsoluci√≥n es conocida en forma te√≥rica.\rLa vida del qu√≠mico anal√≠tico es extremadamente compleja (en todo $entido),\ry no siempre ‚Ä¶","date":1505174400,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1648309059,"objectID":"8bace865696a33e51a26da1b244905b4","permalink":"https://www.analytical.cl/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/","publishdate":"2017-09-12T00:00:00Z","relpermalink":"/post/validacion-calculos-incertidumbre-quimica-analitica-metodo-monte-carlo/","section":"post","summary":"De acuerdo al numeral 8.1 del Suplemento 1 de la gu√≠a GUM,\rel m√©todo de Monte Carlo es un m√©todo general para estimar la incertidumbre de\rmedici√≥n y puede, bajo ciertas directrices, validar los c√°lculos realizados\rcon el m√©todo GUM.","tags":[],"title":"Validaci√≥n de los c√°lculos de incertidumbre en qu√≠mica anal√≠tica con el m√©todo Monte Carlo. Parte I","type":"post"},{"authors":[],"categories":[],"content":"\r\rBueno, aqu√≠ va la primera piedra:\n\rNo existen datos experimentales normales\n\rSus datos obtenidos en el laboratorio no ‚Äúsiguen‚Äù ninguna distribuci√≥n de\rprobabilidad. La naturaleza no ‚Äúsigue‚Äù ninguna distribuci√≥n de probabilidad.\n\rLa Normalidad es s√≥lo una abstracci√≥n, es un modelo matem√°tico\rde un fen√≥meno aleatorio.\n\rY como todo modelo, podr√≠a ser razonable para un conjunto de datos y totalmente\requivocado para otro. Somos nosotros, los qu√≠micos/cient√≠ficos, quienes\rproponemos modelos del sistema que estamos estudiando y a trav√©s de la\rexperimentaci√≥n corroboramos o no estos modelos.\nTodos los tests estad√≠sticos formales para evaluar la normalidad tampoco\rresponden en forma 100% certera si esta hip√≥tesis es v√°lida, pues\rest√°n afectos a los errores de tipo falso positivo (I) y falso negativo (II).\rPor lo tanto, las pruebas estad√≠sticas en la pr√°ctica no confirman que los\rdatos experimentales sean Normales, sino que nos indican si el modelo Normal\res razonable o no. Si lo es, actuamos como si ‚Äúfuesen‚Äù normales y hacemos\rinferencia estad√≠stica a partir de las propiedades de la Normal.\nEl modelo Normal se describe en la ecuaci√≥n (1) y la figura\r1 muestra la archiconocida forma de campana:\n\\[\\begin{equation}\rf(x) = \\frac{1}{\\sigma \\sqrt{2\\pi}}\\exp{-\\frac{1}{2}\\left(\\frac{x - \\mu}{\\sigma}\\right)^2}\r\\tag{1}\r\\end{equation}\\]\ndonde \\(\\sigma\\) y \\(\\mu\\) son la desviaci√≥n est√°ndar y media, respectivamente.\rNotar que la distribuci√≥n Normal es aplicable s√≥lo a variables continuas,\rtales como concentraci√≥n, temperatura, masa, etc. No se puede aplicar\rla distribuci√≥n normal a variables discretas como cuentas de c√©lulas bajo\run campo de microscopio, por ejemplo. Quiz√°s alg√∫n microbi√≥logo est√°\rfamiliarizado con el uso de logaritmos en sus c√°lculos de incertidumbre, bueno,\res porque se utilizan otros modelos de probabilidad para datos discretos (ufc),\rcomo el modelo Poisson.\nAdvierta tambi√©n, que los posibles valores que puede tomar la variable \\(X\\)\rest√°n en el no despreciable rango entre \\(-\\infty\\) y \\(+\\infty\\). ¬øHa comprado\ralg√∫n est√°ndar de calibraci√≥n cuyo certificado indique una\rpureza de \\(99.7 \\pm 0.5\\) %? Raro ¬øno? Bueno, pues el proveedor ha aplicado\requivocadamente la distribuci√≥n Normal a una variable que no es Normal: pureza\rqu√≠mica. En efecto, desde el punto de vista qu√≠mico la pureza est√° confinada\ral intervalo \\([0, 100]\\) %, por lo tanto, no tiene sentido qu√≠mico un certificado\rque indique \\(99.7 \\pm 0.5\\) %. Para modelar pureza qu√≠mica es necesario utilizar\runa distribuci√≥n de probabilidad que est√© restringida al intervalo \\([0, 100]\\) %\r(o \\([0, 1]\\)) como, por ejemplo, la distribuci√≥n Beta.\n\rFigure 1: Distribuci√≥n Normal con media = 0 y sd = 1\r\rExisten varios test para evaluar la palusibilidad de la normalidad de los datos,\rpero en este post discutiremos s√≥lo dos de ellos: El test de Shapiro-Wilk y el\rTest de Anderson-Darling.\nLa matem√°tica detr√°s de estos tests no es muy digerible, por lo que simplemente\rlos ejemplificaremos con algunos datos reales y simulados. La ventaja de\rusar simulaciones es que ‚Äúcreamos‚Äù artificialmente datos de la distribuci√≥n\rque se nos plazca y as√≠ verificar el desempe√±o de estos tests. Si recuerda, ya\rhab√≠amos utilizado la simulaci√≥n cuando revisamos las pruebas de linealidad\ren este post.\n\rAntes de hacer cualquier prueba estad√≠stica de normalidad grafique los datos,\ra trav√©s de un histograma y un gr√°fico de probabilidad Normal\n\rEstos gr√°ficos le dar√°n una primera aproximaci√≥n para evaluar el supuesto de\rnormalidad. Todos los softwares estad√≠sticos incorporan estos gr√°ficos.\rA continuaci√≥n los veremos en acci√≥n en datos normales simulados en\rlenguaje R, qu√© otro. El siguiente es el c√≥digo para llevar a cabo esta\rsimulaci√≥n de \\(n = 100\\) datos normales:\nset.seed(123) # Con este comando nos aseguramos de generar siempre\r# los mismos datos aleatorios. Sino, obviamente, todos\r# generar√≠amos n√∫meros distintos pues son aleatorios ¬øno?\rn \u0026lt;- 100 # N√∫mero de datos a simular\rmu \u0026lt;- 10 # Media de los n = 100 datos\rsigma \u0026lt;- 1 # Desviaci√≥n est√°ndar de los n = 100 datos\r# Genera 100 dato normales con media mu y desviaci√≥n est√°ndar sigma\r# y gu√°rdalos en el vector llamado x\rx \u0026lt;- rnorm(n, mu, sigma)\rAl calcular la media y desviaci√≥n est√°ndar (muestral) de estos datos obtenemos\r\\(\\overline{x} = 10.1\\) y \\(s = 0.9\\) ‚Äú¬øPero c√≥mo?\r¬øNo hab√≠amos simulado una media de 10 y desviaci√≥n est√°ndar 1?\rEsto es una estafa‚Äù Keep calm recuerde que son aleatorios.\rLa figura 2 muestra a la izquierda el histograma y a la derecha\rel gr√°fico de normalidad (QQ-Plot) de los datos simulados:\n\rFigure 2: Izquierda histograma, derecha gr√°fico de normalidad\r\rEl histograma muestra esa forma de campana caracter√≠stica de la distribuci√≥n\rnormal. Quiz√°s no conozca el gr√°fico de probabilidad normal o QQ-Plot, pero\res la primera evidencia que un estad√≠stico revisa para evaluar la hip√≥tesis de\rnormalidad. Note que la ‚Äúmayor√≠a‚Äù de los datos est√° sobre una l√≠nea diagonal roja,\rcuando Ud. observe este patr√≥n podr√≠a concluir que ‚Ä¶","date":1504828800,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1648308605,"objectID":"ed427dbd0c28d257b136e25d88559d33","permalink":"https://www.analytical.cl/post/mis-datos-no-son-normales/","publishdate":"2017-09-08T00:00:00Z","relpermalink":"/post/mis-datos-no-son-normales/","section":"post","summary":"Bueno, aqu√≠ va la primera piedra:\n\rNo existen datos experimentales normales\n\rSus datos obtenidos en el laboratorio no ‚Äúsiguen‚Äù ninguna distribuci√≥n de\rprobabilidad. La naturaleza no ‚Äúsigue‚Äù ninguna distribuci√≥n de probabilidad.","tags":[],"title":"¬°Mis datos no son normales! ¬øQu√© hago?...C√°lmese, nunca lo fueron... ni lo ser√°n","type":"post"},{"authors":[],"categories":[],"content":"\r\r\rUn d√≠a cualquiera en un laboratorio que a√∫n no establece criterios de aceptaci√≥n\rde precisi√≥n:\n\rDuplicado 1 = 25.56 % Cu\rDuplicado 2 = 25.66 % Cu\rDiferencia = 0.10 % Cu\r\rLa diferencia observada ¬øes aceptable para el laboratorio?\nPara responder a esta pregunta debemos considerar varias cosas:\n¬øLos duplicados fueron realizados en condiciones de repetibilidad o\rreproducibilidad?\r¬øExiste alguna normativa al respecto que se deba cumplir?\r¬øCu√°l es la metodolog√≠a anal√≠tica? No es lo mismo determinar Cu en\rconcentrado de cobre por electrogravimetr√≠a (m√©todo primario) que por\rFluorescencia de Rayos X.\r¬øCu√°l es la incertidumbre del m√©todo anal√≠tico?\r¬øExiste alg√∫n acuerdo a nivel comercial sobre estas diferencias?\r\rPara abordar este problema tendremos que hace la suposici√≥n que\rlos duplicados fueron obtenidos en condiciones de repetibilidad, es decir: mismo\ranalista, mismo d√≠a, mismo instrumento, etc. Bajo esta premisa hay varias formas\rde estimar la m√°xima diferencia tolerable entre duplicados de an√°lisis.\nNota: En realidad, los conceptos que mostraremos a continuaci√≥n son\rcompletamente an√°logos para estimar la m√°xima diferencia tolerable en\rcondiciones de reproducibilidad. Sin embargo, dedicaremos otro post a ese tema\respec√≠fico.\nEl concepto estad√≠stico clave para establecer la tolerancia entre duplicados\res el l√≠mite de repetibilidad \\(r\\).\nL√≠mite de repetibilidad \\(r\\) ISO 5725\rLa gu√≠a ISO 5725 define el l√≠mite de repetibilidad \\(r\\) de la siguiente manera:\n\\[\rr = 2.8\\cdot s_{r}\r\\]\ry corresponde a la m√°xima diferencia, en valor absoluto, que puede\rtolerarse entre duplicados de an√°lisis, obtenidos bajo condiciones de\rrepetibilidad con un 95% de confianza. Veamos:\n\r\\(s_{r}\\) es la desviaci√≥n est√°ndar de repetibilidad, la cual da cuenta de\rla dispersi√≥n de las diferencias entre duplicados. Ya explicaremos c√≥mo\rcalcular este par√°metro.\n\rEl factor 2.8: aqu√≠ les exijo una prueba de fe mis hermanos, me tienen que\rcreer porque si quieren la demostraci√≥n, aumentar√≠a mucho la viscosidad\rde este post . A grosso modo, el factor\r2.8 tiene que ver con el 95% de confianza, nos indica que cuando se establece\rla m√°xima diferencia\rtolerable, est√° permitido que el 5% de los duplicados est√©n fuera del\rl√≠mite \\(r\\), y a√∫n el\rsistema anal√≠tico se encontrar√≠a bajo Control Estad√≠stico.\n\r\r\r¬øC√≥mo obtenemos la precisi√≥n de repetibilidad \\(s_{r}\\)?\rExisten varios m√©todos estad√≠sticos para abordar la estimaci√≥n de la\rdesviaci√≥n est√°ndar de repetibililidad \\(s_{r}\\), sin embargo, en este post\rnos enfocaremos en los dos m√°s utilizados en qu√≠mica anal√≠tica:\nEstimaci√≥n basada en el registro hist√≥rico de duplicados de an√°lisis.\n\rLa estimaci√≥n mediante estudios de precisi√≥n siguiendo las directrices de la\rgu√≠a ISO 5725.\n\r\rNo describiremos todos los detalles de cada uno de los dise√±os experimentales\rexpuestos en estas gu√≠as, m√°s bien, ejemplificaremos el c√°lculo de la desviaci√≥n\rest√°ndar de repetibilidad \\(s_{r}\\):\n\rM√©todo de estimaci√≥n en base a datos hist√≥ricos de duplicados\rObviamente necesitamos crear una base de datos con los registros de an√°lisis\rde muestras en duplicados en condiciones de repetibilidad. Estas muestras\rpueden corresponder a muestras de clientes, materiales de referencia primarios\ro secundarios, muestras control, etc. Lo importante es que ambos duplicados\rcumplan con las condiciones de repetibilidad. La tabla 1 es un\rejemplo de una base de datos a utilizar en este m√©todo:\n\rTable 1: Base de datos hist√≥rica de duplicados (s√≥lo los primeros 6 datos)\r\r\r\rID\r\rDuplicado 1\r\rDuplicado 2\r\r\r\r\r\rQAQC-01\r\r30.79\r\r30.54\r\r\r\rQAQC-02\r\r31.89\r\r32.04\r\r\r\rQAQC-03\r\r31.28\r\r31.32\r\r\r\rQAQC-04\r\r31.30\r\r30.89\r\r\r\rQAQC-05\r\r30.70\r\r30.66\r\r\r\rQAQC-06\r\r30.86\r\r30.69\r\r\r\r\rPuede descargar esta base de datos desde este link.\rY ahora la pregunta del mill√≥n:\r¬øCu√°ntas muestras en duplicado necesito? Si bien es posible obtener un c√°lculo\r‚Äúexacto‚Äù del n√∫mero de muestras \\(n\\), esto est√° fuera del alcance de este post.\rSin embargo, podemos decir que \\(n \u0026gt; 25\\) es un n√∫mero inicial adecuado.\nUna vez construida la base de datos, se puede obtener una estimaci√≥n de \\(s_{r}\\)\rmediante la ecuaci√≥n (1):\n\\[\\begin{equation}\rs_{r} = \\sqrt{\\frac{\\sum_{i = 1}^{n} (x_{i1} - x_{i2})^2}{2n}}\r\\tag{1}\r\\end{equation}\\]\nEsta ecuaci√≥n puede ser f√°cilmente implementada en Excel pero en este post,\rcomo no, haremos los c√°lculos en lenguaje R. Pero antes, observe la figura\r1 la cual muestra un gr√°fico de dispersi√≥n entre Duplicado 1 (\\(X\\))\ry Duplicado 2 (\\(Y\\)). En este caso el orden es irrelevante. Si ajust√°ramos un\rmodelo lineal entre ambas variables ¬øQu√© valores de pendiente e intercepto\rdeber√≠amos obtener?\n\rFigure 1: Gr√°fico de dispersi√≥n entre duplicados\r\r\r¬°Correcto! Pendiente \\(\\beta_{1} = 1\\) e intercepto \\(\\beta_{0} = 0\\). La l√≠nea\rroja representa esta recta te√≥rica.\rNote tambi√©n que la dispersi√≥n de los datos es constante en todo el rango\rde concentraci√≥n, propiedad denominada Homocedasticidad.\n\rEsta propiedad es deseable, sin embargo, no todos los sistemas anal√≠ticos la\rposeen. En s√≠ ‚Ä¶","date":1503878400,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1648306187,"objectID":"061f433c17298f402c6ce6a33794373b","permalink":"https://www.analytical.cl/post/cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis/","publishdate":"2017-08-28T00:00:00Z","relpermalink":"/post/cual-es-la-maxima-diferencia-tolerable-entre-duplicados-de-analisis/","section":"post","summary":"En este post presentaremos dos m√©todos estad√≠sticos para establecer la m√°xima diferencia tolerable entre duplicados de an√°lisis. Este criterio de aceptaci√≥n nos dar√° una una base para la construcci√≥n de cartas control de precisi√≥n","tags":[],"title":"¬øCu√°l es la m√°xima diferencia tolerable entre duplicados de an√°lisis?","type":"post"},{"authors":[],"categories":[],"content":"\r\r\rEn este post intentaremos derribar el mito del coeficiente de correlaci√≥n con\r‚Äúmuchos‚Äù 9‚Äôs como prueba de linealidad. Adem√°s, presentaremos dos test\rformales para evaluar el modelo de calibraci√≥n lineal en qu√≠mica\ranal√≠tica.\nCoeficiente de correlaci√≥n\rEste par√°metro estad√≠stico indica la fuerza y direcci√≥n de la relaci√≥n de\rdos variables cuantitativas, por ejemplo;\n\rConcentraci√≥n (\\(x\\)) y Absorbancia (\\(y\\))\r\\(log \\text{ Concentraci√≥n}\\) y \\(E\\) Potencial (Ecuaci√≥n de Nernst)\rLa edad de las ganadoras de Miss Am√©rica con los asesinatos utilizando objetos\rcalientes y vapor. ¬°Cuidado con las correlaciones espurias!\r\rTodos los qu√≠micos estamos familiarizados con la ecuaci√≥n de Lambert-Beer,\rla cual establece la archiconocida relaci√≥n entre absorbancia y concentraci√≥n\ren m√©todos espectrofotom√©tricos:\n\\[\\begin{equation}\r\\underbrace{A}_\\text{y} = \\underbrace{\\epsilon \\cdot b}_\\text{$\\beta_{1}$} \\cdot\r\\underbrace{C}_\\text{x}\r\\tag{1}\r\\end{equation}\\]\nDe la ecuaci√≥n (1) se observa claramente la relaci√≥n con el modelo\rest√°ndar de calibraci√≥n lineal \\(y = \\beta_{0} + \\beta_{1}x\\) asumiendo un\rintercepto \\(\\beta_{0} = 0\\). Por lo tanto ¬øpor qu√© nos sorprende tanto\rencontrar un coeficiente de\rcorrelaci√≥n alto en curvas de calibraci√≥n espectrofotom√©tricas? Era totalmente\resperable, pues hay un modelo f√≠sico-qu√≠mico que sustenta el modelo lineal.\nOK, de acuerdo. Este modelo f√≠sico-qu√≠mico s√≥lo es v√°lido bajo ciertas\rcondiciones (como todos los modelos), de hecho son conocidas las desviaciones\rde la ley de Lambert-Beer a altas concentraciones.\n\rDerribando el mito del r = 0,999‚Ä¶\rPara comenzar, por favor, ponga atenci√≥n a la figura 1\rdenominada ‚ÄúEl Cuarteto de Anscombe‚Äù. La ‚Äúgracia‚Äù de estos\rdatos de calibraci√≥n es que todos tienen la misma pendiente, intercepto,\rerror de calibraci√≥n y‚Ä¶ ¬°coeficiente de correlaci√≥n!\n¬øNo me cree? Le dejo este link\rpara que descargue los datos en archivo Excel\ry se convenza con sus propios ojos.\n\rFigure 1: El Cuarteto de Ascombe\r\rEl punto que revela la figura 1 es que es posible obtener\rcoeficientes de\rcorrelaci√≥n ‚Äúaltos‚Äù inclusive con datos que, a simpe vista, no revelan\runa relaci√≥n lineal entre \\(X\\) e \\(Y\\). Es m√°s, es posible obtener un alto\rcoeficiente de correlaci√≥n donde no existe absolutamente ninguna\rcorrelaci√≥n entre \\(X\\) e \\(Y\\) mediante un mal de dise√±o de la curva de\rcalibraci√≥n. Por ejemplo, en la figura 2 se muestra a la izquierda\rque la correlaci√≥n entre \\(x\\) e \\(y\\) es pr√°cticamente 0. Sin embargo,\rcuando incluimos un punto influyente, muy alejado de la nube de puntos a\rbaja concentraci√≥n, m√°gicamente el r = 1 (derecha).\n\rMoraleja: Trate, en lo posible, de dise√±ar la curva con los puntos\requiespaciados y evite los saltos de varios √≥rdenes de magnitud de la\rconcentraci√≥n.\n\r## `geom_smooth()` using formula \u0026#39;y ~ x\u0026#39;\r## `geom_smooth()` using formula \u0026#39;y ~ x\u0026#39;\r\rFigure 2: Punto inlfuyente en la calibraci√≥n\r\rLa linealidad tampoco es un par√°metro cuantitativo, una curva con r = 0,999 no\res m√°s lineal que otra con r = 0,99. Observe la figura 3, ambas curvas fueron simuladas en lenguaje R con el mismo intercepto y\rpendiente siguiendo estrictamente el modelo lineal\r\\(y = \\beta_{0} + \\beta_{1}x\\), sin embargo, tienen coeficientes de\rcorrelaci√≥n distintos. La curva de la izquierda no es m√°s lineal que la de la\rderecha ya que ambas fueron simuladas a partir del mismo modelo, la √∫nica\rdiferencia es que la de la derecha tiene una mayor dispersi√≥n de los puntos, pero\rno por ello es ‚Äúmenos lineal‚Äù, de hecho ambas lo son, pues fueron simuladas.\nset.seed(123) # Es para que Ud. obtenga los mismos # resultados en su simulaci√≥n en R\rb0 \u0026lt;- 1 # Intercepto = 1\rb1 \u0026lt;- 10 # Pendiente = 10\rs \u0026lt;- 1 # Desviaci√≥n est√°ndar de calibraci√≥n\r# Simulamos el mismo modelo lineal x \u0026lt;- 1:10 # Calibrantes\ry1 \u0026lt;- b0 + b1*x + rnorm(10, 0, s) # Absorbancias con # error = s = 1\ry2 \u0026lt;- b0 + b1*x + rnorm(10, 0, 10*s) # Absorbancias con # error = 10*s = 10\r## `geom_smooth()` using formula \u0026#39;y ~ x\u0026#39;\r## `geom_smooth()` using formula \u0026#39;y ~ x\u0026#39;\r\rFigure 3: Simulaci√≥n de curvas perfectamente lineales\r\r\rTest formales de linealidad\rExisten varios tests estad√≠sticos formales para evaluar el supuesto de\rlinealidad de la curva de calibraci√≥n. Sin embargo, en este post veremos dos\rque son los m√°s utilizados en Qu√≠mica Anal√≠tica y son sugeridos por\rnormativas internacionales (para present√°rselos a los amables auditores).\nSi bien no es estrictamente riguroso, para simplificar el concepto, diremos que\rambos tests estad√≠sticos intentan dirimir entre dos hip√≥tesis:\n\r\\(H_{0}\\) (a.k.a Hip√≥tesis Nula) : El modelo lineal es adecuado para describir\rlos datos de calibraci√≥n\r\\(H_{1}\\) (a.k.a Hip√≥tesis alternativa): El modelo lineal NO es adecuado para\rdescribir los datos de calibraci√≥n\r\rTambi√©n debemos hacer la siguiente acotaci√≥n: En estad√≠stica\run modelo lineal es\raquel en que sus par√°metros son lineales. Por ejemplo, la curva de calibraci√≥n lineal\rcl√°sica \\(y = \\beta_{0} + \\beta_{1}x\\) tanto \\(\\beta_{0}\\) y \\(\\beta_{1}\\) son\rlineales. Sin embargo, en ‚Ä¶","date":1503446400,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1648302786,"objectID":"25c4e805b60f4419f2331960ac2aca12","permalink":"https://www.analytical.cl/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/","publishdate":"2017-08-23T00:00:00Z","relpermalink":"/post/como-demuestro-que-mi-curva-de-calibracion-es-lineal/","section":"post","summary":"En este post intentaremos derribar el mito del coeficiente de correlaci√≥n con\r‚Äúmuchos‚Äù 9‚Äôs como prueba de linealidad. Adem√°s, presentaremos dos test\rformales para evaluar el modelo de calibraci√≥n lineal en qu√≠mica\ranal√≠tica.","tags":[],"title":"¬øC√≥mo demuestro que mi curva de calibraci√≥n es lineal?","type":"post"},{"authors":[],"categories":[],"content":"\r\r\rOk, este es el segundo post pero advierto que a√∫n est√° en rodaje‚Ä¶ esto del\rcopywriting no es nada f√°cil.\n\r¬øQu√© es y c√≥mo estimar la incertidumbre de una curva de calibraci√≥n?\n\rLa incertidumbre de calibraci√≥n, en adelante \\(u(x_{0})\\), es aquella que se\rpropaga cuando obtenemos la concentraci√≥n de un mensurando\ral interpolar una se√±al instrumental (por ejemplo, absorbancia o\r√°rea cromatogr√°fica) en una curva de calibraci√≥n. B√°sicamente,\resta incertidumbre\rs√≥lo da cuenta del error aleatorio del instrumento y no incopora la\rincertidumbre de los calibrantes, al menos cuando se utiliza el modelo de\rcalibraci√≥n cl√°sico:\n\\[\\begin{equation}\ry = \\beta_{0} + \\beta_{1} x + \\epsilon\r\\tag{1}\r\\end{equation}\\]\ndonde \\(y\\) es la respuesta instrumental, \\(\\beta_{0}\\) es el intercepto,\r\\(\\beta_{1}\\) es la pendiente y \\(\\epsilon\\) es un error aleatorio Normal que tiene\rmedia \\(\\mu_{\\epsilon} = 0\\) y varianza \\(\\sigma_{y/x}^2\\). Note de la\recuaci√≥n (1) que lo √∫nico aleatorio es \\(\\epsilon\\), por lo tanto,\rel intercepto \\(\\beta_{0}\\) y la pendiente \\(\\beta_{1}\\) son fijos.\rLo que hacemos cuando aplicamos, por ejemplo, el m√©todo de los m√≠nimos\rcuadrados es estimar estos par√°metros y, en estad√≠stica, todas las\restimaciones tienen un error asociado.\nA partir de la ecuaci√≥n (1) obtenemos la concentraci√≥n de una\rmuestra problema \\(x_{0}\\) cuya se√±al instrumental es \\(y_{0}\\):\n\\[\\begin{equation}\rx_{0} = \\frac{y_{0} - \\beta_{0}}{\\beta_{1}}\r\\tag{2}\r\\end{equation}\\]\nSi aplic√°ramos la gu√≠a GUM para obtener la incertidumbre est√°ndar de\rcalibraci√≥n \\(u(x_{0})\\) ser√≠a bastante latoso-engorroso, pues hay unas\rcovarianzas no muy amistosas entre pendiente e intercepto. Afortunadamente\r\\(u(x_{0})\\) puede aproximarse muy bien a trav√©s de la ecuaci√≥n (3):\n\\[\\begin{equation}\ru(x_{0}) = \\frac{\\sigma_{y/x}}{\\beta_{1}}\r\\sqrt{\\frac{1}{n} + \\frac{1}{m_{0}} + \\frac{(x_{0} - \\overline{x})^2}\r{\\sum_{i}^{n} (x_{i} - \\overline{x})^2}}\r\\tag{3}\r\\end{equation}\\]\nVamos viendo dijo el ciego:\n\r\\(\\sigma_{y/x}\\) es la desviaci√≥n est√°ndar del error aleatorio \\(\\epsilon\\)\r\\(n\\) es el n√∫mero de calibrantes independientes (esto da para otro post)\r\\(m_{0}\\) es el n√∫mero de replicado independientes de la muestra problema\r\\(\\overline{x}\\) es el promedio de la concentraciones de los calibrantes\r\rEsta incertidumbre se puede observar en la figura 1, la\rcual fue obtenida mediante simulaci√≥n en lenguaje R:\nset.seed(123)\rx \u0026lt;- 1:10\ry \u0026lt;- 2 + 5*x + 10*rnorm(length(x), 0, 1)\rd \u0026lt;- data.frame(x, y)\rlibrary(ggplot2)\r## Warning: package \u0026#39;ggplot2\u0026#39; was built under R version 4.0.5\rggplot(d, aes(x = x, y = y)) +\rgeom_smooth(method = \u0026#39;lm\u0026#39;) \r## `geom_smooth()` using formula \u0026#39;y ~ x\u0026#39;\r\rFigure 1: Incertidumbre de calibraci√≥n\r\r¬øD√≥nde se obtiene la menor incertidumbre de calibraci√≥n? ‚Ä¶ ¬°Correcto!\n\rEn el centro de la curva se minimiza la incertidumbre de calibraci√≥n\n\rSi obervamos la ecuaci√≥n (3) podemos minimizar \\(u(x_{0})\\):\nAumentando \\(n\\) el n√∫mero de calibrantes.\rAumentando \\(m_{0}\\)\rDise√±ando la curva de calibraci√≥n de modo que \\(x_{0} = \\bar{x}\\)\rAunque no tan ‚Äúevidente‚Äù, maximizando \\(\\sum_{i}^{n} (x_{i} - \\overline{x})^2\\),\res decir, utilizando todo el rango lineal (Nota mental: otro post)\r\rAplicaci√≥n a un caso ‚Äúreal‚Äù\rLa tabla 1 muestra los datos de una curva de calibraci√≥n para la determinaci√≥n de cobre en mineral por AAS, la figura 2 describe\rel gr√°fico de calibraci√≥n:\n Alguien capo en HTML/CSS que me ayude a poner tabla enfrentada con figura en 2 columnas por favor‚Ä¶ y que Dios se lo pague.   \rTable 1: Curva de Calibraci√≥n Cu\r\r\r\rCu [ppm]\r\rUA\r\r\r\r\r\r1\r\r0.0344\r\r\r\r2\r\r0.0777\r\r\r\r3\r\r0.1356\r\r\r\r4\r\r0.1607\r\r\r\r5\r\r0.2013\r\r\r\r6\r\r0.2572\r\r\r\r7\r\r0.2846\r\r\r\r8\r\r0.3073\r\r\r\r9\r\r0.3531\r\r\r\r10\r\r0.3955\r\r\r\r\r## `geom_smooth()` using formula \u0026#39;y ~ x\u0026#39;\r\rFigure 2: Curva de calibraci√≥n\r\rOk, hay varias formas de implementar los c√°lculos de incertidumbre de\rcalibraci√≥n de la ecuaci√≥n (3). Podr√≠amos utilizar Excel para\robtener cada uno de los t√©rminos, pero eso lo ilustraremos en otro post.\rEn esta oportunidad utilizaremos el software R. Este software posee varias\rlibrer√≠as o packages especializados en el c√°lculo de incertidumbre en\rqu√≠mica anal√≠tica, por ejemplo: metRology y chemCal. En este post\rutilizaremos el segundo, pues entrega en forma directa el c√°lculo de\rla incertidumbre de calibraci√≥n:\n Si no tienes instalado el package chemCal utiliza el comando install.packages(‚ÄòchemCal‚Äô). Una vez instalado procede con el siguiente c√≥digo.   # Creaci√≥n del modelo de calibraci√≥n lineal, al que llamaremos fit.lin # (En otro post se profundizar√° sobre otros modelos de calibraci√≥n en R)\rfit.lin \u0026lt;- lm(y ~ x, data = d)\r# Simular un valor de respuesta de la muestra problema, es decir, y0.\r# S√≥lo por conveniencia simularemos que y0 = 0.200 UA, es decir, m√°s o menos\r# en el centro de la curva:\ry0 \u0026lt;- 0.200\r# Cargar la librer√≠a chemCal con el comando \u0026#39;library\u0026#39;:\rlibrary(chemCal)\r# Calcular la concentraci√≥n de la muestra problema, x0, a partir de su se√±al\r# instrumental y0, junto con la incertidumbre est√°ndar de calibraci√≥n u(x0) e\r# ‚Ä¶","date":1502668800,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1648270353,"objectID":"78ab283dc07c9f5cf0d696832f6c2511","permalink":"https://www.analytical.cl/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/","publishdate":"2017-08-14T00:00:00Z","relpermalink":"/post/como-calcular-la-incertidumbre-de-una-curva-de-calibracion/","section":"post","summary":"Ok, este es el segundo post pero advierto que a√∫n est√° en rodaje‚Ä¶ esto del\rcopywriting no es nada f√°cil.\n\r¬øQu√© es y c√≥mo estimar la incertidumbre de una curva de calibraci√≥n?","tags":[],"title":"C√≥mo calcular la incertidumbre de una curva de calibraci√≥n","type":"post"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1461715200,"objectID":"d1311ddf745551c9e117aa4bb7e28516","permalink":"https://www.analytical.cl/project/external-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/external-project/","section":"project","summary":"An example of linking directly to an external project website using `external_link`.","tags":["Demo"],"title":"External Project","type":"project"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1461715200,"objectID":"8f66d660a9a2edc2d08e68cc30f701f7","permalink":"https://www.analytical.cl/project/internal-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/internal-project/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Internal Project","type":"project"},{"authors":["Carlos G√≥mez","Enrique Mej√≠as"],"categories":null,"content":"","date":1441065600,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":1441065600,"objectID":"966884cc0d8ac9e31fab966c4534e973","permalink":"https://www.analytical.cl/publication/journal-article/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/journal-article/","section":"publication","summary":"Honeys in Chile are produced from native and endemic plant species that, due to phenolic compounds, present beneficial biological attributes. However, certain undesirable pollutants can exist in honeys from beehives located near agricultural crops or commercial industries. Neonicotinoids are a widely used pesticide group in farming, despite acute, negative effects to bee health. Indeed, neonicotinoids are associated with colony collapse disorder, one of the main causes for increased death rates in bee populations. Declining bee health in Chile may consequently be related to neonicotinoids exposure. To assess this threat, honey samples collected from different regions in Chile were analyzed to quantify phenolic contents, antioxidant activity, and the presence of four neonicotinoids (i.e., thiamethoxam, thiacloprid, acetamiprid, and imidacloprid). Pesticide-free honey samples were also fortified with three concentrations of the four neonicotinoids to evaluate changes in the chemical properties of honey. Total phenol contents decreased and antioxidant activity increased in relation to the assessed fortification concentrations. Since the agricultural use of neonicotinoids has been related to those negatives damages for bee health, in Chile, beehives should be strategically located to prevent the contamination of honeys with neonicotinoid pesticides.","tags":null,"title":"Natural attributes of Chilean honeys modified by the presence of neonicotinoids residues","type":"publication"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":-62135596800,"objectID":"f26b5133c34eec1aa0a09390a36c2ade","permalink":"https://www.analytical.cl/admin/config.yml","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/admin/config.yml","section":"","summary":"","tags":null,"title":"","type":"wowchemycms"}]